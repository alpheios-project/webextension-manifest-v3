(()=>{var e={852:e=>{!function webpackUniversalModuleDefinition(t,r){e.exports=r()}(self,(()=>(()=>{var e={486:(e,t,r)=>{e.exports=r(175)},232:(e,t,r)=>{"use strict";var a=r(948),s=r(162),n=r(65),i=r(42),o=r(214),u=r(170),c=r(632),l=r(591);e.exports=function xhrAdapter(e){return new Promise((function dispatchXhrRequest(t,r){var h=e.data,d=e.headers,p=e.responseType;a.isFormData(h)&&delete d["Content-Type"];var g=new XMLHttpRequest;if(e.auth){var f=e.auth.username||"",m=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";d.Authorization="Basic "+btoa(f+":"+m)}var b=o(e.baseURL,e.url);function onloadend(){if(g){var a="getAllResponseHeaders"in g?u(g.getAllResponseHeaders()):null,n={data:p&&"text"!==p&&"json"!==p?g.response:g.responseText,status:g.status,statusText:g.statusText,headers:a,config:e,request:g};s(t,r,n),g=null}}if(g.open(e.method.toUpperCase(),i(b,e.params,e.paramsSerializer),!0),g.timeout=e.timeout,"onloadend"in g?g.onloadend=onloadend:g.onreadystatechange=function handleLoad(){g&&4===g.readyState&&(0!==g.status||g.responseURL&&0===g.responseURL.indexOf("file:"))&&setTimeout(onloadend)},g.onabort=function handleAbort(){g&&(r(l("Request aborted",e,"ECONNABORTED",g)),g=null)},g.onerror=function handleError(){r(l("Network Error",e,null,g)),g=null},g.ontimeout=function handleTimeout(){var t="timeout of "+e.timeout+"ms exceeded";e.timeoutErrorMessage&&(t=e.timeoutErrorMessage),r(l(t,e,e.transitional&&e.transitional.clarifyTimeoutError?"ETIMEDOUT":"ECONNABORTED",g)),g=null},a.isStandardBrowserEnv()){var E=(e.withCredentials||c(b))&&e.xsrfCookieName?n.read(e.xsrfCookieName):void 0;E&&(d[e.xsrfHeaderName]=E)}"setRequestHeader"in g&&a.forEach(d,(function setRequestHeader(e,t){void 0===h&&"content-type"===t.toLowerCase()?delete d[t]:g.setRequestHeader(t,e)})),a.isUndefined(e.withCredentials)||(g.withCredentials=!!e.withCredentials),p&&"json"!==p&&(g.responseType=e.responseType),"function"==typeof e.onDownloadProgress&&g.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&g.upload&&g.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then((function onCanceled(e){g&&(g.abort(),r(e),g=null)})),h||(h=null),g.send(h)}))}},175:(e,t,r)=>{"use strict";var a=r(948),s=r(365),n=r(262),i=r(682);function createInstance(e){var t=new n(e),r=s(n.prototype.request,t);return a.extend(r,n.prototype,t),a.extend(r,t),r}var o=createInstance(r(14));o.Axios=n,o.create=function create(e){return createInstance(i(o.defaults,e))},o.Cancel=r(280),o.CancelToken=r(521),o.isCancel=r(583),o.all=function all(e){return Promise.all(e)},o.spread=r(338),o.isAxiosError=r(646),e.exports=o,e.exports.default=o},280:e=>{"use strict";function Cancel(e){this.message=e}Cancel.prototype.toString=function toString(){return"Cancel"+(this.message?": "+this.message:"")},Cancel.prototype.__CANCEL__=!0,e.exports=Cancel},521:(e,t,r)=>{"use strict";var a=r(280);function CancelToken(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise((function promiseExecutor(e){t=e}));var r=this;e((function cancel(e){r.reason||(r.reason=new a(e),t(r.reason))}))}CancelToken.prototype.throwIfRequested=function throwIfRequested(){if(this.reason)throw this.reason},CancelToken.source=function source(){var e;return{token:new CancelToken((function executor(t){e=t})),cancel:e}},e.exports=CancelToken},583:e=>{"use strict";e.exports=function isCancel(e){return!(!e||!e.__CANCEL__)}},262:(e,t,r)=>{"use strict";var a=r(948),s=r(42),n=r(5),i=r(530),o=r(682),u=r(288),c=u.validators;function Axios(e){this.defaults=e,this.interceptors={request:new n,response:new n}}Axios.prototype.request=function request(e){"string"==typeof e?(e=arguments[1]||{}).url=arguments[0]:e=e||{},(e=o(this.defaults,e)).method?e.method=e.method.toLowerCase():this.defaults.method?e.method=this.defaults.method.toLowerCase():e.method="get";var t=e.transitional;void 0!==t&&u.assertOptions(t,{silentJSONParsing:c.transitional(c.boolean,"1.0.0"),forcedJSONParsing:c.transitional(c.boolean,"1.0.0"),clarifyTimeoutError:c.transitional(c.boolean,"1.0.0")},!1);var r=[],a=!0;this.interceptors.request.forEach((function unshiftRequestInterceptors(t){"function"==typeof t.runWhen&&!1===t.runWhen(e)||(a=a&&t.synchronous,r.unshift(t.fulfilled,t.rejected))}));var s,n=[];if(this.interceptors.response.forEach((function pushResponseInterceptors(e){n.push(e.fulfilled,e.rejected)})),!a){var l=[i,void 0];for(Array.prototype.unshift.apply(l,r),l=l.concat(n),s=Promise.resolve(e);l.length;)s=s.then(l.shift(),l.shift());return s}for(var h=e;r.length;){var d=r.shift(),p=r.shift();try{h=d(h)}catch(e){p(e);break}}try{s=i(h)}catch(e){return Promise.reject(e)}for(;n.length;)s=s.then(n.shift(),n.shift());return s},Axios.prototype.getUri=function getUri(e){return e=o(this.defaults,e),s(e.url,e.params,e.paramsSerializer).replace(/^\?/,"")},a.forEach(["delete","get","head","options"],(function forEachMethodNoData(e){Axios.prototype[e]=function(t,r){return this.request(o(r||{},{method:e,url:t,data:(r||{}).data}))}})),a.forEach(["post","put","patch"],(function forEachMethodWithData(e){Axios.prototype[e]=function(t,r,a){return this.request(o(a||{},{method:e,url:t,data:r}))}})),e.exports=Axios},5:(e,t,r)=>{"use strict";var a=r(948);function InterceptorManager(){this.handlers=[]}InterceptorManager.prototype.use=function use(e,t,r){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!r&&r.synchronous,runWhen:r?r.runWhen:null}),this.handlers.length-1},InterceptorManager.prototype.eject=function eject(e){this.handlers[e]&&(this.handlers[e]=null)},InterceptorManager.prototype.forEach=function forEach(e){a.forEach(this.handlers,(function forEachHandler(t){null!==t&&e(t)}))},e.exports=InterceptorManager},214:(e,t,r)=>{"use strict";var a=r(713),s=r(671);e.exports=function buildFullPath(e,t){return e&&!a(t)?s(e,t):t}},591:(e,t,r)=>{"use strict";var a=r(475);e.exports=function createError(e,t,r,s,n){var i=new Error(e);return a(i,t,r,s,n)}},530:(e,t,r)=>{"use strict";var a=r(948),s=r(587),n=r(583),i=r(14);function throwIfCancellationRequested(e){e.cancelToken&&e.cancelToken.throwIfRequested()}e.exports=function dispatchRequest(e){return throwIfCancellationRequested(e),e.headers=e.headers||{},e.data=s.call(e,e.data,e.headers,e.transformRequest),e.headers=a.merge(e.headers.common||{},e.headers[e.method]||{},e.headers),a.forEach(["delete","get","head","post","put","patch","common"],(function cleanHeaderConfig(t){delete e.headers[t]})),(e.adapter||i.adapter)(e).then((function onAdapterResolution(t){return throwIfCancellationRequested(e),t.data=s.call(e,t.data,t.headers,e.transformResponse),t}),(function onAdapterRejection(t){return n(t)||(throwIfCancellationRequested(e),t&&t.response&&(t.response.data=s.call(e,t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)}))}},475:e=>{"use strict";e.exports=function enhanceError(e,t,r,a,s){return e.config=t,r&&(e.code=r),e.request=a,e.response=s,e.isAxiosError=!0,e.toJSON=function toJSON(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},e}},682:(e,t,r)=>{"use strict";var a=r(948);e.exports=function mergeConfig(e,t){t=t||{};var r={},s=["url","method","data"],n=["headers","auth","proxy","params"],i=["baseURL","transformRequest","transformResponse","paramsSerializer","timeout","timeoutMessage","withCredentials","adapter","responseType","xsrfCookieName","xsrfHeaderName","onUploadProgress","onDownloadProgress","decompress","maxContentLength","maxBodyLength","maxRedirects","transport","httpAgent","httpsAgent","cancelToken","socketPath","responseEncoding"],o=["validateStatus"];function getMergedValue(e,t){return a.isPlainObject(e)&&a.isPlainObject(t)?a.merge(e,t):a.isPlainObject(t)?a.merge({},t):a.isArray(t)?t.slice():t}function mergeDeepProperties(s){a.isUndefined(t[s])?a.isUndefined(e[s])||(r[s]=getMergedValue(void 0,e[s])):r[s]=getMergedValue(e[s],t[s])}a.forEach(s,(function valueFromConfig2(e){a.isUndefined(t[e])||(r[e]=getMergedValue(void 0,t[e]))})),a.forEach(n,mergeDeepProperties),a.forEach(i,(function defaultToConfig2(s){a.isUndefined(t[s])?a.isUndefined(e[s])||(r[s]=getMergedValue(void 0,e[s])):r[s]=getMergedValue(void 0,t[s])})),a.forEach(o,(function merge(a){a in t?r[a]=getMergedValue(e[a],t[a]):a in e&&(r[a]=getMergedValue(void 0,e[a]))}));var u=s.concat(n).concat(i).concat(o),c=Object.keys(e).concat(Object.keys(t)).filter((function filterAxiosKeys(e){return-1===u.indexOf(e)}));return a.forEach(c,mergeDeepProperties),r}},162:(e,t,r)=>{"use strict";var a=r(591);e.exports=function settle(e,t,r){var s=r.config.validateStatus;r.status&&s&&!s(r.status)?t(a("Request failed with status code "+r.status,r.config,null,r.request,r)):e(r)}},587:(e,t,r)=>{"use strict";var a=r(948),s=r(14);e.exports=function transformData(e,t,r){var n=this||s;return a.forEach(r,(function transform(r){e=r.call(n,e,t)})),e}},14:(e,t,r)=>{"use strict";var a=r(948),s=r(236),n=r(475),i={"Content-Type":"application/x-www-form-urlencoded"};function setContentTypeIfUnset(e,t){!a.isUndefined(e)&&a.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var o={transitional:{silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},adapter:function getDefaultAdapter(){var e;return("undefined"!=typeof XMLHttpRequest||"undefined"!=typeof process&&"[object process]"===Object.prototype.toString.call(process))&&(e=r(232)),e}(),transformRequest:[function transformRequest(e,t){return s(t,"Accept"),s(t,"Content-Type"),a.isFormData(e)||a.isArrayBuffer(e)||a.isBuffer(e)||a.isStream(e)||a.isFile(e)||a.isBlob(e)?e:a.isArrayBufferView(e)?e.buffer:a.isURLSearchParams(e)?(setContentTypeIfUnset(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):a.isObject(e)||t&&"application/json"===t["Content-Type"]?(setContentTypeIfUnset(t,"application/json"),function stringifySafely(e,t,r){if(a.isString(e))try{return(t||JSON.parse)(e),a.trim(e)}catch(e){if("SyntaxError"!==e.name)throw e}return(r||JSON.stringify)(e)}(e)):e}],transformResponse:[function transformResponse(e){var t=this.transitional,r=t&&t.silentJSONParsing,s=t&&t.forcedJSONParsing,i=!r&&"json"===this.responseType;if(i||s&&a.isString(e)&&e.length)try{return JSON.parse(e)}catch(e){if(i){if("SyntaxError"===e.name)throw n(e,this,"E_JSON_PARSE");throw e}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function validateStatus(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};a.forEach(["delete","get","head"],(function forEachMethodNoData(e){o.headers[e]={}})),a.forEach(["post","put","patch"],(function forEachMethodWithData(e){o.headers[e]=a.merge(i)})),e.exports=o},365:e=>{"use strict";e.exports=function bind(e,t){return function wrap(){for(var r=new Array(arguments.length),a=0;a<r.length;a++)r[a]=arguments[a];return e.apply(t,r)}}},42:(e,t,r)=>{"use strict";var a=r(948);function encode(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}e.exports=function buildURL(e,t,r){if(!t)return e;var s;if(r)s=r(t);else if(a.isURLSearchParams(t))s=t.toString();else{var n=[];a.forEach(t,(function serialize(e,t){null!=e&&(a.isArray(e)?t+="[]":e=[e],a.forEach(e,(function parseValue(e){a.isDate(e)?e=e.toISOString():a.isObject(e)&&(e=JSON.stringify(e)),n.push(encode(t)+"="+encode(e))})))})),s=n.join("&")}if(s){var i=e.indexOf("#");-1!==i&&(e=e.slice(0,i)),e+=(-1===e.indexOf("?")?"?":"&")+s}return e}},671:e=>{"use strict";e.exports=function combineURLs(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}},65:(e,t,r)=>{"use strict";var a=r(948);e.exports=a.isStandardBrowserEnv()?function standardBrowserEnv(){return{write:function write(e,t,r,s,n,i){var o=[];o.push(e+"="+encodeURIComponent(t)),a.isNumber(r)&&o.push("expires="+new Date(r).toGMTString()),a.isString(s)&&o.push("path="+s),a.isString(n)&&o.push("domain="+n),!0===i&&o.push("secure"),document.cookie=o.join("; ")},read:function read(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function remove(e){this.write(e,"",Date.now()-864e5)}}}():{write:function write(){},read:function read(){return null},remove:function remove(){}}},713:e=>{"use strict";e.exports=function isAbsoluteURL(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)}},646:e=>{"use strict";e.exports=function isAxiosError(e){return"object"==typeof e&&!0===e.isAxiosError}},632:(e,t,r)=>{"use strict";var a=r(948);e.exports=a.isStandardBrowserEnv()?function standardBrowserEnv(){var e,t=/(msie|trident)/i.test(navigator.userAgent),r=document.createElement("a");function resolveURL(e){var a=e;return t&&(r.setAttribute("href",a),a=r.href),r.setAttribute("href",a),{href:r.href,protocol:r.protocol?r.protocol.replace(/:$/,""):"",host:r.host,search:r.search?r.search.replace(/^\?/,""):"",hash:r.hash?r.hash.replace(/^#/,""):"",hostname:r.hostname,port:r.port,pathname:"/"===r.pathname.charAt(0)?r.pathname:"/"+r.pathname}}return e=resolveURL(window.location.href),function isURLSameOrigin(t){var r=a.isString(t)?resolveURL(t):t;return r.protocol===e.protocol&&r.host===e.host}}():function isURLSameOrigin(){return!0}},236:(e,t,r)=>{"use strict";var a=r(948);e.exports=function normalizeHeaderName(e,t){a.forEach(e,(function processHeader(r,a){a!==t&&a.toUpperCase()===t.toUpperCase()&&(e[t]=r,delete e[a])}))}},170:(e,t,r)=>{"use strict";var a=r(948),s=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];e.exports=function parseHeaders(e){var t,r,n,i={};return e?(a.forEach(e.split("\n"),(function parser(e){if(n=e.indexOf(":"),t=a.trim(e.substr(0,n)).toLowerCase(),r=a.trim(e.substr(n+1)),t){if(i[t]&&s.indexOf(t)>=0)return;i[t]="set-cookie"===t?(i[t]?i[t]:[]).concat([r]):i[t]?i[t]+", "+r:r}})),i):i}},338:e=>{"use strict";e.exports=function spread(e){return function wrap(t){return e.apply(null,t)}}},288:(e,t,r)=>{"use strict";var a=r(837),s={};["object","boolean","number","function","string","symbol"].forEach((function(e,t){s[e]=function validator(r){return typeof r===e||"a"+(t<1?"n ":" ")+e}}));var n={},i=a.version.split(".");function isOlderVersion(e,t){for(var r=t?t.split("."):i,a=e.split("."),s=0;s<3;s++){if(r[s]>a[s])return!0;if(r[s]<a[s])return!1}return!1}s.transitional=function transitional(e,t,r){var s=t&&isOlderVersion(t);function formatMessage(e,t){return"[Axios v"+a.version+"] Transitional option '"+e+"'"+t+(r?". "+r:"")}return function(r,a,i){if(!1===e)throw new Error(formatMessage(a," has been removed in "+t));return s&&!n[a]&&(n[a]=!0,console.warn(formatMessage(a," has been deprecated since v"+t+" and will be removed in the near future"))),!e||e(r,a,i)}},e.exports={isOlderVersion,assertOptions:function assertOptions(e,t,r){if("object"!=typeof e)throw new TypeError("options must be an object");for(var a=Object.keys(e),s=a.length;s-- >0;){var n=a[s],i=t[n];if(i){var o=e[n],u=void 0===o||i(o,n,e);if(!0!==u)throw new TypeError("option "+n+" must be "+u)}else if(!0!==r)throw Error("Unknown option "+n)}},validators:s}},948:(e,t,r)=>{"use strict";var a=r(365),s=Object.prototype.toString;function isArray(e){return"[object Array]"===s.call(e)}function isUndefined(e){return void 0===e}function isObject(e){return null!==e&&"object"==typeof e}function isPlainObject(e){if("[object Object]"!==s.call(e))return!1;var t=Object.getPrototypeOf(e);return null===t||t===Object.prototype}function isFunction(e){return"[object Function]"===s.call(e)}function forEach(e,t){if(null!=e)if("object"!=typeof e&&(e=[e]),isArray(e))for(var r=0,a=e.length;r<a;r++)t.call(null,e[r],r,e);else for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.call(null,e[s],s,e)}e.exports={isArray,isArrayBuffer:function isArrayBuffer(e){return"[object ArrayBuffer]"===s.call(e)},isBuffer:function isBuffer(e){return null!==e&&!isUndefined(e)&&null!==e.constructor&&!isUndefined(e.constructor)&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)},isFormData:function isFormData(e){return"undefined"!=typeof FormData&&e instanceof FormData},isArrayBufferView:function isArrayBufferView(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer},isString:function isString(e){return"string"==typeof e},isNumber:function isNumber(e){return"number"==typeof e},isObject,isPlainObject,isUndefined,isDate:function isDate(e){return"[object Date]"===s.call(e)},isFile:function isFile(e){return"[object File]"===s.call(e)},isBlob:function isBlob(e){return"[object Blob]"===s.call(e)},isFunction,isStream:function isStream(e){return isObject(e)&&isFunction(e.pipe)},isURLSearchParams:function isURLSearchParams(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams},isStandardBrowserEnv:function isStandardBrowserEnv(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&"undefined"!=typeof window&&"undefined"!=typeof document},forEach,merge:function merge(){var e={};function assignValue(t,r){isPlainObject(e[r])&&isPlainObject(t)?e[r]=merge(e[r],t):isPlainObject(t)?e[r]=merge({},t):isArray(t)?e[r]=t.slice():e[r]=t}for(var t=0,r=arguments.length;t<r;t++)forEach(arguments[t],assignValue);return e},extend:function extend(e,t,r){return forEach(t,(function assignValue(t,s){e[s]=r&&"function"==typeof t?a(t,r):t})),e},trim:function trim(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")},stripBOM:function stripBOM(e){return 65279===e.charCodeAt(0)&&(e=e.slice(1)),e}}},105:(e,t,r)=>{var a=r(43),s=r(432),n=s;n.v1=a,n.v4=s,e.exports=n},817:e=>{for(var t=[],r=0;r<256;++r)t[r]=(r+256).toString(16).substr(1);e.exports=function bytesToUuid(e,r){var a=r||0,s=t;return[s[e[a++]],s[e[a++]],s[e[a++]],s[e[a++]],"-",s[e[a++]],s[e[a++]],"-",s[e[a++]],s[e[a++]],"-",s[e[a++]],s[e[a++]],"-",s[e[a++]],s[e[a++]],s[e[a++]],s[e[a++]],s[e[a++]],s[e[a++]]].join("")}},630:e=>{var t="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(t){var r=new Uint8Array(16);e.exports=function whatwgRNG(){return t(r),r}}else{var a=new Array(16);e.exports=function mathRNG(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),a[t]=e>>>((3&t)<<3)&255;return a}}},43:(e,t,r)=>{var a,s,n=r(630),i=r(817),o=0,u=0;e.exports=function v1(e,t,r){var c=t&&r||0,l=t||[],h=(e=e||{}).node||a,d=void 0!==e.clockseq?e.clockseq:s;if(null==h||null==d){var p=n();null==h&&(h=a=[1|p[0],p[1],p[2],p[3],p[4],p[5]]),null==d&&(d=s=16383&(p[6]<<8|p[7]))}var g=void 0!==e.msecs?e.msecs:(new Date).getTime(),f=void 0!==e.nsecs?e.nsecs:u+1,m=g-o+(f-u)/1e4;if(m<0&&void 0===e.clockseq&&(d=d+1&16383),(m<0||g>o)&&void 0===e.nsecs&&(f=0),f>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");o=g,u=f,s=d;var b=(1e4*(268435455&(g+=122192928e5))+f)%4294967296;l[c++]=b>>>24&255,l[c++]=b>>>16&255,l[c++]=b>>>8&255,l[c++]=255&b;var E=g/4294967296*1e4&268435455;l[c++]=E>>>8&255,l[c++]=255&E,l[c++]=E>>>24&15|16,l[c++]=E>>>16&255,l[c++]=d>>>8|128,l[c++]=255&d;for(var y=0;y<6;++y)l[c+y]=h[y];return t||i(l)}},432:(e,t,r)=>{var a=r(630),s=r(817);e.exports=function v4(e,t,r){var n=t&&r||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var i=(e=e||{}).random||(e.rng||a)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,t)for(var o=0;o<16;++o)t[n+o]=i[o];return t||s(i)}},837:e=>{"use strict";e.exports=JSON.parse('{"name":"axios","version":"0.21.4","description":"Promise based HTTP client for the browser and node.js","main":"index.js","scripts":{"test":"grunt test","start":"node ./sandbox/server.js","build":"NODE_ENV=production grunt build","preversion":"npm test","version":"npm run build && grunt version && git add -A dist && git add CHANGELOG.md bower.json package.json","postversion":"git push && git push --tags","examples":"node ./examples/server.js","coveralls":"cat coverage/lcov.info | ./node_modules/coveralls/bin/coveralls.js","fix":"eslint --fix lib/**/*.js"},"repository":{"type":"git","url":"https://github.com/axios/axios.git"},"keywords":["xhr","http","ajax","promise","node"],"author":"Matt Zabriskie","license":"MIT","bugs":{"url":"https://github.com/axios/axios/issues"},"homepage":"https://axios-http.com","devDependencies":{"coveralls":"^3.0.0","es6-promise":"^4.2.4","grunt":"^1.3.0","grunt-banner":"^0.6.0","grunt-cli":"^1.2.0","grunt-contrib-clean":"^1.1.0","grunt-contrib-watch":"^1.0.0","grunt-eslint":"^23.0.0","grunt-karma":"^4.0.0","grunt-mocha-test":"^0.13.3","grunt-ts":"^6.0.0-beta.19","grunt-webpack":"^4.0.2","istanbul-instrumenter-loader":"^1.0.0","jasmine-core":"^2.4.1","karma":"^6.3.2","karma-chrome-launcher":"^3.1.0","karma-firefox-launcher":"^2.1.0","karma-jasmine":"^1.1.1","karma-jasmine-ajax":"^0.1.13","karma-safari-launcher":"^1.0.0","karma-sauce-launcher":"^4.3.6","karma-sinon":"^1.0.5","karma-sourcemap-loader":"^0.3.8","karma-webpack":"^4.0.2","load-grunt-tasks":"^3.5.2","minimist":"^1.2.0","mocha":"^8.2.1","sinon":"^4.5.0","terser-webpack-plugin":"^4.2.3","typescript":"^4.0.5","url-search-params":"^0.10.0","webpack":"^4.44.2","webpack-dev-server":"^3.11.0"},"browser":{"./lib/adapters/http.js":"./lib/adapters/xhr.js"},"jsdelivr":"dist/axios.min.js","unpkg":"dist/axios.min.js","typings":"./index.d.ts","dependencies":{"follow-redirects":"^1.14.0"},"bundlesize":[{"path":"./dist/axios.min.js","threshold":"5kB"}]}')}},t={};function __nested_webpack_require_22140__(r){var a=t[r];if(void 0!==a)return a.exports;var s=t[r]={exports:{}};return e[r](s,s.exports,__nested_webpack_require_22140__),s.exports}__nested_webpack_require_22140__.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return __nested_webpack_require_22140__.d(t,{a:t}),t},__nested_webpack_require_22140__.d=(e,t)=>{for(var r in t)__nested_webpack_require_22140__.o(t,r)&&!__nested_webpack_require_22140__.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},__nested_webpack_require_22140__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),__nested_webpack_require_22140__.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var r={};return(()=>{"use strict";__nested_webpack_require_22140__.r(r),__nested_webpack_require_22140__.d(r,{ArabicLanguageModel:()=>ArabicLanguageModel,Author:()=>Wa,ChineseLanguageModel:()=>ChineseLanguageModel,Collection:()=>Collection,Constants:()=>e,DefaultsLoader:()=>DefaultsLoader,Definition:()=>ga,DefinitionSet:()=>DefinitionSet,ExtensionSyncStorage:()=>ExtensionSyncStorage,Feature:()=>Feature,FeatureImporter:()=>fa,FeatureList:()=>Ua,FeatureType:()=>ba,GeezLanguageModel:()=>GeezLanguageModel,GreekLanguageModel:()=>GreekLanguageModel,GrmFeature:()=>Ra,Homonym:()=>Ga,HomonymGroup:()=>HomonymGroup,Inflection:()=>ka,LanguageModelFactory:()=>Ba,LatinLanguageModel:()=>LatinLanguageModel,Lemma:()=>Ha,Lexeme:()=>ja,LocalStorageArea:()=>LocalStorageArea,Logger:()=>Logger,Options:()=>Options,PersianLanguageModel:()=>PersianLanguageModel,PsEvent:()=>PsEvent,PsEventData:()=>PsEventData,RemoteAuthStorageArea:()=>RemoteAuthStorageArea,Resource:()=>Resource,ResourceProvider:()=>pa,SyriacLanguageModel:()=>SyriacLanguageModel,Tab:()=>Tab,TabScript:()=>TabScript,TempStorageArea:()=>TempStorageArea,TextQuoteSelector:()=>TextQuoteSelector,TextWork:()=>$a,Translation:()=>Va,TreebankDataItem:()=>TreebankDataItem,UIStateAPI:()=>UIStateAPI,WordItem:()=>WordItem,WordList:()=>WordList,WordUsageExample:()=>WordUsageExample});var e={};__nested_webpack_require_22140__.r(e),__nested_webpack_require_22140__.d(e,{CASE_ABESSIVE:()=>he,CASE_ABLATIVE:()=>de,CASE_ABSOLUTIVE:()=>pe,CASE_ACCUSATIVE:()=>ge,CASE_ADDIRECTIVE:()=>fe,CASE_ADELATIVE:()=>me,CASE_ADESSIVE:()=>be,CASE_ADVERBIAL:()=>Ee,CASE_ALLATIVE:()=>ye,CASE_ANTESSIVE:()=>Ie,CASE_APUDESSIVE:()=>ve,CASE_AVERSIVE:()=>Se,CASE_BENEFACTIVE:()=>we,CASE_CARITIVE:()=>_e,CASE_CAUSAL:()=>Ae,CASE_CAUSAL_FINAL:()=>Te,CASE_COMITATIVE:()=>Le,CASE_DATIVE:()=>Ce,CASE_DELATIVE:()=>Oe,CASE_DIRECT:()=>De,CASE_DISTRIBUTIVE:()=>Fe,CASE_DISTRIBUTIVE_TEMPORAL:()=>Ne,CASE_ELATIVE:()=>Pe,CASE_EQUATIVE:()=>Ue,CASE_ERGATIVE:()=>Me,CASE_ESSIVE:()=>xe,CASE_ESSIVE_FORMAL:()=>Be,CASE_ESSIVE_MODAL:()=>Re,CASE_EVITATIVE:()=>Ve,CASE_EXESSIVE:()=>He,CASE_FINAL:()=>ke,CASE_FORMAL:()=>je,CASE_GENITIVE:()=>Ge,CASE_ILLATIVE:()=>We,CASE_INELATIVE:()=>$e,CASE_INESSIVE:()=>ze,CASE_INSTRUCTIVE:()=>qe,CASE_INSTRUMENTAL:()=>Je,CASE_INSTRUMENTAL_COMITATIVE:()=>Ke,CASE_INTRANSITIVE:()=>Xe,CASE_LATIVE:()=>Ye,CASE_LOCATIVE:()=>Ze,CASE_MODAL:()=>Qe,CASE_MULTIPLICATIVE:()=>et,CASE_NOMINATIVE:()=>tt,CASE_PARTITIVE:()=>rt,CASE_PEGATIVE:()=>at,CASE_PERLATIVE:()=>st,CASE_POSSESSIVE:()=>nt,CASE_POSTDIRECTIVE:()=>ot,CASE_POSTELATIVE:()=>it,CASE_POSTESSIVE:()=>ut,CASE_POSTPOSITIONAL:()=>ct,CASE_PREPOSITIONAL:()=>lt,CASE_PRIVATIVE:()=>ht,CASE_PROLATIVE:()=>dt,CASE_PROSECUTIVE:()=>pt,CASE_PROXIMATIVE:()=>gt,CASE_SEPARATIVE:()=>ft,CASE_SOCIATIVE:()=>mt,CASE_SUBDIRECTIVE:()=>bt,CASE_SUBELATIVE:()=>yt,CASE_SUBESSIVE:()=>Et,CASE_SUBLATIVE:()=>It,CASE_SUPERDIRECTIVE:()=>vt,CASE_SUPERESSIVE:()=>St,CASE_SUPERLATIVE:()=>wt,CASE_SUPPRESSIVE:()=>_t,CASE_TEMPORAL:()=>At,CASE_TERMINATIVE:()=>Tt,CASE_TRANSLATIVE:()=>Lt,CASE_VIALIS:()=>Ct,CASE_VOCATIVE:()=>Ot,CLASS_DEMONSTRATIVE:()=>aa,CLASS_GENERAL_RELATIVE:()=>ia,CLASS_INDEFINITE:()=>oa,CLASS_INTENSIVE:()=>ua,CLASS_INTERROGATIVE:()=>na,CLASS_PERSONAL:()=>ea,CLASS_POSSESSIVE:()=>ra,CLASS_RECIPROCAL:()=>ca,CLASS_REFLEXIVE:()=>ta,CLASS_RELATIVE:()=>sa,COMP_COMPARITIVE:()=>ce,COMP_POSITIVE:()=>ue,COMP_SUPERLATIVE:()=>le,GEND_ANIMATE:()=>ae,GEND_ANIMATE_MASCULINE:()=>ie,GEND_COMMON:()=>re,GEND_FEMININE:()=>ee,GEND_INANIMATE:()=>se,GEND_INANIMATE_MASCULINE:()=>oe,GEND_MASCULINE:()=>Q,GEND_NEUTER:()=>te,GEND_PERSONAL_MASCULINE:()=>ne,LANG_ARABIC:()=>c,LANG_CHINESE:()=>d,LANG_DIR_LTR:()=>s,LANG_DIR_RTL:()=>n,LANG_GEEZ:()=>h,LANG_GREEK:()=>u,LANG_LATIN:()=>o,LANG_PERSIAN:()=>l,LANG_SYRIAC:()=>p,LANG_UNDEFINED:()=>i,LANG_UNIT_CHAR:()=>a,LANG_UNIT_WORD:()=>t,MOOD_ADMIRATIVE:()=>Dt,MOOD_COHORTATIVE:()=>Ft,MOOD_CONDITIONAL:()=>Nt,MOOD_DECLARATIVE:()=>Pt,MOOD_DUBITATIVE:()=>Mt,MOOD_ENERGETIC:()=>xt,MOOD_EVENTIVE:()=>Bt,MOOD_GENERIC:()=>Rt,MOOD_GERUNDIVE:()=>Ut,MOOD_HYPOTHETICAL:()=>Vt,MOOD_IMPERATIVE:()=>Ht,MOOD_INDICATIVE:()=>kt,MOOD_INFERENTIAL:()=>jt,MOOD_INFINITIVE:()=>Gt,MOOD_INTERROGATIVE:()=>Wt,MOOD_JUSSIVE:()=>$t,MOOD_NEGATIVE:()=>zt,MOOD_OPTATIVE:()=>qt,MOOD_PARTICIPLE:()=>Jt,MOOD_PRESUMPTIVE:()=>Kt,MOOD_RENARRATIVE:()=>Xt,MOOD_SUBJUNCTIVE:()=>Yt,MOOD_SUPINE:()=>Zt,NRL_CARDINAL:()=>or,NRL_DISTRIBUTIVE:()=>cr,NRL_ORDINAL:()=>ur,NUM_COLLECTIVE:()=>nr,NUM_DISTRIBUTIVE_PLURAL:()=>ir,NUM_DUAL:()=>tr,NUM_PAUCAL:()=>ar,NUM_PLURAL:()=>er,NUM_SINGULAR:()=>Qt,NUM_SINGULATIVE:()=>sr,NUM_TRIAL:()=>rr,NURL_NUMERAL_ADVERB:()=>lr,ORD_1ST:()=>hr,ORD_2ND:()=>dr,ORD_3RD:()=>pr,ORD_4TH:()=>gr,ORD_5TH:()=>fr,ORD_6TH:()=>mr,ORD_7TH:()=>br,ORD_8TH:()=>Er,ORD_9TH:()=>yr,PARADIGM_CAT_KAYLO:()=>la,PARADIGM_CAT_STATE:()=>ha,POFS_ADJECTIVE:()=>P,POFS_ADVERB:()=>M,POFS_ADVERBIAL:()=>x,POFS_ARTICLE:()=>B,POFS_CONJUNCTION:()=>R,POFS_DENOMINATIVE:()=>Z,POFS_EXCLAMATION:()=>U,POFS_GERUNDIVE:()=>J,POFS_INTERJECTION:()=>V,POFS_NOUN:()=>H,POFS_NOUN_PROPER:()=>k,POFS_NUMERAL:()=>j,POFS_PARTICLE:()=>G,POFS_PREFIX:()=>W,POFS_PREPOSITION:()=>$,POFS_PRONOUN:()=>z,POFS_SUFFIX:()=>q,POFS_SUPINE:()=>K,POFS_VERB:()=>X,POFS_VERB_PARTICIPLE:()=>Y,STR_LANG_CODE_AR:()=>y,STR_LANG_CODE_ARA:()=>E,STR_LANG_CODE_ENG:()=>N,STR_LANG_CODE_FA:()=>w,STR_LANG_CODE_FAS:()=>I,STR_LANG_CODE_FA_IR:()=>S,STR_LANG_CODE_GEZ:()=>_,STR_LANG_CODE_GRC:()=>b,STR_LANG_CODE_LA:()=>m,STR_LANG_CODE_LAT:()=>f,STR_LANG_CODE_PER:()=>v,STR_LANG_CODE_SYC:()=>O,STR_LANG_CODE_SYR:()=>D,STR_LANG_CODE_SYR_SYRJ:()=>F,STR_LANG_CODE_UNDEFINED:()=>g,STR_LANG_CODE_ZH:()=>T,STR_LANG_CODE_ZHO:()=>A,STR_LANG_CODE_ZH_HANS:()=>C,STR_LANG_CODE_ZH_HANT:()=>L,TENSE_AORIST:()=>Ir,TENSE_FUTURE:()=>vr,TENSE_FUTURE_PERFECT:()=>Sr,TENSE_IMPERFECT:()=>wr,TENSE_PAST_ABSOLUTE:()=>_r,TENSE_PERFECT:()=>Ar,TENSE_PLUPERFECT:()=>Tr,TENSE_PRESENT:()=>Lr,TYPE_IRREGULAR:()=>Zr,TYPE_REGULAR:()=>Qr,VKIND_COMPOUNDS_OF_TO_BE:()=>Or,VKIND_DEPONENT:()=>Br,VKIND_IMPERSONAL:()=>xr,VKIND_INTRANSITIVE:()=>Mr,VKIND_PERFECT_DEFINITE:()=>Ur,VKIND_SEMIDEPONENT:()=>Rr,VKIND_TAKING_ABLATIVE:()=>Dr,VKIND_TAKING_DATIVE:()=>Fr,VKIND_TAKING_GENITIVE:()=>Nr,VKIND_TO_BE:()=>Cr,VKIND_TRANSITIVE:()=>Pr,VOICE_ACTIVE:()=>Vr,VOICE_ADJUTATIVE:()=>Jr,VOICE_ANTIPASSIVE:()=>Wr,VOICE_APPLICATIVE:()=>Kr,VOICE_CAUSATIVE:()=>qr,VOICE_CIRCUMSTANTIAL:()=>Xr,VOICE_DEPONENT:()=>Yr,VOICE_IMPERSONAL_PASSIVE:()=>jr,VOICE_MEDIOPASSIVE:()=>kr,VOICE_MIDDLE:()=>Gr,VOICE_PASSIVE:()=>Hr,VOICE_RECIPROCAL:()=>zr,VOICE_REFLEXIVE:()=>$r});const t=Symbol("word"),a=Symbol("char"),s=Symbol("ltr"),n=Symbol("rtl"),i=Symbol("undefined"),o=Symbol("latin"),u=Symbol("greek"),c=Symbol("arabic"),l=Symbol("persian"),h=Symbol("ge'ez"),d=Symbol("chinese"),p=Symbol("syriac"),g="undefined",f="lat",m="la",b="grc",E="ara",y="ar",I="fas",v="per",S="fa-IR",w="fa",_="gez",A="zho",T="zh",L="zh-Hant",C="zh-Hans",O="syc",D="syr",F="syr-Syrj",N="eng",P="adjective",M="adverb",x="adverbial",B="article",R="conjunction",U="exclamation",V="interjection",H="noun",k="proper noun",j="numeral",G="particle",W="prefix",$="preposition",z="pronoun",q="suffix",J="gerundive",K="supine",X="verb",Y="verb participle",Z="denominative",Q="masculine",ee="feminine",te="neuter",re="common",ae="animate",se="inanimate",ne="personal masculine",ie="animate masculine",oe="inanimate masculine",ue="positive",ce="comparative",le="superlative",he="abessive",de="ablative",pe="absolutive",ge="accusative",fe="addirective",me="adelative",be="adessive",Ee="adverbial",ye="allative",Ie="antessive",ve="apudessive",Se="aversive",we="benefactive",_e="caritive",Ae="causal",Te="causal-final",Le="comitative",Ce="dative",Oe="delative",De="direct",Fe="distributive",Ne="distributive-temporal",Pe="elative",Me="ergative",xe="essive",Be="essive-formal",Re="essive-modal",Ue="equative",Ve="evitative",He="exessive",ke="final",je="formal",Ge="genitive",We="illative",$e="inelative",ze="inessive",qe="instructive",Je="instrumental",Ke="instrumental-comitative",Xe="intransitive",Ye="lative",Ze="locative",Qe="modal",et="multiplicative",tt="nominative",rt="partitive",at="pegative",st="perlative",nt="possessive",it="postelative",ot="postdirective",ut="postessive",ct="postpositional",lt="prepositional",ht="privative",dt="prolative",pt="prosecutive",gt="proximative",ft="separative",mt="sociative",bt="subdirective",Et="subessive",yt="subelative",It="sublative",vt="superdirective",St="superessive",wt="superlative",_t="suppressive",At="temporal",Tt="terminative",Lt="translative",Ct="vialis",Ot="vocative",Dt="admirative",Ft="cohortative",Nt="conditional",Pt="declarative",Mt="dubitative",xt="energetic",Bt="eventive",Rt="generic",Ut="gerundive",Vt="hypothetical",Ht="imperative",kt="indicative",jt="inferential",Gt="infinitive",Wt="interrogative",$t="jussive",zt="negative",qt="optative",Jt="participle",Kt="presumptive",Xt="renarrative",Yt="subjunctive",Zt="supine",Qt="singular",er="plural",tr="dual",rr="trial",ar="paucal",sr="singulative",nr="collective",ir="distributive plural",or="cardinal",ur="ordinal",cr="distributive",lr="numeral adverb",hr="1st",dr="2nd",pr="3rd",gr="4th",fr="5th",mr="6th",br="7th",Er="8th",yr="9th",Ir="aorist",vr="future",Sr="future perfect",wr="imperfect",_r="past absolute",Ar="perfect",Tr="pluperfect",Lr="present",Cr="to be",Or="compounds of to be",Dr="taking ablative",Fr="taking dative",Nr="taking genitive",Pr="transitive",Mr="intransitive",xr="impersonal",Br="deponent",Rr="semideponent",Ur="perfect definite",Vr="active",Hr="passive",kr="mediopassive",jr="impersonal passive",Gr="middle",Wr="antipassive",$r="reflexive",zr="reciprocal",qr="causative",Jr="adjutative",Kr="applicative",Xr="circumstantial",Yr="deponent",Zr="irregular",Qr="regular",ea="personal",ta="reflexive",ra="possessive",aa="demonstrative",sa="relative",na="interrogative",ia="general relative",oa="indefinite",ua="intensive",ca="reciprocal",la="kaylo",ha="state";var da=__nested_webpack_require_22140__(105);class ResourceProvider{constructor(e="",t="",r=new Map([["default",t]])){this.uri=e,this.rights=r,this.rights.has("default")||this.rights.set("default",t)}toString(){return this.rights.get("default")}toLocaleString(e){return this.rights.get(e)||this.rights.get("default")}static getProxy(e=null,t={}){return new Proxy(t,{get:function(t,r){return"provider"===r?e:t[r]}})}convertToJSONObject(){let e={};for(const[t,r]of this.rights.entries())e[t]=r;return{uri:this.uri,rights:e}}static readObject(e){const t=new Map;return e.rights&&Object.keys(e.rights).forEach((r=>{t.set(r,e.rights[r])})),new ResourceProvider(e.uri,"",t)}}const pa=ResourceProvider;class Definition{constructor(e,t,r,a){this.text=e,this.language=t,this.format=r,this.lemmaText=a,this.ID=(0,da.v4)()}static readObject(e){let t=new Definition(e.text,e.language,e.format,e.lemmaText);if(e.ID&&(t.ID=e.ID),e.provider){const r=pa.readObject(e.provider);return pa.getProxy(r,t)}return t}convertToJSONObject(){let e={text:this.text,language:this.language,format:this.format,lemmaText:this.lemmaText,ID:this.ID};return this.provider&&(e.provider=this.provider.convertToJSONObject()),e}}const ga=Definition,fa=class FeatureImporter{constructor(e=[],t=!1){this.hash={};for(const t of e)this.map(t,t);return this.returnUnknown=t,this}map(e,t){if(!e)throw new Error("Imported value should not be empty.");if(!t)throw new Error("Library value should not be empty.");return this.hash[e]=t,this}has(e){return this.hash.hasOwnProperty(e)}get(e){if(this.has(e))return this.hash[e];if(this.returnUnknown)return e;throw new Error('A value "'+e+'" is not found in the importer.')}};let ma;class Logger{constructor({verbose:e=!1,prepend:t=!0,trace:r=!1}={}){this._verboseMode=e,this._prependMode=t,this._traceMode=r}static getInstance(e={}){return ma?(void 0!==e.verbose&&(console.info("Setting a verbose mode"),ma.setVerboseMode(e.verbose)),void 0!==e.prepend&&(console.info("Setting a prepend mode"),ma.setVerboseMode(e.prepend)),void 0!==e.trace&&(console.info("Setting a trace mode"),ma.setTraceMode(e.trace))):ma=new Logger(e),ma}setVerboseMode(e){return this._verboseMode=e,this}setPrependMode(e){return this._prependMode=e,this}setTraceMode(e){return this._traceMode=e,this}verboseModeOn(){return this.setVerboseMode(!0),this}verboseModeOff(){return this.setVerboseMode(!1),this}prependModeOn(){return this.setPrependMode(!0),this}prependModeOff(){return this.setPrependMode(!1),this}traceModeOn(){return this.setTraceMode(!0),this}traceModeOff(){return this.setTraceMode(!1),this}error(...e){this._prependMode&&e&&e.length>0&&"string"==typeof e[0]&&(e[0]=`Alpheios error: ${e[0]}`),console.error(...e),this._traceMode&&console.trace()}warn(...e){this._verboseMode&&(this._prependMode&&e&&e.length>0&&"string"==typeof e[0]&&(e[0]=`Alpheios warn: ${e[0]}`),console.warn(...e),this._traceMode&&console.trace())}log(...e){this._verboseMode&&(this._prependMode&&e&&e.length>0&&"string"==typeof e[0]&&(e[0]=`Alpheios log: ${e[0]}`),console.log(...e),this._traceMode&&console.trace())}info(...e){this._verboseMode&&(this._prependMode&&e&&e.length>0&&"string"==typeof e[0]&&(e[0]=`Alpheios info: ${e[0]}`),console.info(...e),this._traceMode&&console.trace())}}class Feature{constructor(e,t,r,a=1,s=[]){if(!Feature.isAllowedType(e))throw new Error('Features of "'+e+'" type are not supported.');if(!t)throw new Error("Feature should have a non-empty value(s).");if(!r)throw new Error("No language ID is provided");this.type=e,this.languageID=r,this.sortOrder=a,this.allowedValues=s,this._data=Feature.dataValuesFromInput(t),this.sort()}static dataValuesFromInput(e){let t;return t=Array.isArray(e)?Array.isArray(e[0])?e:e.map(((t,r)=>[t,e.length-r])):[[e,this.defaultSortOrder]],t.map((e=>({value:e[0],sortOrder:Number.parseInt(e[1])})))}static newFromFtr(e){}static get types(){return{word:"word",fullForm:"full form",hdwd:"headword",part:"part of speech",number:"number",case:"case",grmCase:"case",declension:"declension",gender:"gender",type:"type",class:"class",grmClass:"class",conjugation:"conjugation",comparison:"comparison",tense:"tense",voice:"voice",mood:"mood",person:"person",frequency:"frequency",meaning:"meaning",source:"source",footnote:"footnote",dialect:"dialect",note:"note",pronunciation:"pronunciation",age:"age",area:"area",geo:"geo",kind:"kind",derivtype:"derivtype",stemtype:"stemtype",morph:"morph",var:"var",radical:"radical",kaylo:"kaylo",state:"state"}}static isAllowedType(e){return Object.values(this.types).includes(`${e}`)}static get defaultSortOrder(){return 1}static get joinSeparator(){return" "}static get defaultImporterName(){return"default"}get allowsUnrestrictedValues(){return 0===this.allowedValues.length}sort(){this._data.sort(((e,t)=>e.sortOrder!==t.sortOrder?t.sortOrder-e.sortOrder:e.value.localeCompare(t.value)))}compareTo(e){return e?e._data[0].sortOrder-this._data[0].sortOrder:-1}get items(){return this._data}get value(){return this.values.join(this.constructor.joinSeparator)}get singleValue(){if(0!==this._data.length){if(this._data.length>1)throw new Error(Feature.errMsgs.NO_SINGLE_VALUE);return this._data[0].value}}get values(){return this._data.map((e=>e.value))}getValue(e){return this._data.find((t=>t.value===e))}get valQty(){return this._data.length}get isEmpty(){return 0===this.valQty}get isSingle(){return 1===this.valQty}get isMultiple(){return this.valQty>1}toString(){return this.value}hasValue(e){return this.values.includes(e)}hasValues(e){let t=!0;for(const r of e)t=t&&this.hasValue(r);return t}hasSomeValues(e){let t=!1;for(const r of e)t=t||this.hasValue(r);return t}get valuesUnrestricted(){return 0===this.allowedValues.length}isEqual(e){return e&&this.type===e.type&&Ba.compareLanguages(this.languageID,e.languageID)&&this.value===e.value}addValue(e,t=this.constructor.defaultSortOrder){return this.hasValue(e)?Logger.getInstance().warn(`Value "${e}" already exists. If you want to change it, use "getValue" to access it directly.`):(this._data.push({value:e,sortOrder:t}),this.sort()),this}addValues(e){const t=this.constructor.dataValuesFromInput(e),r=t.map((e=>e.value));return this.hasSomeValues(r)?Logger.getInstance().warn(`One or several values from "${r}" already exist. If you want to change it, use "getValue" to access a value directly.`):(this._data=this._data.concat(t),this.sort()),this}removeValue(e){Logger.getInstance().warn("This feature is not implemented yet")}createFeature(e,t=this.constructor.defaultSortOrder){return new Feature(this.type,[[e,t]],this.languageID,this.sortOrder,this.allowedValues)}createFeatures(e){return new Feature(this.type,e,this.languageID,this.sortOrder,this.allowedValues)}get ownFeatures(){return this.values.map((e=>new Feature(this.type,e,this.languageID,1,this.allowedValues)))}getCopy(){const e=this._data.map((e=>[e.value,e.sortOrder]));return new Feature(this.type,e,this.languageID,this.sortOrder,this.allowedValues.slice())}addImporter(e=new fa,t=this.constructor.defaultImporterName){return this.importers||(this.importers=new Map),this.importers.set(t,e),e}getImporter(e=this.constructor.defaultImporterName){if(!this.importers||!this.importers.has(e))throw new Error(`Importer "${e}" does not exist`);return this.importers.get(e)}addFromImporter(e,t=this.constructor.defaultImporterName){if(!this.importers||!this.importers.has(t))throw new Error(`Importer "${t}" does not exist`);const r=this.importers.get(t);return e=this.constructor.dataValuesFromInput(e),this._data.push(...e.map((e=>({value:r.get(e.value),sortOrder:e.sortOrder})))),this.sort(),this}createFromImporter(e,t=this.constructor.defaultImporterName){if(!this.importers||!this.importers.has(t))throw new Error(`Importer "${t}" does not exist`);const r=this.importers.get(t);Array.isArray(e)||(e=[e]);let a=e.map((e=>r.get(e)));return a=a.reduce(((e,t)=>e.concat(t)),[]),new Feature(this.type,a,this.languageID,this.sortOrder,this.allowedValues)}convertToJSONObject(){const e=this._data.map((e=>[e.value,e.sortOrder]));return{type:this.type,languageCode:Ba.getLanguageCodeFromId(this.languageID),sortOrder:this.sortOrder,allowedValues:this.allowedValues,data:e}}static readObject(e){const t=Ba.getLanguageIdFromCode(e.languageCode);return new Feature(e.type,e.data,t,e.sortOrder,e.allowedValues)}}Feature.errMsgs={NO_SINGLE_VALUE:"More than one value stored"};class FeatureType{constructor(e,t,r){if(!t||!Array.isArray(t))throw new Error("Values should be an array (or an empty array) of values.");if(!r)throw new Error("FeatureType constructor requires a language");this.type=e,this.languageID=void 0,this.languageCode=void 0,({languageID:this.languageID,languageCode:this.languageCode}=Ba.getLanguageAttrs(r)),this._orderIndex=[],this._orderLookup={};for(const[e,r]of t.entries())if(this._orderIndex.push(r),Array.isArray(r))for(const t of r)this[t]=new Feature(this.type,t,this.languageID),this._orderLookup[t]=e;else this[r]=new Feature(this.type,r,this.languageID),this._orderLookup[r]=e}get language(){return Logger.getInstance().warn('Please use a "languageID" instead of a "language"'),this.languageCode}hasUnrestrictedValue(){return 1===this.orderedValues.length&&this.orderedValues[0]===FeatureType.UNRESTRICTED_VALUE}get(e,t=1){if(e)return new Feature(this.type,[[e,t]],this.languageID);throw new Error("A non-empty value should be provided.")}getValues(e){return new Feature(this.type,e,this.languageID)}getFromImporter(e,t){let r;try{r=this.importer[e].get(t)}catch(e){r=this.get(t)}return r}addImporter(e){if(!e)throw new Error("Importer should have a non-empty name.");return this.importer=this.importer||{},this.importer[e]=this.importer[e]||new fa,this.importer[e]}get orderedFeatures(){return this.orderedValues.map((e=>new Feature(this.type,e,this.languageID)))}get orderedValues(){return this._orderIndex}get orderLookup(){return this._orderLookup}set order(e){if(!e||Array.isArray(e)&&0===e.length)throw new Error("A non-empty list of values should be provided.");Array.isArray(e)||(e=[e]);for(const t of e)if(Array.isArray(t))for(const e of t){if(!this.hasOwnProperty(e.value))throw new Error('Trying to order an element with "'+e.value+'" value that is not stored in a "'+this.type+'" type.');if(e.type!==this.type)throw new Error('Trying to order an element with type "'+e.type+'" that is different from "'+this.type+'".');if(!Ba.compareLanguages(e.languageID,this.languageID))throw new Error(`Trying to order an element with language "${e.languageID.toString()}" that is different from "${this.languageID.toString()}"`)}else{if(!this.hasOwnProperty(t.value))throw new Error('Trying to order an element with "'+t.value+'" value that is not stored in a "'+this.type+'" type.');if(t.type!==this.type)throw new Error('Trying to order an element with type "'+t.type+'" that is different from "'+this.type+'".');if(!Ba.compareLanguages(t.languageID,this.languageID))throw new Error(`Trying to order an element with language "${t.languageID.toString()}" that is different from "${this.languageID.toString()}"`)}this._orderLookup={},this._orderIndex=[];for(const[t,r]of e.entries())if(Array.isArray(r)){let e=[];for(const a of r)this._orderLookup[a.value]=t,e.push(a.value);this._orderIndex[t]=e}else this._orderLookup[r.value]=t,this._orderIndex[t]=r.value}}FeatureType.UNRESTRICTED_VALUE=Symbol("unrestricted");const ba=FeatureType,Ea=class InflectionGroupingKey{constructor(e,t,r={}){for(const r of t)this[r]=e[r];Object.assign(this,r)}hasFeatureValue(e,t){return!!this.hasOwnProperty(e)&&this[e].values.includes(t)}toString(){let e=[];for(const t of Object.getOwnPropertyNames(this).sort()){const r=this[t]instanceof Feature?this[t].values.sort().join(","):this[t];e.push(r)}return e.join(" ")}},ya=class InflectionGroup{constructor(e,t=[],r=null){this.groupingKey=e,this.inflections=t}append(e){this.inflections.push(e)}};class LanguageModel{constructor(){this.context_backward=LanguageModel.contextBackward}static get contextForward(){return 0}static get contextBackward(){return 0}static get direction(){return s}static get baseUnit(){return t}get contextForward(){return Logger.getInstance().warn('Please use static "contextForward" instead'),this.constructor.contextForward}get contextBackward(){return Logger.getInstance().warn('Please use static "contextBackward" instead'),this.constructor.contextBackward}get direction(){return Logger.getInstance().warn('Please use static "direction" instead'),this.constructor.direction}get baseUnit(){return Logger.getInstance().warn('Please use static "baseUnit" instead'),this.constructor.baseUnit}get features(){return Logger.getInstance().warn('Please use individual "getFeatureType" or static "features" instead'),this.constructor.features}static get featureNames(){return this.featureValues.keys()}static typeFeature(e){if(this.typeFeatures.has(e))return this.typeFeatures.get(e);throw new Error(`Type feature "${e}" is not defined within "${this}"`)}static get typeFeatures(){Logger.getInstance().warn("This getter must be defined in a descendant class")}static get features(){let e={};for(const t of this.featureNames)e[t]=this.getFeature(t);return e}static get languageID(){return i}static get languageCode(){return g}static get languageCodes(){return[]}static get codes(){return Logger.getInstance().warn('Use static "languageCodes" instead'),this.languageCodes}get codes(){return Logger.getInstance().warn('Please use a static version of "codes" instead'),this.constructor.languageCodes}toCode(){return Logger.getInstance().warn('Please use a static "languageCode" instead'),this.constructor.languageCode}static toCode(){return Logger.getInstance().warn('Please use a static "languageCode" instead'),this.languageCode}static get featureValues(){return new Map([[Feature.types.part,[M,x,P,B,R,U,V,H,j,G,W,$,z,q,K,X,Y]],[Feature.types.gender,[Q,ee,te]],[Feature.types.type,[Qr,Zr]],[Feature.types.person,[hr,dr,pr]],[Feature.types.number,[Qt,er]],[Feature.types.age,[]],[Feature.types.area,[]],[Feature.types.source,[]],[Feature.types.frequency,[]],[Feature.types.geo,[]],[Feature.types.pronunciation,[]],[Feature.types.kind,[]],[Feature.types.comparison,[]],[Feature.types.morph,[]],[Feature.types.stemtype,[]],[Feature.types.derivtype,[]]])}static get sourceLanguage(){return Logger.getInstance().warn("Please use languageID directly"),this.languageID}get sourceLanguage(){return Logger.getInstance().warn("Please use languageID directly"),this.constructor.languageID}static getFeatureType(e){Logger.getInstance().warn("Please use getFeature instead");const t=this.featureValues;if(t.has(e))return new ba(e,t.get(e),this.languageID);throw new Error(`Feature "${e}" is not defined`)}static getFeature(e){const t=this.featureValues;if(t.has(e)){const r=t.get(e);return new Feature(e,r,this.languageID,1,r)}throw new Error(`Feature "${e}" is not defined`)}_initializeFeatures(){const e={};for(const t of this.constructor.featureValues.keys())e[t]=this.constructor.getFeature(t);return e}grammarFeatures(){return Logger.getInstance().warn('Please use a static version of "grammarFeatures" instead'),this.constructor.grammarFeatures()}static grammarFeatures(){return[]}static canInflect(e){return!1}static supportsLanguage(e){return this.languageCodes.includes[e]}static hasTrailingDigit(e){return/^.+\d$/.test(e)}static normalizeTrailingDigit(e){return/^.+\d$/.test(e)?e.substring(0,e.length-1):e}static needsNormalization(e){return Boolean(e.localeCompare(this.normalizeText(e)))}static hasUpperCase(e){return Boolean(e.localeCompare(e.toLocaleLowerCase()))}static normalizeText(e){return e}static normalizePartOfSpeechValue(e){return e.lemma.features[Feature.types.part]?e.lemma.features[Feature.types.part].value:null}static normalizeFeatureValue(e,t){return t}static alternateWordEncodings({word:e=null,preceding:t=null,following:r=null,encoding:a=null,preserveCase:s=!1,includeOriginal:n=!1}={}){return n?[e]:[]}static compareWords(e,t,r=!0,a={}){return r?(e=this.normalizeTrailingDigit(e),t=this.normalizeTrailingDigit(t),this.normalizeText(e)===this.normalizeText(t)):e===t}static compareFeatureValue(e,t,r,{normalize:a=!0}={}){return a&&(t=this.normalizeFeatureValue(e,t),r=this.normalizeFeatureValue(e,r)),t===r}static getPunctuation(){return"\\-\\.,;:!?'\"(){}\\[\\]<>\\ ‐‑‒–—―‘’†‡“”··\n\r"}getPunctuation(){return Logger.getInstance().warn('Please use a static version of "getPunctuation"'),this.constructor.getPunctuation()}toString(){return String(this.constructor.languageCode)}isEqual(e){return Ba.compareLanguages(this.languageID,e.languageID)}static hasCode(e){if(this.isLanguageCode(e))return this.languageCodes.includes(e);throw new Error(`Format of a "${e}" is incorrect`)}static isLanguageID(e){return"symbol"==typeof e}static isLanguageCode(e){return!LanguageModel.isLanguageID(e)}canInflect(e){return Logger.getInstance().warn('Please use a static version of "canInflect" instead'),this.constructor.canInflect(e)}static groupInflectionsForDisplay(e){let t=new Map;const r=this.aggregateInflectionsForDisplay(e);for(const e of r){const r=new Ea(e,[Feature.types.part,Feature.types.declension,Feature.types.dialect,Feature.types.comparison],{prefix:e.prefix,suffix:e.suffix,stem:e.stem}),a=r.toString();t.has(a)?t.get(a).append(e):t.set(a,new ya(r,[e]))}for(const e of t){const t=new Map;for(const r of e[1].inflections){let e,a=!1;r[Feature.types.grmCase]?(e=Feature.types.number,a=!0):e=r[Feature.types.tense]?Feature.types.tense:r[Feature.types.part]===X||r[Feature.types.part]===M?Feature.types.part:"misc";const s=new Ea(r,[e],{isCaseInflectionSet:a}),n=s.toString();t.has(n)?t.get(n).append(r):t.set(n,new ya(s,[r]))}for(const e of t){const t=new Map,r=new Map;for(const a of e[1].inflections){const e=a[Feature.types.grmCase]?Math.max(a[Feature.types.grmCase].items.map((e=>e.sortOrder))):1,s=new Ea(a,[Feature.types.tense,Feature.types.voice]),n=s.toString();t.has(n)?t.get(n).append(a):(t.set(n,new ya(s,[a],e)),r.set(n,e))}e[1].inflections=[];const a=Array.from(t.keys()).sort(((e,t)=>{const a=r.get(e),s=r.get(t);return a>s?-1:s>a?1:0}));for(const r of a)e[1].inflections.push(t.get(r))}for(const e of t){const t=e[1];for(const e of t.inflections){let t=new Map;for(const r of e.inflections){const e=new Ea(r,[Feature.types.grmCase,Feature.types.comparison,Feature.types.gender,Feature.types.number,Feature.types.person,Feature.types.tense,Feature.types.mood,Feature.types.voice]),a=e.toString();t.has(a)?t.get(a).append(r):t.set(a,new ya(e,[r]))}e.inflections=Array.from(t.values())}}e[1].inflections=Array.from(t.values())}return Array.from(t.values())}static aggregateInflectionsForDisplay(e){return e}groupInflectionsForDisplay(e){return Logger.getInstance().warn('Please use a static version of "groupInflectionsForDisplay" instead'),this.constructor.groupInflectionsForDisplay(e)}}const Ia=LanguageModel;let va=new Map,Sa=!1;class LatinLanguageModel extends Ia{static get languageID(){return o}static get languageCode(){return f}static get languageCodes(){return[m,f]}static get contextForward(){return 0}static get contextBackward(){return 0}static get direction(){return s}static get baseUnit(){return t}static get featureValues(){return new Map([...Ia.featureValues,[Feature.types.grmClass,[ea,ta,ra,aa,sa,na]],[Feature.types.number,[Qt,er]],[Feature.types.grmCase,[tt,Ge,Ce,ge,de,Ze,Ot]],[Feature.types.declension,[hr,dr,pr,gr,fr]],[Feature.types.tense,[Lr,wr,vr,Ar,Tr,Sr]],[Feature.types.voice,[Vr,Hr]],[Feature.types.mood,[kt,Yt,Ht,Jt,Zt,Ut,Jt,Gt]],[Feature.types.conjugation,[hr,dr,pr,gr]]])}static get typeFeatures(){return Sa||this.initTypeFeatures(),va}static initTypeFeatures(){for(const e of this.featureNames)va.set(e,this.getFeature(e));Sa=!0}static grammarFeatures(){return[Feature.types.part,Feature.types.grmCase,Feature.types.mood,Feature.types.declension,Feature.types.tense,Feature.types.conjugation]}static canInflect(e){return!0}static normalizeText(e){return e&&(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=e.replace(/[\u00c0\u00c1\u00c2\u00c3\u00c4\u0100\u0102]/g,"A")).replace(/[\u00c8\u00c9\u00ca\u00cb\u0112\u0114]/g,"E")).replace(/[\u00cc\u00cd\u00ce\u00cf\u012a\u012c]/g,"I")).replace(/[\u00d2\u00d3\u00d4\u00df\u00d6\u014c\u014e]/g,"O")).replace(/[\u00d9\u00da\u00db\u00dc\u016a\u016c]/g,"U")).replace(/[\u00c6\u01e2]/g,"AE")).replace(/[\u0152]/g,"OE")).replace(/[\u00e0\u00e1\u00e2\u00e3\u00e4\u0101\u0103]/g,"a")).replace(/[\u00e8\u00e9\u00ea\u00eb\u0113\u0115]/g,"e")).replace(/[\u00ec\u00ed\u00ee\u00ef\u012b\u012d\u0129]/g,"i")).replace(/[\u00f2\u00f3\u00f4\u00f5\u00f6\u014d\u014f]/g,"o")).replace(/[\u00f9\u00fa\u00fb\u00fc\u016b\u016d]/g,"u")).replace(/[\u00e6\u01e3]/g,"ae")).replace(/[\u0153]/g,"oe")),e}static normalizeFeatureValue(e,t){return e===Feature.types.mood&&t===Ut?Jt:e===Feature.types.part&&t===U?V:t}static normalizePartOfSpeechValue(e){return e.lemma.features[Feature.types.part]?e.lemma.features[Feature.types.part].value===U?V:e.lemma.features[Feature.types.part].value:null}static getPunctuation(){return".,;:!?'\"(){}\\[\\]<>\\ ‐‑‒–—―‘’†‡“”··\n\r‌‍"}static getInflectionConstraints(e){let t={fullFormBased:!1,suffixBased:!1,pronounClassRequired:!1};return e.hasOwnProperty(Feature.types.part)?[X,Y,K,J].includes(e[Feature.types.part].value)?(t.fullFormBased=!0,t.suffixBased=!0):e[Feature.types.part].value===z?t.fullFormBased=!0:t.suffixBased=!0:Logger.getInstance().warn("Unable to set grammar: part of speech data is missing or is incorrect",e[Feature.types.part]),t}}let wa=new Map,_a=!1;class GreekLanguageModel extends Ia{static get languageID(){return u}static get languageCode(){return b}static get languageCodes(){return[b]}static get contextForward(){return 0}static get contextBackward(){return 0}static get direction(){return s}static get baseUnit(){return t}static get featureValues(){return new Map([...Ia.featureValues,[Feature.types.grmClass,[aa,ia,oa,ua,na,ea,ra,ca,ta,sa]],[Feature.types.number,[Qt,er,tr]],[Feature.types.grmCase,[tt,Ge,Ce,ge,Ot]],[Feature.types.declension,[hr,dr,pr]],[Feature.types.tense,[Lr,wr,vr,Ar,Tr,Sr,Ir]],[Feature.types.voice,[Hr,Vr,kr,Gr]],[Feature.types.mood,[kt,Yt,qt,Ht]],[Feature.types.dialect,["attic","epic","doric"]]])}static get typeFeatures(){return _a||this.initTypeFeatures(),wa}static initTypeFeatures(){for(const e of this.featureNames)wa.set(e,this.getFeature(e));_a=!0}static canInflect(e){return!0}static grammarFeatures(){return[Feature.types.part,Feature.types.grmCase,Feature.types.mood,Feature.types.declension,Feature.types.tense,Feature.types.voice]}static normalizeText(e){return e&&(e=(e=e.normalize("NFC")).replace(/\u2019$/,"᾽")),e}static normalizePartOfSpeechValue(e){return e.lemma.features[Feature.types.part]?e.lemma.features[Feature.types.part].value===G?M:e.lemma.features[Feature.types.part].value===U?V:e.lemma.features[Feature.types.part].value:null}static normalizeFeatureValue(e,t){return e===Feature.types.part&&t===G?M:e===Feature.types.part&&t===U?V:t}static _tonosToOxia(e){return e.replace(/\u{03AC}/gu,"ά").replace(/\u{03AD}/gu,"έ").replace(/\u{03AE}/gu,"ή").replace(/\u{03AF}/gu,"ί").replace(/\u{03CC}/gu,"ό").replace(/\u{03CD}/gu,"ύ").replace(/\u{03CE}/gu,"ώ").replace(/\u{0390}/gu,"ΐ").replace(/\u{03B0}/gu,"ΰ")}static alternateWordEncodings({word:e=null,preceding:t=null,following:r=null,encoding:a=null,preserveCase:s=!1,includeOriginal:n=!1}={}){if(!e)return[];let i=GreekLanguageModel.normalizeText(e);s||(i=i.toLocaleLowerCase());const o=i.replace(/[\u{1FB0}\u{1FB1}]/gu,"α").replace(/[\u{1FB8}\u{1FB9}]/gu,"Α").replace(/[\u{1FD0}\u{1FD1}]/gu,"ι").replace(/[\u{1FD8}\u{1FD9}]/gu,"Ι").replace(/[\u{1FE0}\u{1FE1}]/gu,"υ").replace(/[\u{1FE8}\u{1FE9}]/gu,"Υ").replace(/[\u{00AF}\u{0304}\u{0306}]/gu,""),u=GreekLanguageModel._tonosToOxia(i),c=i.replace(/\u{0390}/gu,"ί").replace(/\u{03AA}/gu,"Ι").replace(/\u{03AB}/gu,"Υ").replace(/\u{03B0}/gu,"ύ").replace(/\u{03CA}/gu,"ι").replace(/\u{03CB}/gu,"υ").replace(/\u{1FD2}/gu,"ὶ").replace(/\u{1FD3}/gu,"ί").replace(/\u{1FD7}/gu,"ῖ").replace(/\u{1FE2}/gu,"ὺ").replace(/\u{1FE3}/gu,"ύ").replace(/\u{1FE7}/gu,"ῦ").replace(/\u{1FC1}/gu,"῀").replace(/\u{1FED}/gu,"`").replace(/\u{1FEE}/gu,"´").replace(/[\u{00A8}\u{0308}]/gu,""),l=i.normalize("NFD").replace(/[\u{300}\u{0301}\u{0304}\u{0306},\u{342}]/gu,"").normalize("NFC");let h=[];return"strippedDiaeresis"===a?h.push(c):"strippedDiacritics"===a?h.push(l):"strippedAll"===a?h.push(c.normalize("NFD").replace(/[\u{300}\u{0301}\u{0304}\u{0306},\u{342}\u{314}\u{313}\u{345}]/gu,"").normalize("NFC")):(h.push(o),u!==o&&h.push(u)),n||(h=h.filter((t=>t!==e))),h}static getPunctuation(){return'.,;:!?"(){}\\[\\]<>\\ ‐‑‒–—―‘†‡“”··\n\r‌‍'}static getInflectionConstraints(e){const t={fullFormBased:!1,suffixBased:!1,pronounClassRequired:!1},r=[z,j,B];return e.hasOwnProperty(Feature.types.part)?r.includes(e[Feature.types.part].value)?t.fullFormBased=!0:t.suffixBased=!0:Logger.getInstance().warn("Unable to set grammar: part of speech data is missing or is incorrect",e[Feature.types.part]),t.pronounClassRequired=Ba.compareLanguages(GreekLanguageModel.languageID,e.languageID)&&e.hasOwnProperty(Feature.types.part)&&e[Feature.types.part].value===z,t}static getPronounClasses(e,t,r,a=!0){let s=new Set;const n=e.filter((e=>{let s=!1;return!e.value||e.features[Feature.types.hdwd]&&e.features[Feature.types.hdwd].value!==r||(s=GreekLanguageModel.compareWords(e.value,t,a)),s}));for(const e of n)if(e.features.hasOwnProperty(Feature.types.grmClass))for(const t of e.features[Feature.types.grmClass].values)s.add(t);if(s.size>0)return new Feature(Feature.types.grmClass,Array.from(s),GreekLanguageModel.languageID)}static compareWords(e,t,r=!0,{normalizeTrailingDigit:a=!1}={}){let s=!1;if(r){a&&(e=this.normalizeTrailingDigit(e),t=this.normalizeTrailingDigit(t));const r=GreekLanguageModel.alternateWordEncodings({word:e,encoding:"strippedDiacritics",includeOriginal:!0}),n=GreekLanguageModel.alternateWordEncodings({word:t,encoding:"strippedDiacritics",includeOriginal:!0});for(let e=0;e<r.length&&(s=r[e]===n[e],!s);e++);s||(s=GreekLanguageModel.normalizeText(e)===GreekLanguageModel.normalizeText(t))}else s=e===t;return s}static isValidUnicode(e){return class GreekChars{static get chars(){return["`","¨","¯","´","ʼ","ʽ","˘","ͅ","Ά","Έ","Ή","Ί","Ό","Ύ","Ώ","ΐ","Α","Β","Γ","Δ","Ε","Ζ","Η","Θ","Ι","Κ","Λ","Μ","Ν","Ξ","Ο","Π","Ρ","Σ","Τ","Υ","Φ","Χ","Ψ","Ω","Ϊ","Ϋ","ά","έ","ή","ί","ΰ","α","β","γ","δ","ε","ζ","η","θ","ι","κ","λ","μ","ν","ξ","ο","π","ρ","ς","σ","τ","υ","φ","χ","ψ","ω","ϊ","ϋ","ό","ύ","ώ","Ϝ","ϝ","ἀ","ἁ","ἂ","ἃ","ἄ","ἅ","ἆ","ἇ","Ἀ","Ἁ","Ἂ","Ἃ","Ἄ","Ἅ","Ἆ","Ἇ","ἐ","ἑ","ἒ","ἓ","ἔ","ἕ","Ἐ","Ἑ","Ἒ","Ἓ","Ἔ","Ἕ","ἠ","ἡ","ἢ","ἣ","ἤ","ἥ","ἦ","ἧ","Ἠ","Ἡ","Ἢ","Ἣ","Ἤ","Ἥ","Ἦ","Ἧ","ἰ","ἱ","ἲ","ἳ","ἴ","ἵ","ἶ","ἷ","Ἰ","Ἱ","Ἲ","Ἳ","Ἴ","Ἵ","Ἶ","Ἷ","ὀ","ὁ","ὂ","ὃ","ὄ","ὅ","Ὀ","Ὁ","Ὂ","Ὃ","Ὄ","Ὅ","ὐ","ὑ","ὒ","ὓ","ὔ","ὕ","ὖ","ὗ","Ὑ","Ὓ","Ὕ","Ὗ","ὠ","ὡ","ὢ","ὣ","ὤ","ὥ","ὦ","ὧ","Ὠ","Ὡ","Ὢ","Ὣ","Ὤ","Ὥ","Ὦ","Ὧ","ὰ","ά","ὲ","έ","ὴ","ή","ὶ","ί","ὸ","ό","ὺ","ύ","ὼ","ώ","ᾀ","ᾁ","ᾂ","ᾃ","ᾄ","ᾅ","ᾆ","ᾇ","ᾈ","ᾉ","ᾊ","ᾋ","ᾌ","ᾍ","ᾎ","ᾏ","ᾐ","ᾑ","ᾒ","ᾓ","ᾔ","ᾕ","ᾖ","ᾗ","ᾘ","ᾙ","ᾚ","ᾛ","ᾜ","ᾝ","ᾞ","ᾟ","ᾠ","ᾡ","ᾢ","ᾣ","ᾤ","ᾥ","ᾦ","ᾧ","ᾨ","ᾩ","ᾪ","ᾫ","ᾬ","ᾭ","ᾮ","ᾯ","ᾰ","ᾱ","ᾲ","ᾳ","ᾴ","ᾶ","ᾷ","Ᾰ","Ᾱ","Ὰ","Ά","ᾼ","᾽","ι","῀","῁","ῂ","ῃ","ῄ","ῆ","ῇ","Ὲ","Έ","Ὴ","Ή","ῌ","῍","῎","῏","ῐ","ῑ","ῒ","ΐ","ῖ","ῗ","Ῐ","Ῑ","Ὶ","Ί","῝","῞","῟","ῠ","ῡ","ῢ","ΰ","ῤ","ῥ","ῦ","ῧ","Ῠ","Ῡ","Ὺ","Ύ","Ῥ","῭","΅","ῲ","ῳ","ῴ","ῶ","ῷ","Ὸ","Ό","Ὼ","Ώ","ῼ"]}}.chars.some((t=>e.includes(t)))}}const Aa=new Map;let Ta=!1;class ArabicLanguageModel extends Ia{static get languageID(){return c}static get languageCode(){return E}static get languageCodes(){return[E,y]}static get contextForward(){return 0}static get contextBackward(){return 0}static get direction(){return n}static get baseUnit(){return t}static get typeFeatures(){return Ta||this.initTypeFeatures(),Aa}static initTypeFeatures(){for(const e of this.featureNames)Aa.set(e,this.getFeature(e));Ta=!0}static canInflect(e){return!1}static alternateWordEncodings({word:e=null,preceding:t=null,following:r=null,encoding:a=null,preserveCase:s=!1,includeOriginal:n=!1}={}){const i=e.replace(/[\u{064B}\u{064C}\u{064D}\u{0640}]/gu,""),o=i.replace(/[\u{0622}\u{0623}\u{0625}]/gu,"ا"),u=o.replace(/[\u{064E}\u{064F}\u{0650}\u{0670}\u{0671}]/gu,""),c=u.replace(/\u{0651}/gu,""),l=c.replace(/\u{0652}/gu,""),h=l.replace(/\u{0627}/gu,""),d=new Map([["tanwin",i],["hamza",o],["harakat",u],["shadda",c],["sukun",l],["alef",h]]);let p=[];return p=null!==a&&d.has(a)?[d.get(a)]:Array.from(d.values()),n||(p=p.filter((t=>t!==e))),p}static getPunctuation(){return".,;:!?'\"(){}\\[\\]<>\\ ‐‑‒–—―‘’†‡“”··\n\r‌‍"}static aggregateInflectionsForDisplay(e){let t=[],r={[H]:[],[P]:[],[k]:[]};for(const a of e)a[Feature.types.morph]&&a[Feature.types.morph].value.match(/ADJ[uaiNK]/)?r[P].push(a):a[Feature.types.morph]&&a[Feature.types.morph].value.match(/NOUN[uaiNK]/)?r[H].push(a):a[Feature.types.morph]&&a[Feature.types.morph].value.match(/NOUN_PROP[uaiNK]/)?r[k].push(a):(a.example=null,t.push(a));for(const e of Object.keys(r))1!==t.filter((t=>t[Feature.types.part].value===e)).length&&t.push(...r[e]);return t}}let La=new Map,Ca=!1;class PersianLanguageModel extends Ia{static get languageID(){return l}static get languageCode(){return v}static get languageCodes(){return[v,I,w,S]}static get contextForward(){return 0}static get contextBackward(){return 0}static get direction(){return n}static get baseUnit(){return t}static get typeFeatures(){return Ca||this.initTypeFeatures(),La}static initTypeFeatures(){for(const e of this.featureNames)La.set(e,this.getFeature(e));Ca=!0}static canInflect(e){return!1}static getPunctuation(){return"\\-\\.,;:!?'\"(){}\\[\\]<>\\ ‐‑‒–—―‘’†‡“”··\n\r‌‍"}}const Oa=new Map;let Da=!1;class GeezLanguageModel extends Ia{static get languageID(){return h}static get languageCode(){return _}static get languageCodes(){return[_]}static get contextForward(){return 0}static get contextBackward(){return 0}static get direction(){return s}static get baseUnit(){return t}static get featureValues(){return new Map([...Ia.featureValues,[Feature.types.grmCase,[]],[Feature.types.number,[]],[Feature.types.gender,[]],[Feature.types.mood,[]]])}static get typeFeatures(){return Da||this.initTypeFeatures(),Oa}static initTypeFeatures(){for(const e of this.featureNames)Oa.set(e,this.getFeature(e));Da=!0}static canInflect(e){return!1}static getPunctuation(){return"፡፨።፣፤፥፦፧፠,;:!?'\"(){}\\[\\]<>\\ ‐‑‒–—―‘’†‡“”··\n\r‌‍"}}let Fa=new Map,Na=!1;class ChineseLanguageModel extends Ia{static get languageID(){return d}static get languageCode(){return A}static get languageCodes(){return[T,A,L,C]}static get contextForward(){return 5}static get contextBackward(){return 0}static get direction(){return s}static get baseUnit(){return a}static get featureValues(){return new Map([[Feature.types.fullForm,[]],[Feature.types.frequency,[]],[Feature.types.pronunciation,[]],[Feature.types.radical,[]]])}static get typeFeatures(){return Na||this.initTypeFeatures(),Fa}static initTypeFeatures(){for(const e of this.featureNames)Fa.set(e,this.getFeature(e));Na=!0}static getPunctuation(){return".,;:!?'\"(){}\\[\\]<>\\\n\r，、。「」《》‌‍†‡"}static _isVowel(e){return["a","e","i","o","u"].includes(e)}static formatPinyin(e){const t=["ā","á","ǎ","à","a"],r=["ē","é","ě","è","e"],a=["ī","í","ǐ","ì","i"],s=["ō","ó","ǒ","ò","o"],n=["ū","ú","ǔ","ù","u"],i=["ǖ","ǘ","ǚ","ǜ","ü"];e=e.split(/(\d)/).map((e=>e.trim())).filter((e=>Boolean(e)));let o=[];const u={1:0,2:1,3:2,4:3};for(let c=0;c<e.length;c++)if(c%2==0){let l=e[c];const h=void 0!==u[e[c+1]]?u[e[c+1]]:4;if(-1!==l.indexOf("a"))l=l.replace("a",t[h]);else if(-1!==l.indexOf("e"))l=l.replace("e",r[h]);else if(-1!==l.indexOf("ou"))l=l.replace("o",s[h]);else for(let e=l.length-1;e>=0;e--)if(this._isVowel(l[e])){switch(l[e]){case"i":l=l.replace("i",a[h]);break;case"o":l=l.replace("o",s[h]);break;case"u":l=e+1<l.length-1&&":"===l[e+1]?l.replace("u:",i[h]):l.replace("u",n[h]);break;default:Logger.getInstance().warn("some kind of weird vowel",l[e])}break}o.push(l)}return o.join(" ").trim()}}const Pa=new Map;let Ma=!1;class SyriacLanguageModel extends Ia{static get languageID(){return p}static get languageCode(){return D}static get languageCodes(){return[D,O,F]}static get contextForward(){return 0}static get contextBackward(){return 0}static get direction(){return n}static get baseUnit(){return t}static get featureValues(){return new Map([...Ia.featureValues,[Feature.types.part,[M,x,P,B,R,U,V,H,j,G,W,$,z,q,K,X,Y,Z]],[Feature.types.kaylo,[]],[Feature.types.state,[]]])}static get typeFeatures(){return Ma||this.initTypeFeatures(),Pa}static initTypeFeatures(){for(const e of this.featureNames)Pa.set(e,this.getFeature(e));Ma=!0}static canInflect(e){return!1}static getPunctuation(){return"܀܁܂܃܄܅܆܇܈܉܊܋܌܍܏.,;:!?'\"(){}\\[\\]<>/\\ ‐‑‒–—―‘’†‡“”\n\r‌‍"}static groupInflectionsForDisplay(e){const t=new Map,r=this.aggregateInflectionsForDisplay(e);for(const e of r){const r=new Ea(e,[Feature.types.part,Feature.types.declension,Feature.types.kaylo,Feature.types.state,Feature.types.comparison],{prefix:e.prefix,suffix:e.suffix,stem:e.stem}),a=r.toString();t.has(a)?t.get(a).append(e):t.set(a,new ya(r,[e]))}for(const e of t){const t=new Map;for(const r of e[1].inflections){let e,a=!1;r[Feature.types.grmCase]?(e=Feature.types.number,a=!0):e=r[Feature.types.tense]?Feature.types.tense:r[Feature.types.part]===X||r[Feature.types.part]===M?Feature.types.part:"misc";const s=new Ea(r,[e],{isCaseInflectionSet:a}),n=s.toString();t.has(n)?t.get(n).append(r):t.set(n,new ya(s,[r]))}for(const e of t){const t=new Map,r=new Map;for(const a of e[1].inflections){const e=a[Feature.types.grmCase]?Math.max(a[Feature.types.grmCase].items.map((e=>e.sortOrder))):1,s=new Ea(a,[Feature.types.tense,Feature.types.voice]),n=s.toString();t.has(n)?t.get(n).append(a):(t.set(n,new ya(s,[a],e)),r.set(n,e))}e[1].inflections=[];const a=Array.from(t.keys()).sort(((e,t)=>{const a=r.get(e),s=r.get(t);return a>s?-1:s>a?1:0}));for(const r of a)e[1].inflections.push(t.get(r))}for(const e of t){const t=e[1];for(const e of t.inflections){const t=new Map;for(const r of e.inflections){const e=new Ea(r,[Feature.types.grmCase,Feature.types.comparison,Feature.types.gender,Feature.types.number,Feature.types.person,Feature.types.tense,Feature.types.mood,Feature.types.voice]),a=e.toString();t.has(a)?t.get(a).append(r):t.set(a,new ya(e,[r]))}e.inflections=Array.from(t.values())}}e[1].inflections=Array.from(t.values())}return Array.from(t.values())}}const xa=new Map([[m,LatinLanguageModel],[f,LatinLanguageModel],[b,GreekLanguageModel],[E,ArabicLanguageModel],[y,ArabicLanguageModel],[v,PersianLanguageModel],[_,GeezLanguageModel],[A,ChineseLanguageModel],[D,SyriacLanguageModel],[O,SyriacLanguageModel],[F,SyriacLanguageModel]]);class LanguageModelFactory{static supportsLanguage(e){return e="symbol"==typeof e?LanguageModelFactory.getLanguageCodeFromId(e):e,xa.has(e)}static availableLanguages(){let e=new Set;for(const t of xa.values())e.add(t.languageCode);return Array.from(e)}static getLanguageModel(e){const t=LanguageModelFactory.getLanguageCodeFromId(e);return LanguageModelFactory.getLanguageModelFromCode(t)}static getLanguageModelFromCode(e){return xa.has(e)?xa.get(e):Ia}static getLanguageForCode(e=null){const t=xa.get(e);return t?new t:new Ia}static getLanguageIdFromCode(e){for(const t of xa.values())if(t.hasCode(e))return t.languageID;return i}static getLanguageCodeFromId(e){for(const t of xa.values())if(t.languageID.toString()===e.toString())return t.languageCode;return g}static getLanguageAttrs(e){return"symbol"==typeof e?{languageID:e,languageCode:LanguageModelFactory.getLanguageCodeFromId(e)}:{languageID:LanguageModelFactory.getLanguageIdFromCode(e),languageCode:e}}static compareLanguages(e,t){return(e="symbol"==typeof e?LanguageModelFactory.getLanguageCodeFromId(e):e)===("symbol"==typeof t?LanguageModelFactory.getLanguageCodeFromId(t):t)}static isExperimentalLanguage(e){return[h,p,d].includes(e)}}const Ba=LanguageModelFactory;class DefinitionSet{constructor(e,t){this.lemmaWord=e,this.languageID=t,this.shortDefs=[],this.fullDefs=[]}static readObject(e){const t=Ba.getLanguageIdFromCode(e.languageCode);let r=new DefinitionSet(e.lemmaWord,t);for(const t of e.shortDefs)r.shortDefs.push(ga.readObject(t));for(const t of e.fullDefs)r.fullDefs.push(ga.readObject(t));return r}get hasShortDefs(){return this.shortDefs.length>0}get hasFullDefs(){return this.fullDefs.length>0}isEmpty(){return 0===this.shortDefs.length&&0===this.fullDefs.length}appendShortDefs(e){return e&&(Array.isArray(e)||(e=[e]),this.shortDefs=this.shortDefs.concat(e)),this.shortDefs}clearShortDefs(){this.shortDefs=[]}appendFullDefs(e){return e&&(Array.isArray(e)||(e=[e]),this.fullDefs=this.fullDefs.concat(e)),this.fullDefs}clearFullDefs(){this.fullDefs=[]}convertToJSONObject(){const e=Ba.getLanguageCodeFromId(this.languageID);return{lemmaWord:this.lemmaWord,languageCode:e,shortDefs:this.shortDefs.map((e=>e.convertToJSONObject())),fullDefs:this.fullDefs.map((e=>e.convertToJSONObject()))}}}class GrmFeature{constructor(e,t,r,a=1){if(!GrmFeature.types.isAllowed(t))throw new Error('Features of "'+t+'" type are not supported.');if(!e)throw new Error("Feature should have a non-empty value.");if(!t)throw new Error("Feature should have a non-empty type.");if(!r)throw new Error("Feature constructor requires a language");this.value=e,this.type=t,this.languageID=void 0,this.languageCode=void 0,({languageID:this.languageID,languageCode:this.languageCode}=Ba.getLanguageAttrs(r)),this.sortOrder=a}get language(){return Logger.getInstance().warn('Please use a "languageID" instead of a "language"'),this.languageCode}isEqual(e){if(Array.isArray(e.value)){if(!Array.isArray(this.value)||this.value.length!==e.value.length)return!1;let t=this.type===e.type&&Ba.compareLanguages(this.languageID,e.languageID);return t=t&&this.value.every((function(t,r){return t===e.value[r]})),t}return Ba.compareLanguages(this.languageID,e.languageID)&&this.type===e.type&&this.value===e.value}isSubsetof(e){Array.isArray(e)||(e=[e]);const t=e[0].languageID,r=e[0].type,a=e.map((e=>e.value));return!(!Ba.compareLanguages(this.languageID,t)||this.type!==r||!a.includes(this.value))}hasValue(e){return Array.isArray(this.value)?this.value.includes(e):this.value===e}toString(){return Array.isArray(this.value)?this.value.join(","):this.value}static toFeature(e){if(Array.isArray(e)){if(!(e[0]instanceof Feature)){const t=e[0].type,r=e[0].languageID,a=e.map((e=>e.value));return new Feature(t,a,r)}}else if(!(e instanceof Feature))return new Feature(e.type,e.value,e.languageID);return e}}GrmFeature.types={word:"word",part:"part of speech",number:"number",case:"case",grmCase:"case",declension:"declension",gender:"gender",type:"type",class:"class",grmClass:"class",conjugation:"conjugation",comparison:"comparison",tense:"tense",voice:"voice",mood:"mood",person:"person",frequency:"frequency",meaning:"meaning",source:"source",footnote:"footnote",dialect:"dialect",note:"note",pronunciation:"pronunciation",age:"age",area:"area",geo:"geo",kind:"kind",derivtype:"derivtype",stemtype:"stemtype",morph:"morph",var:"var",isAllowed(e){const t=`${e}`;return Object.values(this).includes(t)}};const Ra=GrmFeature,Ua=class FeatureList{constructor(e=[]){this._features=[],this._types={},this.add(e)}add(e){if(!e||!Array.isArray(e))throw new Error("Features must be defined and must come in an array.");for(const t of e)this._features.push(t),this._types[t.type]=t}get items(){return this._features}forEach(e){this._features.forEach(e)}ofType(e){if(this.hasType(e))return this._types[e]}hasType(e){return this._types.hasOwnProperty(e)}};class Translation{constructor(e,t,r=[]){if(!e)throw new Error("Lemma should not be empty.");this.lemmaWord=e.word,this.languageCode=t,this.glosses=r}static readTranslationFromJSONList(e,t,r,a){if(!r||!Array.isArray(r))throw new Error("Recieved not proper translation list",r);const s=r.find((function(t){return t.in===e.word})),n=new Translation(e,t,s.translations);return a?pa.getProxy(a,n):n}static loadTranslations(e,t,r,a){e.addTranslation(this.readTranslationFromJSONList(e,t,r,a))}convertToJSONObject(){let e={languageCode:this.languageCode,translations:this.glosses};return this.provider&&(e.provider=this.provider.convertToJSONObject()),e}static readObject(e,t){const r=new Translation(t,e.languageCode,e.translations);if(e.provider){const t=pa.readObject(e.provider);return pa.getProxy(t,r)}return r}}const Va=Translation;class Lemma{constructor(e,t,r=[],a={}){if(!e)throw new Error("Word should not be empty.");if(!t)throw new Error("Language should not be empty.");this.languageID=void 0,this.languageCode=void 0,({languageID:this.languageID,languageCode:this.languageCode}=Ba.getLanguageAttrs(t)),this.word=e,this.principalParts=r,this.features={},this.ID=(0,da.v4)()}get language(){return Logger.getInstance().warn('Please use "languageID" instead of "language"'),this.languageCode}get displayWord(){return this.word.replace(/\d+$/,"")}static readObject(e){const t=e.language?e.language:e.languageCode;let r=new Lemma(e.word,t,e.principalParts,e.pronunciation);return e.features&&e.features.length>0&&e.features.forEach((e=>{r.addFeature(Feature.readObject(e))})),e.translation&&(r.translation=Va.readObject(e.translation,r)),r}convertToJSONObject(){let e=[];for(const t of Object.values(this.features))e.push(t.convertToJSONObject());let t={word:this.word,language:this.languageCode,principalParts:this.principalParts,features:e};return this.translation&&(t.translation=this.translation.convertToJSONObject()),t}set feature(e){if(Logger.getInstance().warn('Please use "addFeature" instead'),!e)throw new Error("feature data cannot be empty.");Array.isArray(e)||(e=[e]);const t=e[0].type;this.features[t]=[];for(const r of e){if(!(r instanceof Feature))throw new Error("feature data must be a Feature object.");if(!Ba.compareLanguages(r.languageID,this.languageID))throw new Error('Language "'+r.languageID.toString()+'" of a feature does not match a language "'+this.languageID.toString()+'" of a Lemma object.');this.features[t].push(r)}}addFeature(e){if(!e)throw new Error("feature data cannot be empty.");if(!(e instanceof Feature))throw new Error("feature data must be a Feature object.");if(!Ba.compareLanguages(e.languageID,this.languageID))throw new Error('Language "'+e.languageID.toString()+'" of a feature does not match a language "'+this.languageID.toString()+'" of a Lemma object.');this.features[e.type]=e}addFeatures(e){if(!Array.isArray(e))throw new Error("Features must be in an array");for(const t of e)this.addFeature(t)}addTranslation(e){if(!e)throw new Error("translation data cannot be empty.");if(-1===e.constructor.name.indexOf("Translation"))throw new Error("translation data must be a Translation object.");this.translation=e}isFullHomonym(e,{normalize:t=!1,ignorePofs:r=!1}={}){if(!(r||this.features[Feature.types.part]&&e.features[Feature.types.part]&&this.features[Feature.types.part].isEqual(e.features[Feature.types.part])))return!1;const a=Ba.getLanguageModel(this.languageID),s=t?a.compareWords(this.word,e.word,!0,{normalizeTrailingDigit:!0}):this.word===e.word,n=a.hasTrailingDigit(this.word),i=a.hasTrailingDigit(e.word);return(!n||!i||this.word.match(/\d+$/)[0]===e.word.match(/\d+$/)[0])&&s}disambiguate(e){const t=Ba.getLanguageModel(this.languageID);if(!t.compareWords(this.word,e.word,!0,{normalizeTrailingDigit:!0}))throw new Error("Words that differ cannot be disambiguated");const r=t.hasUpperCase(this.word);if(t.hasUpperCase(e.word))return e.word;if(r)return this.word;const a=t.needsNormalization(this.word);return t.needsNormalization(e.word)?t.normalizeText(e.word):a?t.normalizeText(this.word):(t.hasTrailingDigit(this.word),t.hasTrailingDigit(e.word)?e.word:this.word)}get wordPrincipalParts(){const e=[...this.principalParts];return this.principalParts.includes(this.word)||e.push(this.word),e.join(", ")}}const Ha=Lemma;class Inflection{constructor(e=null,t,r=null,a=null,s=null){if(!e&&!r)throw new Error("At least stem or suffix must be defined");if(!t)throw new Error("Language should not be empty.");if(!Ba.supportsLanguage(t))throw new Error(`language ${t} not supported.`);this.stem=e,this.languageID=void 0,this.languageCode=void 0,({languageID:this.languageID,languageCode:this.languageCode}=Ba.getLanguageAttrs(t)),this.model=Ba.getLanguageModel(this.languageID),this.features=new Set,this.constraints={fullFormBased:!1,suffixBased:!1,irregular:!1,obligatoryMatches:[],optionalMatches:[],morphologyMatches:[]},this.suffix=r,this.prefix=a,this.example=s,this.lemma=null}clone(){let e=new Inflection(this.stem,this.languageID,this.suffix,this.prefix,this.example);return e.addFeatures(Array.from(this.features).map((e=>this[e]))),e.constraints={fullFormBased:this.constraints.fullFormBased,suffixBased:this.constraints.suffixBased,irregular:this.constraints.irregular,obligatoryMatches:this.constraints.obligatoryMatches?Array.from(this.constraints.obligatoryMatches):[],optionalMatches:this.constraints.obligatoryMatches?Array.from(this.constraints.obligatoryMatches):[],morphologyMatches:this.constraints.morphologyMatches?Array.from(this.constraints.morphologyMatches):[]},e.lemma=this.lemma,e}get form(){const e=this.stem?" - ":"";return this.getForm(e)}getForm(e=""){let t,r,a;const s=this.stem?this.stem:"";return this.model.direction===n?(r=this.prefix?e+this.prefix:"",a=this.suffix?this.suffix+e:"",t=a+s+r):(r=this.prefix?this.prefix+e:"",a=this.suffix?e+this.suffix:"",t=r+s+a),t}get language(){return Logger.getInstance().warn('Please use a "languageID" instead of a "language"'),this.languageCode}setConstraints(){if(this.model.hasOwnProperty("getInflectionConstraints")){const e=this.model.getInflectionConstraints(this);this.constraints=Object.assign(this.constraints,e)}}smartWordCompare(e,t,r={}){let a;r.hasOwnProperty("normalize")||(r.normalize=!0),r.hasOwnProperty("fuzzySuffix")||(r.fuzzySuffix=!1),a=this.constraints.irregular?"Suffix"===t?this.suffix:this[Feature.types.fullForm]?this[Feature.types.fullForm].value:this.form:this.constraints.suffixBased?this.suffix:this.form;let s=this.modelCompareWords(e,a,r.normalize);if(!s&&"Suffix"===t&&r.fuzzySuffix){const t=this.getForm();if(t&&e&&t.length>=e.length){const a=t.substring(t.length-e.length);s=this.modelCompareWords(e,a,r.normalize)}}return s}compareWithWord(e,t=!0){const r=this.constraints.suffixBased?this.suffix:this.form;return this.modelCompareWords(e,r,t)}modelCompareWords(e,t,r=!0){return Ba.getLanguageModel(this.languageID).compareWords(e,t,r)}modelCompareFeatureValue(e,t,r,a=!0){return Ba.getLanguageModel(this.languageID).compareFeatureValue(e,t,r,{normalize:a})}disambiguatedBy(e,{ignorePofs:t=!1}={}){let r=!0,a=!0;0!==this.features.size&&0!==e.features.size||(r=!1),e.features.size>this.features.size&&(r=!1);for(const s of e.features)if(!t||s!==Feature.types.part)for(const t of e[s].values){if(!this.hasFeatureValue(s,t,{normalize:!0})){r=!1;break}this[s].values.length!==e[s].values.length&&(a=!1)}return{match:r,exactMatch:a}}set feature(e){if(Logger.getInstance().warn('Please use "addFeature" instead.'),!e)throw new Error("Inflection feature data cannot be empty.");Array.isArray(e)||(e=[e]);const t=e[0].type;this[t]=[];for(const r of e){if(!(r instanceof Feature))throw new Error("Inflection feature data must be a Feature object.");if(!Ba.compareLanguages(r.languageID,this.languageID))throw new Error(`Language "${r.languageID.toString()}" of a feature does not match\n          a language "${this.languageID.toString()}" of an Inflection object.`);this[t].push(r),this.features.add(t)}}addFeature(e){if(!e)throw new Error("feature data cannot be empty.");if(!(e instanceof Feature))throw new Error("feature data must be a Feature object.");if(!Ba.compareLanguages(e.languageID,this.languageID))throw new Error('Language "'+e.languageID.toString()+'" of a feature does not match a language "'+this.languageID.toString()+'" of a Lemma object.');this[e.type]=e,this.features.add(e.type)}addFeatures(e){if(!Array.isArray(e))throw new Error("Features must be in an array");for(const t of e)this.addFeature(t)}hasFeatureValue(e,t,{normalize:r=!1}={}){return!!this.hasOwnProperty(e)&&this[e].values.some((r=>this.modelCompareFeatureValue(e,r,t)))}toString(){let e=`Inflection stem: ${this.stem}, prefix: ${this.prefix}, suffix: ${this.suffix}, langID: ${this.languageID.toString()}\n  features:  `;for(const t of this.features.values())e+=`${t}: ${this[t].value}, `;e+="\n  constraints:  ";for(const[t,r]of Object.entries(this.constraints))Array.isArray(r)?e+=`${t}: [${r}], `:e+=`${t}: ${r}, `;return e+=`\n  example: ${this.example}`,e}static readObject(e,t){let r=new Inflection(e.stem,e.languageCode,e.suffix,e.prefix,e.example);return r.languageID=Ba.getLanguageIdFromCode(r.languageCode),e.features&&e.features.length>0&&e.features.forEach((e=>{r.addFeature(Feature.readObject(e))})),t&&(r.lemma=t),r}convertToJSONObject(){let e=[];for(const t of this.features.keys())e.push(this[t].convertToJSONObject());const t=Ba.getLanguageCodeFromId(this.languageID);return{stem:this.stem,languageCode:t,suffix:this.suffix,prefix:this.prefix,example:this.example,features:e}}}const ka=Inflection;class Lexeme{constructor(e,t,r=null){if(!e)throw new Error("Lemma should not be empty.");if(!(e instanceof Ha))throw new Error("Lemma should be of Lemma object type.");if(!t)throw new Error("Inflections data should not be empty.");if(!Array.isArray(t))throw new Error("Inflection data should be provided in an array.");for(const e of t)if(!(e instanceof ka))throw new Error("All inflection data should be of Inflection object type.");if(null!==r&&!(r instanceof DefinitionSet))throw new Error("Meaning should be of DefinitionSet object type.");this.lemma=e,this.altLemmas=[],this.inflections=[],this.addInflections(t),this.meaning=r||new DefinitionSet(this.lemma.word,this.lemma.languageID),this.disambiguated=!1,this.selectedInflection=null}setSelectedInflection(e){this.selectedInflection=e}getSelectedInflection(){return this.selectedInflection}getGroupedSelectedInflection(){return this.selectedInflection?Ba.getLanguageModel(this.lemma.languageID).groupInflectionsForDisplay([this.selectedInflection]):[]}addInflection(e){e.lemma=this.lemma,e.lexeme=this,this.inflections.push(e)}addInflections(e){Array.isArray(e)||(e=[e]),e.forEach((e=>this.addInflection(e)))}addAltLemma(e){this.altLemmas.push(e)}isPopulated(){return Object.entries(this.lemma.features).length>0||!this.meaning.isEmpty()||this.inflections.length>0}get hasShortDefs(){return Boolean(this.meaning&&this.meaning.hasShortDefs)}get hasFullDefs(){return Boolean(this.meaning&&this.meaning.hasFullDefs)}isFullHomonym(e,{normalize:t=!1}={}){const r=Ba.getLanguageModel(this.lemma.languageID),a=r.normalizePartOfSpeechValue(this);if(a===r.normalizePartOfSpeechValue(e)){const r=Boolean(a!==this.lemma.features[Feature.types.part]);return this.lemma.isFullHomonym(e.lemma,{normalize:t,ignorePofs:r})}return!1}canBeDisambiguatedWith(e){const t=e.inflections.length||Ia.hasTrailingDigit(e.lemma.word);return this.isFullHomonym(e,{normalize:!0})&&t}static disambiguateInflections(e,t){let r=new Lexeme(e.lemma,e.inflections,e.meaning);const a=Ba.getLanguageModel(e.lemma.languageID);if(e.canBeDisambiguatedWith(t))for(const e of r.inflections)for(const s of t.inflections){const n=a.normalizePartOfSpeechValue(t),i=Boolean(n!==t.lemma.features[Feature.types.part]),o=e.disambiguatedBy(s,{ignorePofs:i});o.match&&(o.exactMatch?r.setSelectedInflection(e):r.setSelectedInflection(s))}return r}setDisambiguation(e=null){this.disambiguated=!0,e&&(this.lemma.word=this.lemma.disambiguate(e.lemma))}getGroupedInflections(){return Ba.getLanguageModel(this.lemma.languageID).groupInflectionsForDisplay(this.inflections)}static readObject(e){const t=Ha.readObject(e.lemma);let r=[];for(const t of e.inflections)r.push(ka.readObject(t));const a=new Lexeme(t,r);if(e.meaning&&(a.meaning=DefinitionSet.readObject(e.meaning)),e.provider){const t=pa.readObject(e.provider);return pa.getProxy(t,a)}return a}convertToJSONObject(e=!1){let t=[];this.inflections.forEach((e=>{t.push(e.convertToJSONObject())}));const r={lemma:this.lemma.convertToJSONObject(),inflections:t};return e&&(r.meaning=this.meaning.convertToJSONObject()),this.provider&&(r.provider=this.provider.convertToJSONObject()),r}static getSortByTwoLemmaFeatures(e,t){return(r,a)=>{if(r.lemma.features[e]&&a.lemma.features[e]||!r.lemma.features[e]&&!a.lemma.features[[e]]){let s;return s=r.lemma.features[e]&&a.lemma.features[e]?r.lemma.features[e].compareTo(a.lemma.features[e]):0,0!==s?s:r.lemma.features[t]&&a.lemma.features[t]?r.lemma.features[t].compareTo(a.lemma.features[t]):r.lemma.features[t]&&!a.lemma.features[t]?-1:!r.lemma.features[t]&&a.lemma.features[t]?1:0}return r.lemma.features[e]&&!a.lemma.features[e]?-1:!r.lemma.features[e]&&a.lemma.features[e]?1:0}}}const ja=Lexeme;class Homonym{constructor(e,t){if(!e||Array.isArray(e)&&0===e.length)throw new Error("Lexemes data should not be empty.");if(!Array.isArray(e))throw new Error("Lexeme data should be provided in an array.");for(const t of e)if(!(t instanceof ja))throw new Error("All lexeme data should be of Lexeme object type.");this.lexemes=e,this.targetWord=t}static createSimpleForm(e,t,r=[]){const a=new Ha(e,t),s=new ja(a,r);return new Homonym([s],e)}get hasShortDefs(){return Boolean(this.lexemes&&this.lexemes.some((e=>e.hasShortDefs)))}get hasFullDefs(){return Boolean(this.lexemes&&this.lexemes.some((e=>e.hasFullDefs)))}static readObject(e){let t=[];if(e.lexemes)for(const r of e.lexemes)t.push(ja.readObject(r));else{const r=Ba.getLanguageIdFromCode(e.languageCode);t=[new ja(new Ha(e.targetWord,r),[])]}const r=new Homonym(t,e.form||e.targetWord);return r.lemmasList=e.lemmasList,r}convertToJSONObject(e=!1){let t={lexemes:[],form:this.targetWord};for(const r of this.lexemes)t.lexemes.push(r.convertToJSONObject(e));return t}get language(){return Logger.getInstance().warn("Please use languageID instead"),Ba.getLanguageCodeFromId(this.languageID)}get languageID(){if(this.lexemes&&this.lexemes[0]&&this.lexemes[0].lemma&&this.lexemes[0].lemma.languageID)return this.lexemes[0].lemma.languageID;throw new Error("Homonym has not been initialized properly. Unable to obtain language ID information.")}get inflections(){let e=[];for(const t of this.lexemes)e=e.concat(t.inflections);return e}isDisambiguated(){return this.lexemes.filter((e=>e.disambiguated)).length>0}static disambiguate(e,t){if(0===t.length)return e;const r=t.shift();let a=[],s=[],n=[],i=[];for(const t of r.lexemes){for(const r of e.lexemes){const e=r.canBeDisambiguatedWith(t)?ja.disambiguateInflections(r,t):r;r.isFullHomonym(t,{normalize:!0})?null!==e.getSelectedInflection()?(e.setDisambiguation(t),a.push(e)):n.push(e):i.push(e)}if(0===a.length)if(n.length>0)for(const e of n){e.setDisambiguation(t);for(const t of r.inflections)e.addInflection(t),e.setSelectedInflection(t)}else{t.setDisambiguation();for(const e of t.inflections)t.setSelectedInflection(e);s.push(t)}}const o=new Homonym([...s,...a,...n,...i],e.targetWord);return Homonym.disambiguate(o,t)}}const Ga=Homonym;class HomonymGroup{constructor(e=[]){this._homonyms=e}get homonyms(){return this._homonyms}get hasHomonyms(){return this._homonyms.length>0}toHomonym(e,{disambiguated:t=!1}={}){if(!e)throw new Error(HomonymGroup.errors.NO_TARGET_WORD);const r=this._homonyms.map((e=>e.lexemes)).flat();return t&&r.forEach((e=>{e.disambiguated=!0})),new Ga(r,e)}}HomonymGroup.errors={NO_TARGET_WORD:"Target word is not provided"};class PsEventData{constructor(e,t=""){this.name=e.name,this.publisher=e.publisher,this.caller=t}get description(){return this.caller?`${this.publisher}.${this.caller} -> [${this.name}]`:`${this.publisher} -> [${this.name}]`}}class PsEvent{constructor(e,t){this.name=e,this.publisher=t.name,this._subscribers=new Map}get subscribers(){return Array.from(this._subscribers.values())}sub(e){const t=(0,da.v4)();return this._subscribers.set(t,e),()=>{this._subscribers.delete(t)}}pub(e={},t=""){this._subscribers.forEach((r=>r(e,new PsEventData(this,t))))}unsubAll(){this._subscribers.clear()}}class TextQuoteSelector{constructor(e,t,r=null,a=null,s=null){this.languageCode=e,this.normalizedText=t,this.contextForward=6,this.contextBackward=6,this.text=this.normalizedText,this.prefix=r,this.suffix=a,this.source=s,this.ID=(0,da.v4)()}get contextHTML(){const e=`<span class="alpheios_worditem_incontext_add">${this.text}</span>`,t=this.prefix.replace(this.text,e),r=this.suffix.replace(this.text,e);return`${t} <span class="alpheios_worditem_incontext">${this.text}</span> ${r}`}static readObject(e){let t=new TextQuoteSelector(e.languageCode,e.target.selector.exact);return t.prefix=e.target.selector.prefix,t.suffix=e.target.selector.suffix,t.text=e.targetWord,t.source=e.target.source,t}isEqual(e){let t=`${this.prefix}${this.text}${this.suffix}`;t=t.trim();let r=`${e.prefix}${e.text}${e.suffix}`;return r=r.trim(),this.text===e.text&&this.source===e.source&&this.languageCode===e.languageCode&&t===r}updateLanguage(e){this.languageCode=e}}class WordUsageExample extends TextQuoteSelector{constructor(e,t,r,a,s,n){super(e,t),this.prefix=r,this.suffix=a,this.source=s,this.cit=n,this.author=null,this.textWork=null,this.passage=null}createContext(){return null}get htmlExample(){return`${this.prefix}<span class="alpheios_word_usage_list_item__text_targetword">${this.normalizedText}</span>${this.suffix}`}fullCit(e){if(!this.author&&!this.textWork&&!this.passage)return this.cit;let t="";return e?(t=this.author?this.author.title(e):".",t=t+" "+(this.textWork?this.textWork.title(e):"."),t=t+" "+this.formattedPassage):t=this.formattedAuthor+" "+this.formattedTextWork+" "+this.formattedPassage,t.trim()}get formattedAuthor(){return this.author?this.author.title():""}get formattedTextWork(){return this.textWork?this.textWork.title():""}get formattedPassage(){return this.passage}authorForSort(e){return this.author?this.author.title(e).toUpperCase():this.fullCit(e).toUpperCase()}textWorkForSort(e){return this.textWork?this.textWork.title(e).toUpperCase():this.fullCit(e).toUpperCase()}get prefixForSort(){const e=Ba.getLanguageModelFromCode(this.languageCode),t=this.prefix.replace(new RegExp("["+e.getPunctuation()+" ]","g")," ").toUpperCase().split(" ").filter((e=>e.length>0));return t[t.length-1]}get suffixForSort(){const e=Ba.getLanguageModelFromCode(this.languageCode);return this.suffix.replace(new RegExp("["+e.getPunctuation()+" ]","g"),"").toUpperCase()}}class Author{constructor(e,t,r){this.urn=e,this.titles=t,this.abbreviations=r}static get defaultLang(){return"eng"}title(e){return this.titles[e]?this.titles[e]:this.titles[Author.defaultLang]?this.titles[Author.defaultLang]:Object.values(this.titles).length>0?Object.values(this.titles)[0]:null}abbreviation(e){return this.abbreviations[e]?this.abbreviations[e]:this.abbreviations[Author.defaultLang]?this.abbreviations[Author.defaultLang]:Object.values(this.abbreviations).length>0?Object.values(this.abbreviations)[0]:null}}const Wa=Author;class TextWork{constructor(e,t,r,a){this.urn=t,this.titles=r,this.author=e,this.abbreviations=a}static get defaultLang(){return"eng"}static get defaultIDPrefix(){return"phi"}title(e){return this.titles[e]?this.titles[e]:this.titles[TextWork.defaultLang]?this.titles[TextWork.defaultLang]:Object.values(this.titles).length>0?Object.values(this.titles)[0]:null}abbreviation(e){return this.abbreviations[e]?this.abbreviations[e]:this.abbreviations[TextWork.defaultLang]?this.abbreviations[TextWork.defaultLang]:Object.values(this.abbreviations).length>0?Object.values(this.abbreviations)[0]:null}}const $a=TextWork;class WordItem{constructor(e={targetWord:null,languageCode:null,important:!1,currentSession:!0,context:[],homonym:{},createdDT:null,updatedDT:null,frequency:null}){if(this.version=1,this.targetWord=e.targetWord,this.languageCode=e.languageCode,!this.targetWord||!this.languageCode)throw new Error("Unable to construct a worditem without at least a targetWord and a languageCode");this.important=void 0!==e.important&&e.important,this.currentSession=void 0===e.currentSession||e.currentSession,this.context=e.context||[],this.homonym=e.homonym||{},this.createdDT=e.createdDT,this.updatedDT=e.updatedDT,this.frequency=e.frequency}static readObject(e){let t={},r=[];return e.homonym&&(t=WordItem.readHomonym(e)),e.context&&(r=WordItem.readContext(e)),new WordItem({targetWord:e.targetWord,languageCode:e.languageCode,important:e.important,currentSession:e.currentSession,context:r,homonym:t})}static readHomonym(e){return Ga.readObject(e.homonym)}get hasTextQuoteSelectors(){return this.context.length>0}static readContext(e){let t=[];for(const r of e){const e=TextQuoteSelector.readObject(r);t.push(e)}return t}addContext(e){for(const t of e)0===this.context.filter((e=>e.isEqual(t))).length&&this.context.push(t)}get lemmasList(){return this.homonym&&this.homonym.lexemes?this.homonym.lexemes.map((e=>e.lemma.word)).filter(((e,t,r)=>r.indexOf(e)===t)).join(", "):""}merge(e){const t=["homonym","important","currentSession"];for(const r of t)this._emptyProp(r)&&!e._emptyProp(r)&&(this[r]=e[r])}_emptyProp(e){return!this[e]||"object"==typeof this[e]&&0===Object.keys(this[e]).length}get formattedContext(){let e={};for(const t of this.context)e[t.source]||(e[t.source]=[]),e[t.source].push(t);return e}}class WordList{constructor(e,t=[]){if(!e)throw new Error("Unable to construct a wordlist without a languagecode");this.languageCode=e,this.items={},t.forEach((e=>{this.addWordItem(e)}))}get size(){return Object.keys(this.items).length}get values(){return Object.values(this.items)}get isEmpty(){return 0===Object.values(this.items).length}addWordItem(e){if(e.languageCode!==this.languageCode)throw new Error(`Language Code mismatch ${e.languageCode} !=== ${this.languageCode}`);const t=this.getWordItem(e.targetWord,!1);t&&e.merge(t);const r=this._makeItemKey(this.languageCode,e.targetWord);this.items[r]=e}deleteWordItem(e){const t=this._makeItemKey(this.languageCode,e),r=this.items[t];return r&&delete this.items[t],r}removeAllWordItems(){this.items={}}getWordItem(e,t=!0,r=null){const a=this._makeItemKey(this.languageCode,e);if(t&&!this.items[a]){const t=new WordItem({targetWord:e,languageCode:this.languageCode});r&&r.pub({dataObj:t,params:{segment:"common"}}),this.items[a]=t}return this.items[a]}_makeItemKey(e,t){return`${e}:${t.toLowerCase()}`}}class TreebankDataItem{constructor(e=null){this.version=0,this.app=null,this.sourceUrl=null,this.wordIds=[],this.sentenceId=null,this.doc=null,this.suppressTree=!1;const t=e?e.closest("[data-alpheios_tb_app]"):document.querySelector("[data-alpheios_tb_app]");if(t){if(this.app=t.dataset.alpheios_tb_app,"perseids-treebank-template"!==this.app)throw new Error("Unsupported treebank application. This version of Alpheios only supports the perseids-treebank-template viewer app.");if(t.dataset.alpheios_tb_app_version&&(this.version=Number.parseInt(t.dataset.alpheios_tb_app_version,10),!Number.isInteger(this.version)))throw new Error(`Treebank version is incorrect in: ${t.outerHTML}`);if(!t.dataset.alpheios_tb_app_url)throw new Error(`Missing treebank source URL in: ${t.outerHTML}`);this.sourceUrl=t.dataset.alpheios_tb_app_url,t.dataset.alpheios_tb_morph_only&&(this.suppressTree=Boolean("false"!==t.dataset.alpheios_tb_morph_only));const r=e?e.closest("[data-alpheios_tb_ref]"):document.querySelector("[data-alpheios_tb_ref]");let a,s=null;if(e?(s=e.closest("[data-alpheios_tb_word]"),a=s?s.closest("[data-alpheios_tb_sent]"):e.closest("[data-alpheios_tb_sent]")):a=document.querySelector("[data-alpheios_tb_sent]"),!r&&!s&&!a)throw new Error("An element does not have data-alpheios_tb_ref, data-alpheios_tb_word or data-alpheios_tb_sent attributes");if(s||a){if(!a)throw new Error("Sentence ID is undefined: there is no parent element with data-alpheios_tb_sent attribute");const e=s?s.closest("[data-alpheios_tb_doc]"):a.closest("[data-alpheios_tb_doc]");if(!e)throw new Error("Document ID is undefined: there is no parent element with data-alpheios_tb_doc attribute");s&&(this.wordIds=s.dataset.alpheios_tb_word.split(" ")),this.sentenceId=a.dataset.alpheios_tb_sent,this.doc=e.dataset.alpheios_tb_doc}else{const a=r.dataset.alpheios_tb_ref;let s;try{s=a.split(" ").map((e=>TreebankDataItem.parseReference(e)))}catch(e){throw new Error(`${e.message} in: ${t.outerHTML}`)}s=s.filter((e=>e.doc===s[0].doc&&e.sent===s[0].sent)),this.doc=s[0].doc,this.sentenceId=s[0].sent,this.wordIds=s.map((e=>e.word))}}if(!this.doc)throw new Error("Document data is missing");if(!this.sentenceId)throw new Error("Sentence data is missing")}static getTreebankData(e=null){try{return new TreebankDataItem(e)}catch(e){return null}}static parseReference(e){const[t,r]=e.split(/#/);if(!t||!r)throw new Error("Invalid treebank reference");const[a,s]=r.split(/-/);if(!a)throw new Error("Invalid treebank sent ID");if(!s)throw new Error("Invalid treebank word ID");return{doc:t,sent:a,word:s}}setWordData(e){this.wordIds=e}removeWordData(){this.wordIds=[]}get fullUrl(){return this.sourceUrl.replace("DOC",this.doc).replace("SENTENCE",this.sentenceId)}get docUrl(){return this.sourceUrl.replace("DOC",this.doc)}get provider(){return new URL(this.fullUrl).origin}get hasWordData(){return this.wordIds.length>0}get hasSentenceData(){return Boolean(this.sentenceId)}}class OptionItem{constructor(e,t,r){if(!e)throw new Error("Item cannot be empty");if(!t)throw new Error("Key cannot be empty");if(!r)throw new Error("Storage adapter object should be provided");for(const t of Object.keys(e))this[t]=e[t];this.currentValue=this.defaultValue,this.name=t,this.storageAdapter=r}textValues(){return this.values.map((e=>e.text))}currentItem(e){let t=[];for(const r of this.values)if(this.multiValue){if(this.currentValue.includes(r.value)){const a=e?r[e]:r;t.push(a)}}else r.value===this.currentValue&&(t=e?r[e]:r);return t}currentTextValue(){return this.currentItem("text")}addValue(e,t){return this.values.push({value:e,text:t}),this}setValue(e){return this.currentValue=e,this.save(),this}setTextValue(e){this.currentValue=this.multiValue?[]:"";for(const t of this.values)if(this.multiValue)for(const r of e)t.text===r&&this.currentValue.push(t.value);else t.text===e&&(this.currentValue=t.value);return this.save(),this}removeItem(){this.currentValue=null,this.storageAdapter.remove(this.name).then((()=>{}),(e=>{Logger.getInstance().error(`Unexpected error resetting Alpheios option ${this.name}: ${e}`)}))}save(){let e={};e[this.name]=JSON.stringify(this.currentValue),this.storageAdapter.set(e).then((()=>{}),(e=>{Logger.getInstance().error(`Unexpected error storing Alpheios option ${this.name}: ${e}`)}))}uploadValuesFromArray(e){this.values=[...e],this.defaultValue=this.values[0].value}}class Options{constructor(e,t){if(!(e&&e.domain&&e.items&&e.version))throw new Error('Defaults have no obligatory "domain", "version" and "items" properties');if(!t)throw new Error("No storage adapter implementation provided");this.defaults=e,this.domain=e.domain,this.version=e.version.toString(),this.storageAdapter=t,this.items=Options.initItems(this.defaults.items,this.storageAdapter,this.domain,this.version)}static initItems(e,t,r,a){let s={};for(const[n,i]of Object.entries(e))if(i.group){s[n]=[];for(const[e,o]of Object.entries(i.group)){const i=Options.constructKey(r,a,n,e);s[n].push(new OptionItem(o,i,t))}}else{const e=Options.constructKey(r,a,n);s[n]=new OptionItem(i,e,t)}return s}async reset(){await this.storageAdapter.clearAll(),this.items=Options.initItems(this.defaults.items,this.storageAdapter,this.domain,this.version)}get names(){return Object.keys(this.items)}async load(){try{const e=await this.storageAdapter.get();for(const t in e){const r=Options.parseKey(t);if(this.items.hasOwnProperty(r.name)&&this.version===r.version)if(r.group)this.items[r.name].forEach((a=>{if(a.name===t)try{a.currentValue=JSON.parse(e[t])}catch(t){Logger.getInstance().warn(`Unable to parse Alpheios option value for  ${r.name} from ${e[r.name]}`,t)}}));else try{this.items[r.name].currentValue=JSON.parse(e[t])}catch(t){Logger.getInstance().warn(`Unable to parse Alpheios option value for  ${r.name} from ${e[r.name]}`,t)}}return this}catch(e){const t=`Unexpected error retrieving options for Alpheios from local storage: ${e}. Default values will be used instead`;Logger.getInstance().error(t)}}static constructKey(e,t,r,a=null){let s=`${e}__${t}__${r}`;return a&&(s=`${s}__${a}`),s}static parseKey(e){const[t,r,a,s]=e.split("__",4);let n;try{n={domain:t,version:r,name:a,group:s}}catch(t){Logger.getInstance().warn(`Failed to parse stored Alpheios options key ${e}`)}return n}get formatLabelValueList(){let e={};return Object.keys(this.items).forEach((t=>{void 0!==this.items[t].currentValue&&(e[t]=this.items[t].currentValue)})),e}checkAndUploadValuesFromArray(e){Object.values(this.items).forEach((t=>{t.valuesArray&&!t.values&&e[t.valuesArray]&&t.uploadValuesFromArray(e[t.valuesArray])}))}clone(e,t){let r=Object.assign({},this.defaults);r.domain=`${r.domain}-${e}`;const a=new Options(r,new t(r.domain));return Object.keys(a.items).forEach((e=>{let t=a.items[e];this.items[e].values&&t.uploadValuesFromArray(this.items[e].values)})),a}}class DefaultsLoader{static fromJSON(e){try{return JSON.parse(e)}catch(e){return Logger.getInstance().error("Unable to parse Alpheios JSON options string:",e),{}}}}class StorageAdapter{constructor(e="alpheios-storage-domain"){this.domain=e}set(e){return new Promise(((e,t)=>t(new Error("Set method should be implemented in a subclass"))))}get(e){return new Promise(((e,t)=>t(new Error("Get method should be implemented in a subclass"))))}remove(e){return new Promise(((e,t)=>t(new Error("Remove method should be implemented in a subclass"))))}clearAll(){return new Promise(((e,t)=>t(new Error("clearAll method should be implemented in a subclass"))))}}class ExtensionSyncStorage extends StorageAdapter{set(e){return browser.storage.sync.set(e)}get(e){return browser.storage.sync.get(e)}clearAll(){return browser.storage.sync.clear()}}class LocalStorageArea extends StorageAdapter{set(e){return new Promise(((t,r)=>{try{let t=window.localStorage.getItem(`${this.domain}-keys`);t=t?JSON.parse(t):[];for(const[r,a]of Object.entries(e))window.localStorage.setItem(r,a),t.includes(r)||t.push(r);window.localStorage.setItem(`${this.domain}-keys`,JSON.stringify(t))}catch(e){r(e)}t()}))}remove(e){return new Promise(((t,r)=>{try{if(e){let r=window.localStorage.getItem(`${this.domain}-keys`);if(r){r=JSON.parse(r);const a=r.indexOf(e);-1!==a&&r.splice(a,1),window.localStorage.setItem(`${this.domain}-keys`,JSON.stringify(r)),window.localStorage.removeItem(e),t(!0)}else t(null)}}catch(e){r(e)}}))}get(e){return new Promise(((t,r)=>{try{e=e?Array.isArray(e)&&0===e.length?[]:"string"==typeof e?[e]:"object"==typeof e?Object.keys(e):[]:[];let r={};0===e.length&&((e=window.localStorage.getItem(`${this.domain}-keys`))?e=JSON.parse(e):t(r));for(const t of e)r[t]=window.localStorage.getItem(t);t(r)}catch(e){r(e)}}))}clearAll(){return new Promise(((e,t)=>{try{let t=null,r=window.localStorage.getItem(`${this.domain}-keys`);if(r){r=JSON.parse(r);for(const e of r)window.localStorage.removeItem(e);window.localStorage.setItem(`${this.domain}-keys`,JSON.stringify([])),e(!0)}else e(t)}catch(e){t(e)}}))}}var za=__nested_webpack_require_22140__(486),qa=__nested_webpack_require_22140__.n(za);class RemoteAuthStorageArea extends StorageAdapter{constructor(e="alpheios-storage-domain",t=null){if(super(e),!(t&&t.endpoints&&t.endpoints.settings.match(/^https:\/\//)&&t.accessToken))throw new Error("Authentication details missing or invalid");this.baseURL=t.endpoints.settings,this.requestContext={headers:{common:{Authorization:"bearer "+t.accessToken,"Content-Type":"application/json"}}}}async set(e){for(const[t,r]of Object.entries(e)){const e=`${this.baseURL}/${t}`,a=await qa().post(e,r,this.requestContext);if(201!==a.status)throw new Error(`Unexpected result status from settings api: ${a.status}`)}}async get(){const e=`${this.baseURL}?domain=${this.domain}`,t=await qa().get(e,this.requestContext);if(200===t.status)return t.data;throw new Error(`Unexpected result status from settings api: ${t.status}`)}async clearAll(){const e=`${this.baseURL}?domain=${this.domain}`,t=await qa().delete(e,this.requestContext);if(200!==t.status)throw new Error(`Unexpected result status from settings api: ${t.status}`)}}class TempStorageArea extends StorageAdapter{set(e){return new Promise((e=>{e("TempStorageArea does not store any values permanently")}))}get(e){return new Promise((e=>{e("TempStorageArea does not have any stored values")}))}}class Resource{constructor({title:e,id:t,baseUrl:r,description:a}={}){this.title=e,this.id=t,this.baseUrl=r,this.description=a}uploadRefs({refs:e,passage:t}={}){this.passage=t,this.refs=e}get linkData(){return{baseUrl:this.baseUrl,title:this.title,id:this.id,description:this.description,type:"resource",resource:this}}get refsLinks(){return this.refs.map((e=>({baseUrl:this.baseUrl,id:this.id,ref:e,type:"document"})))}}class Collection{constructor({totalItems:e,title:t,id:r,baseUrl:a,description:s,pagination:n}={}){this.totalItems=e,this.title=t,this.id=r,this.baseUrl=a,this.description=s,this.members=[],this.resources=[],n&&(this.pagination=this.definePagination(n))}addMember(e){"Collection"===e.type&&this.members.push(new Collection(e)),"Resource"===e.type&&this.resources.push(new Resource(e))}get formattedTitle(){const e=this.totalItems?` (${this.totalItems})`:"";return`${this.title}${e}`}get linkData(){return{baseUrl:this.baseUrl,totalItems:this.totalItems,formattedTitle:this.formattedTitle,title:this.title,id:this.id,type:"collection"}}get membersLinks(){return this.members.map((e=>e.linkData))}get resourcesLinks(){return this.resources.map((e=>e.linkData))}get links(){return this.members.length>0?this.membersLinks:this.resources.length>0?this.resourcesLinks:[]}extractPageNum(e){if(e){const t=e.match(/page=(\d+)$/);return t?parseInt(t[1]):null}return null}definePagination(e){const t={first:this.extractPageNum(e.first),next:this.extractPageNum(e.next),last:this.extractPageNum(e.last),previous:this.extractPageNum(e.previous)};return t.current=t.next?t.next-1:t.previous?t.previous+1:1,t}}class Tab{constructor(e,t,r){this.tabId=e,this.windowId=t,this.status="attached"}get uniqueId(){return this.constructor.createUniqueId(this.tabId,this.windowId)}get uniqueIdNew(){return this.constructor.createUniqueIdNew(this.tabId,this.windowId)}get isDeattached(){return"deattached"===this.status}deattach(){this.status="deattached"}attach(e){this.windowId=e,this.status="attached"}clone(){return new Tab(this.tabId,this.windowId)}compareWithTab(e){return this.tabId===e.tabId&&this.windowId===e.windowId}static createUniqueId(e,t){return Symbol.for(`Alpheios_tabId:${e.toString()},windowId:${t.toString()}`)}static createUniqueIdNew(e,t){return`Alpheios_tabId:${e.toString()},windowId:${t.toString()}`}}class UIStateAPI{constructor(){this.selectionLang=void 0,this.watchers=new Map}static get statuses(){return{script:{PENDING:Symbol.for("Alpheios_Status_Pending"),ACTIVE:Symbol.for("Alpheios_Status_Active"),DEACTIVATED:Symbol.for("Alpheios_Status_Deactivated"),DISABLED:Symbol.for("Alpheios_Status_Disabled")},panel:{OPEN:Symbol.for("Alpheios_Status_PanelOpen"),CLOSED:Symbol.for("Alpheios_Status_PanelClosed")}}}setItem(e,t){return this[e]=t,this.watchers&&this.watchers.has(e)&&this.watchers.get(e)(e,this),this}setWatcher(e,t){return this.watchers.set(e,t),this}isPanelOpen(){return!1}isPanelClosed(){return!1}setPanelOpen(){return this}setPanelClosed(){return this}uiIsActive(){return!1}activateUI(){return this}changeTab(e){return this}}class TabScript extends UIStateAPI{constructor(e){super(),this.tabID=e?e.uniqueId:void 0,this.tabObj=e,this.status=void 0,this.panelStatus=void 0,this.tab=void 0,this.embedLibStatus=void 0,this.uiActive=!1,this.watchers=new Map}updateTabObject(e,t){return this.tabObj=new Tab(e,t),this.tabID=this.tabObj.uniqueId,this}deattach(){this.tabObj.deattach()}attach(e){this.tabObj.attach(e)}get isDeattached(){return this.tabObj.isDeattached}static get propTypes(){return{NUMERIC:Symbol("Numeric"),STRING:Symbol("String"),SYMBOL:Symbol("Symbol")}}static get props(){return{status:{name:"status",valueType:TabScript.propTypes.SYMBOL,values:{PENDING:Symbol.for("Alpheios_Status_Pending"),ACTIVE:Symbol.for("Alpheios_Status_Active"),DEACTIVATED:Symbol.for("Alpheios_Status_Deactivated"),DISABLED:Symbol.for("Alpheios_Status_Disabled")},defaultValueIndex:0},embedLibStatus:{name:"embedLibStatus",valueType:TabScript.propTypes.SYMBOL,values:this.statuses.embedLib,defaultValueIndex:1},panelStatus:{name:"panelStatus",valueType:TabScript.propTypes.SYMBOL,values:{OPEN:Symbol.for("Alpheios_Status_PanelOpen"),CLOSED:Symbol.for("Alpheios_Status_PanelClosed"),DEFAULT:Symbol.for("Alpheios_Status_PanelDefault")},defaultValueIndex:1},tab:{name:"tab",valueType:TabScript.propTypes.STRING,values:{INFO:"info",DEFAULT:"default"},defaultValueIndex:0},uiActive:{name:"uiActive",valueType:Boolean}}}static get symbolProps(){return[TabScript.props.status.name,TabScript.props.embedLibStatus.name,TabScript.props.panelStatus.name]}static get stringProps(){return[TabScript.props.tab.name]}static get booleanProps(){return[]}static get dataProps(){return TabScript.symbolProps.concat(TabScript.stringProps).concat(TabScript.booleanProps)}static create(e){let t=new TabScript;for(const r of Object.keys(e))t[r]=e[r];return t}static get defaults(){return{status:TabScript.statuses.script.ACTIVE,panelStatus:TabScript.statuses.panel.OPEN}}static get statuses(){return{script:{PENDING:Symbol.for("Alpheios_Status_Pending"),ACTIVE:Symbol.for("Alpheios_Status_Active"),DEACTIVATED:Symbol.for("Alpheios_Status_Deactivated"),DISABLED:Symbol.for("Alpheios_Status_Disabled")},embedLib:{ACTIVE:Symbol.for("Embedded_Lib_Status_Active"),INACTIVE:Symbol.for("Embedded_Lib_Status_Inactive")},panel:{OPEN:Symbol.for("Alpheios_Status_PanelOpen"),CLOSED:Symbol.for("Alpheios_Status_PanelClosed"),DEFAULT:Symbol.for("Alpheios_Status_PanelDefault")}}}setWatcher(e,t){return this.watchers.set(e,t),this}setItem(e,t){return this[e]=t,this.watchers&&this.watchers.has(e)&&this.watchers.get(e)(e,this),this}isEmbedLibActive(){return this.embedLibStatus===TabScript.statuses.embedLib.ACTIVE}setEmbedLibActiveStatus(){return this.setItem("embedLibStatus",TabScript.statuses.embedLib.ACTIVE),this}setEmbedLibInactiveStatus(){return this.setItem("embedLibStatus",TabScript.statuses.embedLib.INACTIVE),this}setEmbedLibStatus(e){e?this.setItem("embedLibStatus",TabScript.statuses.embedLib.ACTIVE):this.setItem("embedLibStatus",TabScript.statuses.embedLib.INACTIVE)}isPanelOpen(){return this.panelStatus===TabScript.statuses.panel.OPEN}isPanelClosed(){return this.panelStatus===TabScript.statuses.panel.CLOSED}setPanelOpen(){return this.setItem("panelStatus",TabScript.statuses.panel.OPEN),this}setPanelClosed(){return this.setItem("panelStatus",TabScript.statuses.panel.CLOSED),this}setPanelDefault(){return this.setItem("panelStatus",TabScript.statuses.panel.DEFAULT),this}isPanelStateDefault(){return this.panelStatus===TabScript.statuses.panel.DEFAULT}isPanelStateValid(){return this.panelStatus===TabScript.statuses.panel.OPEN||this.panelStatus===TabScript.statuses.panel.CLOSED}setTabDefault(){return this.setItem("tab",TabScript.props.tab.values.DEFAULT),this}isTabStateDefault(){return this.tab===TabScript.props.tab.values.DEFAULT}hasSameID(e){return Symbol.keyFor(this.tabID)===Symbol.keyFor(e)}isActive(){return this.status===TabScript.statuses.script.ACTIVE}isDeactivated(){return this.status===TabScript.statuses.script.DEACTIVATED}isDisabled(){return this.status===TabScript.statuses.script.DISABLED}isPending(){return this.status===TabScript.statuses.script.PENDING}uiIsActive(){return this[TabScript.props.uiActive.name]}activate(){return this.status=TabScript.statuses.script.ACTIVE,this}deactivate(){return this.status=TabScript.statuses.script.DEACTIVATED,this}disable(){return this.status=TabScript.statuses.script.DISABLED,this}activateUI(){return this.setItem(TabScript.props.uiActive.name,!0),this}changeTab(e){return this.setItem(TabScript.props.tab.name,e),this}update(e){for(const t of Object.keys(e))e[t]&&(this[t]=e[t]);return this}diff(e){let t={_changedKeys:[],_changedEntries:[]};this.tabID!==e.tabID&&(t.tabID=e.tabID,t._changedKeys.push("tabID"),t._changedEntries.push(["tabID",e.tabID]));for(const r of Object.keys(e))TabScript.dataProps.includes(r)&&this.hasOwnProperty(r)&&this[r]&&e[r]&&this[r]!==e[r]&&(t[r]=e[r],t._changedKeys.push(r),t._changedEntries.push([r,e[r]]));return t.keys=function(){return t._changedKeys},t.entries=function(){return t._changedEntries},t.has=function(e){return t._changedKeys.includes(e)},t.isEmpty=function(){return!t._changedKeys.length},t}static serializable(e){let t={};t.tabID="symbol"==typeof e.tabID?Symbol.keyFor(e.tabID):e.tabID,t.tabObj=e.tabObj?e.tabObj.clone():void 0;for(const r of Object.keys(e))if(TabScript.dataProps.includes(r)){const a=e[r];t[r]="symbol"==typeof a?Symbol.keyFor(a):a}return t}static readObject(e){const t=e.tabObj&&e.tabObj.tabId&&e.tabObj.windowId?new Tab(e.tabObj.tabId,e.tabObj.windowId,e.tabObj.status):void 0;let r=new TabScript(t);for(const t of TabScript.symbolProps)e[t]&&(r[t]=Symbol.for(e[t]));for(const t of TabScript.stringProps)e[t]&&(r[t]=e[t]);for(const t of TabScript.booleanProps)e.hasOwnProperty(t)&&(r[t]=e[t]);return r}}})(),r})()))}},t={};function __webpack_require__(r){var a=t[r];if(void 0!==a)return a.exports;var s=t[r]={exports:{}};return e[r](s,s.exports,__webpack_require__),s.exports}(()=>{"use strict";const e=JSON.parse('{"dJ":{"active":{"16":"icons/alpheios_16.png","32":"icons/alpheios_32.png"},"nonactive":{"16":"icons/alpheios_black_16.png","32":"icons/alpheios_black_32.png"}},"v1":["content.js","support/compatibility-fixes/compatibility-fixes.js","support/webextension-polyfill/browser-polyfill.js"],"iv":["style/style-components.css"]}');var t=__webpack_require__(852);let r;const a=t.Logger.getInstance();class BrowserActions{static defineBrowserData(){r||(r=e.dJ)}static setIconState(e,t){let a={path:t?r.active:r.nonactive,tabId:e};browser.action.setIcon(a)}static setBadgeState(e,t){t?(browser.action.setBadgeText({tabId:e,text:"On"}),browser.action.setBadgeBackgroundColor({color:[252,20,20,255]}),browser.action.setBadgeTextColor&&browser.action.setBadgeTextColor({color:"#fff"})):browser.action.setBadgeText({tabId:e,text:""})}static setTitle(e,t){browser.action.setTitle({title:e,tabId:t})}static async getCurrentTab(){let[e]=await browser.tabs.query({active:!0,currentWindow:!0});return e}static async loadScripts(e,t){try{return await browser.scripting.executeScript({files:e,target:{tabId:t}})}catch(r){a.error(`Cannot load content script for a tab with an ID of tabId = ${t} ${JSON.stringify(e)}`)}}static async loadCSSFiles(e,t){try{return await browser.scripting.insertCSS({files:e,target:{tabId:t}})}catch(r){a.error(`Cannot load content css for a tab with an ID of tabId = ${t} ${JSON.stringify(e)}`)}}static createContextMenuItem(e){browser.contextMenus.create(e)}static removeContextMenuItem(e){browser.contextMenus.remove(e)}static addMessageListener(e){browser.runtime.onMessage.addListener(e)}static async sendMessageToBack({state:e,tab:t}){try{await browser.runtime.sendMessage({state:e,tab:t})}catch(e){a.error(`There is a problem with sending message to back - ${e}`)}}static async executeScript({tabId:e,func:t,hideError:r}){try{await browser.scripting.executeScript({target:{tabId:e},func:t})}catch(e){r||a.error(`There is a problem with executing script - ${e}`)}}}class TabsSet{constructor(){this.items={}}existItemId({tabId:e,windowId:r}){const a=t.Tab.createUniqueIdNew(e,r);return this.items[a]}getItem({tabId:e,windowId:r}){const a=t.Tab.createUniqueIdNew(e,r);return this.items[a]?this.items[a]:void 0}updateTabWindowId({tabId:e,oldWindowId:t,newWindowId:r}){const a=this.getItem({tabId:e,windowId:t}),s=this.getItem({tabId:e,windowId:r});return a&&(this.items[s.uniqueIdNew]=this.items[a.uniqueIdNew],delete this.items[a.uniqueIdNew]),s}removeItem({tabId:e,windowId:r}){const a=t.Tab.createUniqueIdNew(e,r);return!!this.items[a]&&(delete this.items[a],!0)}addItem({tabId:e,windowId:r}){const a=t.Tab.createUniqueIdNew(e,r);return this.items[a]=TabsSet.createTabItem({tabId:e,windowId:r}),this.items[a]}static createTabItem({tabId:e,windowId:r}){const a=new t.Tab(e,r);let s=new t.TabScript(a);return s.tab=t.TabScript.props.tab.values.INFO,s}}var extendStatics=function(e,t){return extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},extendStatics(e,t)};function __extends(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}extendStatics(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}var __assign=function(){return __assign=Object.assign||function __assign(e){for(var t,r=1,a=arguments.length;r<a;r++)for(var s in t=arguments[r])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e},__assign.apply(this,arguments)};Object.create;function __spreadArray(e,t,r){if(r||2===arguments.length)for(var a,s=0,n=t.length;s<n;s++)!a&&s in t||(a||(a=Array.prototype.slice.call(t,0,s)),a[s]=t[s]);return e.concat(a||Array.prototype.slice.call(t))}var s,n,i;Object.create;function isLiteralElement(e){return e.type===n.literal}function isArgumentElement(e){return e.type===n.argument}function isNumberElement(e){return e.type===n.number}function isDateElement(e){return e.type===n.date}function isTimeElement(e){return e.type===n.time}function isSelectElement(e){return e.type===n.select}function isPluralElement(e){return e.type===n.plural}function isPoundElement(e){return e.type===n.pound}function isTagElement(e){return e.type===n.tag}function isNumberSkeleton(e){return!(!e||"object"!=typeof e||e.type!==i.number)}function isDateTimeSkeleton(e){return!(!e||"object"!=typeof e||e.type!==i.dateTime)}!function(e){e[e.EXPECT_ARGUMENT_CLOSING_BRACE=1]="EXPECT_ARGUMENT_CLOSING_BRACE",e[e.EMPTY_ARGUMENT=2]="EMPTY_ARGUMENT",e[e.MALFORMED_ARGUMENT=3]="MALFORMED_ARGUMENT",e[e.EXPECT_ARGUMENT_TYPE=4]="EXPECT_ARGUMENT_TYPE",e[e.INVALID_ARGUMENT_TYPE=5]="INVALID_ARGUMENT_TYPE",e[e.EXPECT_ARGUMENT_STYLE=6]="EXPECT_ARGUMENT_STYLE",e[e.INVALID_NUMBER_SKELETON=7]="INVALID_NUMBER_SKELETON",e[e.INVALID_DATE_TIME_SKELETON=8]="INVALID_DATE_TIME_SKELETON",e[e.EXPECT_NUMBER_SKELETON=9]="EXPECT_NUMBER_SKELETON",e[e.EXPECT_DATE_TIME_SKELETON=10]="EXPECT_DATE_TIME_SKELETON",e[e.UNCLOSED_QUOTE_IN_ARGUMENT_STYLE=11]="UNCLOSED_QUOTE_IN_ARGUMENT_STYLE",e[e.EXPECT_SELECT_ARGUMENT_OPTIONS=12]="EXPECT_SELECT_ARGUMENT_OPTIONS",e[e.EXPECT_PLURAL_ARGUMENT_OFFSET_VALUE=13]="EXPECT_PLURAL_ARGUMENT_OFFSET_VALUE",e[e.INVALID_PLURAL_ARGUMENT_OFFSET_VALUE=14]="INVALID_PLURAL_ARGUMENT_OFFSET_VALUE",e[e.EXPECT_SELECT_ARGUMENT_SELECTOR=15]="EXPECT_SELECT_ARGUMENT_SELECTOR",e[e.EXPECT_PLURAL_ARGUMENT_SELECTOR=16]="EXPECT_PLURAL_ARGUMENT_SELECTOR",e[e.EXPECT_SELECT_ARGUMENT_SELECTOR_FRAGMENT=17]="EXPECT_SELECT_ARGUMENT_SELECTOR_FRAGMENT",e[e.EXPECT_PLURAL_ARGUMENT_SELECTOR_FRAGMENT=18]="EXPECT_PLURAL_ARGUMENT_SELECTOR_FRAGMENT",e[e.INVALID_PLURAL_ARGUMENT_SELECTOR=19]="INVALID_PLURAL_ARGUMENT_SELECTOR",e[e.DUPLICATE_PLURAL_ARGUMENT_SELECTOR=20]="DUPLICATE_PLURAL_ARGUMENT_SELECTOR",e[e.DUPLICATE_SELECT_ARGUMENT_SELECTOR=21]="DUPLICATE_SELECT_ARGUMENT_SELECTOR",e[e.MISSING_OTHER_CLAUSE=22]="MISSING_OTHER_CLAUSE",e[e.INVALID_TAG=23]="INVALID_TAG",e[e.INVALID_TAG_NAME=25]="INVALID_TAG_NAME",e[e.UNMATCHED_CLOSING_TAG=26]="UNMATCHED_CLOSING_TAG",e[e.UNCLOSED_TAG=27]="UNCLOSED_TAG"}(s||(s={})),function(e){e[e.literal=0]="literal",e[e.argument=1]="argument",e[e.number=2]="number",e[e.date=3]="date",e[e.time=4]="time",e[e.select=5]="select",e[e.plural=6]="plural",e[e.pound=7]="pound",e[e.tag=8]="tag"}(n||(n={})),function(e){e[e.number=0]="number",e[e.dateTime=1]="dateTime"}(i||(i={}));var o=/[ \xA0\u1680\u2000-\u200A\u202F\u205F\u3000]/,u=/(?:[Eec]{1,6}|G{1,5}|[Qq]{1,5}|(?:[yYur]+|U{1,5})|[ML]{1,5}|d{1,2}|D{1,3}|F{1}|[abB]{1,5}|[hkHK]{1,2}|w{1,2}|W{1}|m{1,2}|s{1,2}|[zZOvVxX]{1,4})(?=([^']*'[^']*')*[^']*$)/g;function parseDateTimeSkeleton(e){var t={};return e.replace(u,(function(e){var r=e.length;switch(e[0]){case"G":t.era=4===r?"long":5===r?"narrow":"short";break;case"y":t.year=2===r?"2-digit":"numeric";break;case"Y":case"u":case"U":case"r":throw new RangeError("`Y/u/U/r` (year) patterns are not supported, use `y` instead");case"q":case"Q":throw new RangeError("`q/Q` (quarter) patterns are not supported");case"M":case"L":t.month=["numeric","2-digit","short","long","narrow"][r-1];break;case"w":case"W":throw new RangeError("`w/W` (week) patterns are not supported");case"d":t.day=["numeric","2-digit"][r-1];break;case"D":case"F":case"g":throw new RangeError("`D/F/g` (day) patterns are not supported, use `d` instead");case"E":t.weekday=4===r?"short":5===r?"narrow":"short";break;case"e":if(r<4)throw new RangeError("`e..eee` (weekday) patterns are not supported");t.weekday=["short","long","narrow","short"][r-4];break;case"c":if(r<4)throw new RangeError("`c..ccc` (weekday) patterns are not supported");t.weekday=["short","long","narrow","short"][r-4];break;case"a":t.hour12=!0;break;case"b":case"B":throw new RangeError("`b/B` (period) patterns are not supported, use `a` instead");case"h":t.hourCycle="h12",t.hour=["numeric","2-digit"][r-1];break;case"H":t.hourCycle="h23",t.hour=["numeric","2-digit"][r-1];break;case"K":t.hourCycle="h11",t.hour=["numeric","2-digit"][r-1];break;case"k":t.hourCycle="h24",t.hour=["numeric","2-digit"][r-1];break;case"j":case"J":case"C":throw new RangeError("`j/J/C` (hour) patterns are not supported, use `h/H/K/k` instead");case"m":t.minute=["numeric","2-digit"][r-1];break;case"s":t.second=["numeric","2-digit"][r-1];break;case"S":case"A":throw new RangeError("`S/A` (second) patterns are not supported, use `s` instead");case"z":t.timeZoneName=r<4?"short":"long";break;case"Z":case"O":case"v":case"V":case"X":case"x":throw new RangeError("`Z/O/v/V/X/x` (timeZone) patterns are not supported, use `z` instead")}return""})),t}var c=/[\t-\r \x85\u200E\u200F\u2028\u2029]/i;var l=/^\.(?:(0+)(\*)?|(#+)|(0+)(#+))$/g,h=/^(@+)?(\+|#+)?[rs]?$/g,d=/(\*)(0+)|(#+)(0+)|(0+)/g,p=/^(0+)$/;function parseSignificantPrecision(e){var t={};return"r"===e[e.length-1]?t.roundingPriority="morePrecision":"s"===e[e.length-1]&&(t.roundingPriority="lessPrecision"),e.replace(h,(function(e,r,a){return"string"!=typeof a?(t.minimumSignificantDigits=r.length,t.maximumSignificantDigits=r.length):"+"===a?t.minimumSignificantDigits=r.length:"#"===r[0]?t.maximumSignificantDigits=r.length:(t.minimumSignificantDigits=r.length,t.maximumSignificantDigits=r.length+("string"==typeof a?a.length:0)),""})),t}function parseSign(e){switch(e){case"sign-auto":return{signDisplay:"auto"};case"sign-accounting":case"()":return{currencySign:"accounting"};case"sign-always":case"+!":return{signDisplay:"always"};case"sign-accounting-always":case"()!":return{signDisplay:"always",currencySign:"accounting"};case"sign-except-zero":case"+?":return{signDisplay:"exceptZero"};case"sign-accounting-except-zero":case"()?":return{signDisplay:"exceptZero",currencySign:"accounting"};case"sign-never":case"+_":return{signDisplay:"never"}}}function parseConciseScientificAndEngineeringStem(e){var t;if("E"===e[0]&&"E"===e[1]?(t={notation:"engineering"},e=e.slice(2)):"E"===e[0]&&(t={notation:"scientific"},e=e.slice(1)),t){var r=e.slice(0,2);if("+!"===r?(t.signDisplay="always",e=e.slice(2)):"+?"===r&&(t.signDisplay="exceptZero",e=e.slice(2)),!p.test(e))throw new Error("Malformed concise eng/scientific notation");t.minimumIntegerDigits=e.length}return t}function parseNotationOptions(e){var t=parseSign(e);return t||{}}function parseNumberSkeleton(e){for(var t={},r=0,a=e;r<a.length;r++){var s=a[r];switch(s.stem){case"percent":case"%":t.style="percent";continue;case"%x100":t.style="percent",t.scale=100;continue;case"currency":t.style="currency",t.currency=s.options[0];continue;case"group-off":case",_":t.useGrouping=!1;continue;case"precision-integer":case".":t.maximumFractionDigits=0;continue;case"measure-unit":case"unit":t.style="unit",t.unit=s.options[0].replace(/^(.*?)-/,"");continue;case"compact-short":case"K":t.notation="compact",t.compactDisplay="short";continue;case"compact-long":case"KK":t.notation="compact",t.compactDisplay="long";continue;case"scientific":t=__assign(__assign(__assign({},t),{notation:"scientific"}),s.options.reduce((function(e,t){return __assign(__assign({},e),parseNotationOptions(t))}),{}));continue;case"engineering":t=__assign(__assign(__assign({},t),{notation:"engineering"}),s.options.reduce((function(e,t){return __assign(__assign({},e),parseNotationOptions(t))}),{}));continue;case"notation-simple":t.notation="standard";continue;case"unit-width-narrow":t.currencyDisplay="narrowSymbol",t.unitDisplay="narrow";continue;case"unit-width-short":t.currencyDisplay="code",t.unitDisplay="short";continue;case"unit-width-full-name":t.currencyDisplay="name",t.unitDisplay="long";continue;case"unit-width-iso-code":t.currencyDisplay="symbol";continue;case"scale":t.scale=parseFloat(s.options[0]);continue;case"integer-width":if(s.options.length>1)throw new RangeError("integer-width stems only accept a single optional option");s.options[0].replace(d,(function(e,r,a,s,n,i){if(r)t.minimumIntegerDigits=a.length;else{if(s&&n)throw new Error("We currently do not support maximum integer digits");if(i)throw new Error("We currently do not support exact integer digits")}return""}));continue}if(p.test(s.stem))t.minimumIntegerDigits=s.stem.length;else if(l.test(s.stem)){if(s.options.length>1)throw new RangeError("Fraction-precision stems only accept a single optional option");s.stem.replace(l,(function(e,r,a,s,n,i){return"*"===a?t.minimumFractionDigits=r.length:s&&"#"===s[0]?t.maximumFractionDigits=s.length:n&&i?(t.minimumFractionDigits=n.length,t.maximumFractionDigits=n.length+i.length):(t.minimumFractionDigits=r.length,t.maximumFractionDigits=r.length),""}));var n=s.options[0];"w"===n?t=__assign(__assign({},t),{trailingZeroDisplay:"stripIfInteger"}):n&&(t=__assign(__assign({},t),parseSignificantPrecision(n)))}else if(h.test(s.stem))t=__assign(__assign({},t),parseSignificantPrecision(s.stem));else{var i=parseSign(s.stem);i&&(t=__assign(__assign({},t),i));var o=parseConciseScientificAndEngineeringStem(s.stem);o&&(t=__assign(__assign({},t),o))}}return t}var g,f={AX:["H"],BQ:["H"],CP:["H"],CZ:["H"],DK:["H"],FI:["H"],ID:["H"],IS:["H"],ML:["H"],NE:["H"],RU:["H"],SE:["H"],SJ:["H"],SK:["H"],AS:["h","H"],BT:["h","H"],DJ:["h","H"],ER:["h","H"],GH:["h","H"],IN:["h","H"],LS:["h","H"],PG:["h","H"],PW:["h","H"],SO:["h","H"],TO:["h","H"],VU:["h","H"],WS:["h","H"],"001":["H","h"],AL:["h","H","hB"],TD:["h","H","hB"],"ca-ES":["H","h","hB"],CF:["H","h","hB"],CM:["H","h","hB"],"fr-CA":["H","h","hB"],"gl-ES":["H","h","hB"],"it-CH":["H","h","hB"],"it-IT":["H","h","hB"],LU:["H","h","hB"],NP:["H","h","hB"],PF:["H","h","hB"],SC:["H","h","hB"],SM:["H","h","hB"],SN:["H","h","hB"],TF:["H","h","hB"],VA:["H","h","hB"],CY:["h","H","hb","hB"],GR:["h","H","hb","hB"],CO:["h","H","hB","hb"],DO:["h","H","hB","hb"],KP:["h","H","hB","hb"],KR:["h","H","hB","hb"],NA:["h","H","hB","hb"],PA:["h","H","hB","hb"],PR:["h","H","hB","hb"],VE:["h","H","hB","hb"],AC:["H","h","hb","hB"],AI:["H","h","hb","hB"],BW:["H","h","hb","hB"],BZ:["H","h","hb","hB"],CC:["H","h","hb","hB"],CK:["H","h","hb","hB"],CX:["H","h","hb","hB"],DG:["H","h","hb","hB"],FK:["H","h","hb","hB"],GB:["H","h","hb","hB"],GG:["H","h","hb","hB"],GI:["H","h","hb","hB"],IE:["H","h","hb","hB"],IM:["H","h","hb","hB"],IO:["H","h","hb","hB"],JE:["H","h","hb","hB"],LT:["H","h","hb","hB"],MK:["H","h","hb","hB"],MN:["H","h","hb","hB"],MS:["H","h","hb","hB"],NF:["H","h","hb","hB"],NG:["H","h","hb","hB"],NR:["H","h","hb","hB"],NU:["H","h","hb","hB"],PN:["H","h","hb","hB"],SH:["H","h","hb","hB"],SX:["H","h","hb","hB"],TA:["H","h","hb","hB"],ZA:["H","h","hb","hB"],"af-ZA":["H","h","hB","hb"],AR:["H","h","hB","hb"],CL:["H","h","hB","hb"],CR:["H","h","hB","hb"],CU:["H","h","hB","hb"],EA:["H","h","hB","hb"],"es-BO":["H","h","hB","hb"],"es-BR":["H","h","hB","hb"],"es-EC":["H","h","hB","hb"],"es-ES":["H","h","hB","hb"],"es-GQ":["H","h","hB","hb"],"es-PE":["H","h","hB","hb"],GT:["H","h","hB","hb"],HN:["H","h","hB","hb"],IC:["H","h","hB","hb"],KG:["H","h","hB","hb"],KM:["H","h","hB","hb"],LK:["H","h","hB","hb"],MA:["H","h","hB","hb"],MX:["H","h","hB","hb"],NI:["H","h","hB","hb"],PY:["H","h","hB","hb"],SV:["H","h","hB","hb"],UY:["H","h","hB","hb"],JP:["H","h","K"],AD:["H","hB"],AM:["H","hB"],AO:["H","hB"],AT:["H","hB"],AW:["H","hB"],BE:["H","hB"],BF:["H","hB"],BJ:["H","hB"],BL:["H","hB"],BR:["H","hB"],CG:["H","hB"],CI:["H","hB"],CV:["H","hB"],DE:["H","hB"],EE:["H","hB"],FR:["H","hB"],GA:["H","hB"],GF:["H","hB"],GN:["H","hB"],GP:["H","hB"],GW:["H","hB"],HR:["H","hB"],IL:["H","hB"],IT:["H","hB"],KZ:["H","hB"],MC:["H","hB"],MD:["H","hB"],MF:["H","hB"],MQ:["H","hB"],MZ:["H","hB"],NC:["H","hB"],NL:["H","hB"],PM:["H","hB"],PT:["H","hB"],RE:["H","hB"],RO:["H","hB"],SI:["H","hB"],SR:["H","hB"],ST:["H","hB"],TG:["H","hB"],TR:["H","hB"],WF:["H","hB"],YT:["H","hB"],BD:["h","hB","H"],PK:["h","hB","H"],AZ:["H","hB","h"],BA:["H","hB","h"],BG:["H","hB","h"],CH:["H","hB","h"],GE:["H","hB","h"],LI:["H","hB","h"],ME:["H","hB","h"],RS:["H","hB","h"],UA:["H","hB","h"],UZ:["H","hB","h"],XK:["H","hB","h"],AG:["h","hb","H","hB"],AU:["h","hb","H","hB"],BB:["h","hb","H","hB"],BM:["h","hb","H","hB"],BS:["h","hb","H","hB"],CA:["h","hb","H","hB"],DM:["h","hb","H","hB"],"en-001":["h","hb","H","hB"],FJ:["h","hb","H","hB"],FM:["h","hb","H","hB"],GD:["h","hb","H","hB"],GM:["h","hb","H","hB"],GU:["h","hb","H","hB"],GY:["h","hb","H","hB"],JM:["h","hb","H","hB"],KI:["h","hb","H","hB"],KN:["h","hb","H","hB"],KY:["h","hb","H","hB"],LC:["h","hb","H","hB"],LR:["h","hb","H","hB"],MH:["h","hb","H","hB"],MP:["h","hb","H","hB"],MW:["h","hb","H","hB"],NZ:["h","hb","H","hB"],SB:["h","hb","H","hB"],SG:["h","hb","H","hB"],SL:["h","hb","H","hB"],SS:["h","hb","H","hB"],SZ:["h","hb","H","hB"],TC:["h","hb","H","hB"],TT:["h","hb","H","hB"],UM:["h","hb","H","hB"],US:["h","hb","H","hB"],VC:["h","hb","H","hB"],VG:["h","hb","H","hB"],VI:["h","hb","H","hB"],ZM:["h","hb","H","hB"],BO:["H","hB","h","hb"],EC:["H","hB","h","hb"],ES:["H","hB","h","hb"],GQ:["H","hB","h","hb"],PE:["H","hB","h","hb"],AE:["h","hB","hb","H"],"ar-001":["h","hB","hb","H"],BH:["h","hB","hb","H"],DZ:["h","hB","hb","H"],EG:["h","hB","hb","H"],EH:["h","hB","hb","H"],HK:["h","hB","hb","H"],IQ:["h","hB","hb","H"],JO:["h","hB","hb","H"],KW:["h","hB","hb","H"],LB:["h","hB","hb","H"],LY:["h","hB","hb","H"],MO:["h","hB","hb","H"],MR:["h","hB","hb","H"],OM:["h","hB","hb","H"],PH:["h","hB","hb","H"],PS:["h","hB","hb","H"],QA:["h","hB","hb","H"],SA:["h","hB","hb","H"],SD:["h","hB","hb","H"],SY:["h","hB","hb","H"],TN:["h","hB","hb","H"],YE:["h","hB","hb","H"],AF:["H","hb","hB","h"],LA:["H","hb","hB","h"],CN:["H","hB","hb","h"],LV:["H","hB","hb","h"],TL:["H","hB","hb","h"],"zu-ZA":["H","hB","hb","h"],CD:["hB","H"],IR:["hB","H"],"hi-IN":["hB","h","H"],"kn-IN":["hB","h","H"],"ml-IN":["hB","h","H"],"te-IN":["hB","h","H"],KH:["hB","h","H","hb"],"ta-IN":["hB","h","hb","H"],BN:["hb","hB","h","H"],MY:["hb","hB","h","H"],ET:["hB","hb","h","H"],"gu-IN":["hB","hb","h","H"],"mr-IN":["hB","hb","h","H"],"pa-IN":["hB","hb","h","H"],TW:["hB","hb","h","H"],KE:["hB","hb","H","h"],MM:["hB","hb","H","h"],TZ:["hB","hb","H","h"],UG:["hB","hb","H","h"]};function getDefaultHourSymbolFromLocale(e){var t=e.hourCycle;if(void 0===t&&e.hourCycles&&e.hourCycles.length&&(t=e.hourCycles[0]),t)switch(t){case"h24":return"k";case"h23":return"H";case"h12":return"h";case"h11":return"K";default:throw new Error("Invalid hourCycle")}var r,a=e.language;return"root"!==a&&(r=e.maximize().region),(f[r||""]||f[a||""]||f["".concat(a,"-001")]||f["001"])[0]}var m=new RegExp("^".concat(o.source,"*")),b=new RegExp("".concat(o.source,"*$"));function createLocation(e,t){return{start:e,end:t}}var E=!!String.prototype.startsWith,y=!!String.fromCodePoint,I=!!Object.fromEntries,v=!!String.prototype.codePointAt,S=!!String.prototype.trimStart,w=!!String.prototype.trimEnd,_=!!Number.isSafeInteger?Number.isSafeInteger:function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e&&Math.abs(e)<=9007199254740991},A=!0;try{A="a"===(null===(g=RE("([^\\p{White_Space}\\p{Pattern_Syntax}]*)","yu").exec("a"))||void 0===g?void 0:g[0])}catch(e){A=!1}var T,L=E?function startsWith(e,t,r){return e.startsWith(t,r)}:function startsWith(e,t,r){return e.slice(r,r+t.length)===t},C=y?String.fromCodePoint:function fromCodePoint(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var r,a="",s=e.length,n=0;s>n;){if((r=e[n++])>1114111)throw RangeError(r+" is not a valid code point");a+=r<65536?String.fromCharCode(r):String.fromCharCode(55296+((r-=65536)>>10),r%1024+56320)}return a},O=I?Object.fromEntries:function fromEntries(e){for(var t={},r=0,a=e;r<a.length;r++){var s=a[r],n=s[0],i=s[1];t[n]=i}return t},D=v?function codePointAt(e,t){return e.codePointAt(t)}:function codePointAt(e,t){var r=e.length;if(!(t<0||t>=r)){var a,s=e.charCodeAt(t);return s<55296||s>56319||t+1===r||(a=e.charCodeAt(t+1))<56320||a>57343?s:a-56320+(s-55296<<10)+65536}},F=S?function trimStart(e){return e.trimStart()}:function trimStart(e){return e.replace(m,"")},N=w?function trimEnd(e){return e.trimEnd()}:function trimEnd(e){return e.replace(b,"")};function RE(e,t){return new RegExp(e,t)}if(A){var P=RE("([^\\p{White_Space}\\p{Pattern_Syntax}]*)","yu");T=function matchIdentifierAtIndex(e,t){var r;return P.lastIndex=t,null!==(r=P.exec(e)[1])&&void 0!==r?r:""}}else T=function matchIdentifierAtIndex(e,t){for(var r=[];;){var a=D(e,t);if(void 0===a||_isWhiteSpace(a)||_isPatternSyntax(a))break;r.push(a),t+=a>=65536?2:1}return C.apply(void 0,r)};var M=function(){function Parser(e,t){void 0===t&&(t={}),this.message=e,this.position={offset:0,line:1,column:1},this.ignoreTag=!!t.ignoreTag,this.locale=t.locale,this.requiresOtherClause=!!t.requiresOtherClause,this.shouldParseSkeletons=!!t.shouldParseSkeletons}return Parser.prototype.parse=function(){if(0!==this.offset())throw Error("parser can only be used once");return this.parseMessage(0,"",!1)},Parser.prototype.parseMessage=function(e,t,r){for(var a=[];!this.isEOF();){var i=this.char();if(123===i){if((o=this.parseArgument(e,r)).err)return o;a.push(o.val)}else{if(125===i&&e>0)break;if(35!==i||"plural"!==t&&"selectordinal"!==t){if(60===i&&!this.ignoreTag&&47===this.peek()){if(r)break;return this.error(s.UNMATCHED_CLOSING_TAG,createLocation(this.clonePosition(),this.clonePosition()))}if(60===i&&!this.ignoreTag&&_isAlpha(this.peek()||0)){if((o=this.parseTag(e,t)).err)return o;a.push(o.val)}else{var o;if((o=this.parseLiteral(e,t)).err)return o;a.push(o.val)}}else{var u=this.clonePosition();this.bump(),a.push({type:n.pound,location:createLocation(u,this.clonePosition())})}}}return{val:a,err:null}},Parser.prototype.parseTag=function(e,t){var r=this.clonePosition();this.bump();var a=this.parseTagName();if(this.bumpSpace(),this.bumpIf("/>"))return{val:{type:n.literal,value:"<".concat(a,"/>"),location:createLocation(r,this.clonePosition())},err:null};if(this.bumpIf(">")){var i=this.parseMessage(e+1,t,!0);if(i.err)return i;var o=i.val,u=this.clonePosition();if(this.bumpIf("</")){if(this.isEOF()||!_isAlpha(this.char()))return this.error(s.INVALID_TAG,createLocation(u,this.clonePosition()));var c=this.clonePosition();return a!==this.parseTagName()?this.error(s.UNMATCHED_CLOSING_TAG,createLocation(c,this.clonePosition())):(this.bumpSpace(),this.bumpIf(">")?{val:{type:n.tag,value:a,children:o,location:createLocation(r,this.clonePosition())},err:null}:this.error(s.INVALID_TAG,createLocation(u,this.clonePosition())))}return this.error(s.UNCLOSED_TAG,createLocation(r,this.clonePosition()))}return this.error(s.INVALID_TAG,createLocation(r,this.clonePosition()))},Parser.prototype.parseTagName=function(){var e,t=this.offset();for(this.bump();!this.isEOF()&&(45===(e=this.char())||46===e||e>=48&&e<=57||95===e||e>=97&&e<=122||e>=65&&e<=90||183==e||e>=192&&e<=214||e>=216&&e<=246||e>=248&&e<=893||e>=895&&e<=8191||e>=8204&&e<=8205||e>=8255&&e<=8256||e>=8304&&e<=8591||e>=11264&&e<=12271||e>=12289&&e<=55295||e>=63744&&e<=64975||e>=65008&&e<=65533||e>=65536&&e<=983039);)this.bump();return this.message.slice(t,this.offset())},Parser.prototype.parseLiteral=function(e,t){for(var r=this.clonePosition(),a="";;){var s=this.tryParseQuote(t);if(s)a+=s;else{var i=this.tryParseUnquoted(e,t);if(i)a+=i;else{var o=this.tryParseLeftAngleBracket();if(!o)break;a+=o}}}var u=createLocation(r,this.clonePosition());return{val:{type:n.literal,value:a,location:u},err:null}},Parser.prototype.tryParseLeftAngleBracket=function(){return this.isEOF()||60!==this.char()||!this.ignoreTag&&function _isAlphaOrSlash(e){return _isAlpha(e)||47===e}(this.peek()||0)?null:(this.bump(),"<")},Parser.prototype.tryParseQuote=function(e){if(this.isEOF()||39!==this.char())return null;switch(this.peek()){case 39:return this.bump(),this.bump(),"'";case 123:case 60:case 62:case 125:break;case 35:if("plural"===e||"selectordinal"===e)break;return null;default:return null}this.bump();var t=[this.char()];for(this.bump();!this.isEOF();){var r=this.char();if(39===r){if(39!==this.peek()){this.bump();break}t.push(39),this.bump()}else t.push(r);this.bump()}return C.apply(void 0,t)},Parser.prototype.tryParseUnquoted=function(e,t){if(this.isEOF())return null;var r=this.char();return 60===r||123===r||35===r&&("plural"===t||"selectordinal"===t)||125===r&&e>0?null:(this.bump(),C(r))},Parser.prototype.parseArgument=function(e,t){var r=this.clonePosition();if(this.bump(),this.bumpSpace(),this.isEOF())return this.error(s.EXPECT_ARGUMENT_CLOSING_BRACE,createLocation(r,this.clonePosition()));if(125===this.char())return this.bump(),this.error(s.EMPTY_ARGUMENT,createLocation(r,this.clonePosition()));var a=this.parseIdentifierIfPossible().value;if(!a)return this.error(s.MALFORMED_ARGUMENT,createLocation(r,this.clonePosition()));if(this.bumpSpace(),this.isEOF())return this.error(s.EXPECT_ARGUMENT_CLOSING_BRACE,createLocation(r,this.clonePosition()));switch(this.char()){case 125:return this.bump(),{val:{type:n.argument,value:a,location:createLocation(r,this.clonePosition())},err:null};case 44:return this.bump(),this.bumpSpace(),this.isEOF()?this.error(s.EXPECT_ARGUMENT_CLOSING_BRACE,createLocation(r,this.clonePosition())):this.parseArgumentOptions(e,t,a,r);default:return this.error(s.MALFORMED_ARGUMENT,createLocation(r,this.clonePosition()))}},Parser.prototype.parseIdentifierIfPossible=function(){var e=this.clonePosition(),t=this.offset(),r=T(this.message,t),a=t+r.length;return this.bumpTo(a),{value:r,location:createLocation(e,this.clonePosition())}},Parser.prototype.parseArgumentOptions=function(e,t,r,a){var o,u=this.clonePosition(),c=this.parseIdentifierIfPossible().value,l=this.clonePosition();switch(c){case"":return this.error(s.EXPECT_ARGUMENT_TYPE,createLocation(u,l));case"number":case"date":case"time":this.bumpSpace();var h=null;if(this.bumpIf(",")){this.bumpSpace();var d=this.clonePosition();if((I=this.parseSimpleArgStyleIfPossible()).err)return I;if(0===(m=N(I.val)).length)return this.error(s.EXPECT_ARGUMENT_STYLE,createLocation(this.clonePosition(),this.clonePosition()));h={style:m,styleLocation:createLocation(d,this.clonePosition())}}if((v=this.tryParseArgumentClose(a)).err)return v;var p=createLocation(a,this.clonePosition());if(h&&L(null==h?void 0:h.style,"::",0)){var g=F(h.style.slice(2));if("number"===c)return(I=this.parseNumberSkeletonFromString(g,h.styleLocation)).err?I:{val:{type:n.number,value:r,location:p,style:I.val},err:null};if(0===g.length)return this.error(s.EXPECT_DATE_TIME_SKELETON,p);var f=g;this.locale&&(f=function getBestPattern(e,t){for(var r="",a=0;a<e.length;a++){var s=e.charAt(a);if("j"===s){for(var n=0;a+1<e.length&&e.charAt(a+1)===s;)n++,a++;var i=1+(1&n),o=n<2?1:3+(n>>1),u=getDefaultHourSymbolFromLocale(t);for("H"!=u&&"k"!=u||(o=0);o-- >0;)r+="a";for(;i-- >0;)r=u+r}else r+="J"===s?"H":s}return r}(g,this.locale));var m={type:i.dateTime,pattern:f,location:h.styleLocation,parsedOptions:this.shouldParseSkeletons?parseDateTimeSkeleton(f):{}};return{val:{type:"date"===c?n.date:n.time,value:r,location:p,style:m},err:null}}return{val:{type:"number"===c?n.number:"date"===c?n.date:n.time,value:r,location:p,style:null!==(o=null==h?void 0:h.style)&&void 0!==o?o:null},err:null};case"plural":case"selectordinal":case"select":var b=this.clonePosition();if(this.bumpSpace(),!this.bumpIf(","))return this.error(s.EXPECT_SELECT_ARGUMENT_OPTIONS,createLocation(b,__assign({},b)));this.bumpSpace();var E=this.parseIdentifierIfPossible(),y=0;if("select"!==c&&"offset"===E.value){if(!this.bumpIf(":"))return this.error(s.EXPECT_PLURAL_ARGUMENT_OFFSET_VALUE,createLocation(this.clonePosition(),this.clonePosition()));var I;if(this.bumpSpace(),(I=this.tryParseDecimalInteger(s.EXPECT_PLURAL_ARGUMENT_OFFSET_VALUE,s.INVALID_PLURAL_ARGUMENT_OFFSET_VALUE)).err)return I;this.bumpSpace(),E=this.parseIdentifierIfPossible(),y=I.val}var v,S=this.tryParsePluralOrSelectOptions(e,c,t,E);if(S.err)return S;if((v=this.tryParseArgumentClose(a)).err)return v;var w=createLocation(a,this.clonePosition());return"select"===c?{val:{type:n.select,value:r,options:O(S.val),location:w},err:null}:{val:{type:n.plural,value:r,options:O(S.val),offset:y,pluralType:"plural"===c?"cardinal":"ordinal",location:w},err:null};default:return this.error(s.INVALID_ARGUMENT_TYPE,createLocation(u,l))}},Parser.prototype.tryParseArgumentClose=function(e){return this.isEOF()||125!==this.char()?this.error(s.EXPECT_ARGUMENT_CLOSING_BRACE,createLocation(e,this.clonePosition())):(this.bump(),{val:!0,err:null})},Parser.prototype.parseSimpleArgStyleIfPossible=function(){for(var e=0,t=this.clonePosition();!this.isEOF();){switch(this.char()){case 39:this.bump();var r=this.clonePosition();if(!this.bumpUntil("'"))return this.error(s.UNCLOSED_QUOTE_IN_ARGUMENT_STYLE,createLocation(r,this.clonePosition()));this.bump();break;case 123:e+=1,this.bump();break;case 125:if(!(e>0))return{val:this.message.slice(t.offset,this.offset()),err:null};e-=1;break;default:this.bump()}}return{val:this.message.slice(t.offset,this.offset()),err:null}},Parser.prototype.parseNumberSkeletonFromString=function(e,t){var r=[];try{r=function parseNumberSkeletonFromString(e){if(0===e.length)throw new Error("Number skeleton cannot be empty");for(var t=[],r=0,a=e.split(c).filter((function(e){return e.length>0}));r<a.length;r++){var s=a[r].split("/");if(0===s.length)throw new Error("Invalid number skeleton");for(var n=s[0],i=s.slice(1),o=0,u=i;o<u.length;o++)if(0===u[o].length)throw new Error("Invalid number skeleton");t.push({stem:n,options:i})}return t}(e)}catch(e){return this.error(s.INVALID_NUMBER_SKELETON,t)}return{val:{type:i.number,tokens:r,location:t,parsedOptions:this.shouldParseSkeletons?parseNumberSkeleton(r):{}},err:null}},Parser.prototype.tryParsePluralOrSelectOptions=function(e,t,r,a){for(var n,i=!1,o=[],u=new Set,c=a.value,l=a.location;;){if(0===c.length){var h=this.clonePosition();if("select"===t||!this.bumpIf("="))break;var d=this.tryParseDecimalInteger(s.EXPECT_PLURAL_ARGUMENT_SELECTOR,s.INVALID_PLURAL_ARGUMENT_SELECTOR);if(d.err)return d;l=createLocation(h,this.clonePosition()),c=this.message.slice(h.offset,this.offset())}if(u.has(c))return this.error("select"===t?s.DUPLICATE_SELECT_ARGUMENT_SELECTOR:s.DUPLICATE_PLURAL_ARGUMENT_SELECTOR,l);"other"===c&&(i=!0),this.bumpSpace();var p=this.clonePosition();if(!this.bumpIf("{"))return this.error("select"===t?s.EXPECT_SELECT_ARGUMENT_SELECTOR_FRAGMENT:s.EXPECT_PLURAL_ARGUMENT_SELECTOR_FRAGMENT,createLocation(this.clonePosition(),this.clonePosition()));var g=this.parseMessage(e+1,t,r);if(g.err)return g;var f=this.tryParseArgumentClose(p);if(f.err)return f;o.push([c,{value:g.val,location:createLocation(p,this.clonePosition())}]),u.add(c),this.bumpSpace(),c=(n=this.parseIdentifierIfPossible()).value,l=n.location}return 0===o.length?this.error("select"===t?s.EXPECT_SELECT_ARGUMENT_SELECTOR:s.EXPECT_PLURAL_ARGUMENT_SELECTOR,createLocation(this.clonePosition(),this.clonePosition())):this.requiresOtherClause&&!i?this.error(s.MISSING_OTHER_CLAUSE,createLocation(this.clonePosition(),this.clonePosition())):{val:o,err:null}},Parser.prototype.tryParseDecimalInteger=function(e,t){var r=1,a=this.clonePosition();this.bumpIf("+")||this.bumpIf("-")&&(r=-1);for(var s=!1,n=0;!this.isEOF();){var i=this.char();if(!(i>=48&&i<=57))break;s=!0,n=10*n+(i-48),this.bump()}var o=createLocation(a,this.clonePosition());return s?_(n*=r)?{val:n,err:null}:this.error(t,o):this.error(e,o)},Parser.prototype.offset=function(){return this.position.offset},Parser.prototype.isEOF=function(){return this.offset()===this.message.length},Parser.prototype.clonePosition=function(){return{offset:this.position.offset,line:this.position.line,column:this.position.column}},Parser.prototype.char=function(){var e=this.position.offset;if(e>=this.message.length)throw Error("out of bound");var t=D(this.message,e);if(void 0===t)throw Error("Offset ".concat(e," is at invalid UTF-16 code unit boundary"));return t},Parser.prototype.error=function(e,t){return{val:null,err:{kind:e,message:this.message,location:t}}},Parser.prototype.bump=function(){if(!this.isEOF()){var e=this.char();10===e?(this.position.line+=1,this.position.column=1,this.position.offset+=1):(this.position.column+=1,this.position.offset+=e<65536?1:2)}},Parser.prototype.bumpIf=function(e){if(L(this.message,e,this.offset())){for(var t=0;t<e.length;t++)this.bump();return!0}return!1},Parser.prototype.bumpUntil=function(e){var t=this.offset(),r=this.message.indexOf(e,t);return r>=0?(this.bumpTo(r),!0):(this.bumpTo(this.message.length),!1)},Parser.prototype.bumpTo=function(e){if(this.offset()>e)throw Error("targetOffset ".concat(e," must be greater than or equal to the current offset ").concat(this.offset()));for(e=Math.min(e,this.message.length);;){var t=this.offset();if(t===e)break;if(t>e)throw Error("targetOffset ".concat(e," is at invalid UTF-16 code unit boundary"));if(this.bump(),this.isEOF())break}},Parser.prototype.bumpSpace=function(){for(;!this.isEOF()&&_isWhiteSpace(this.char());)this.bump()},Parser.prototype.peek=function(){if(this.isEOF())return null;var e=this.char(),t=this.offset(),r=this.message.charCodeAt(t+(e>=65536?2:1));return null!=r?r:null},Parser}();function _isAlpha(e){return e>=97&&e<=122||e>=65&&e<=90}function _isWhiteSpace(e){return e>=9&&e<=13||32===e||133===e||e>=8206&&e<=8207||8232===e||8233===e}function _isPatternSyntax(e){return e>=33&&e<=35||36===e||e>=37&&e<=39||40===e||41===e||42===e||43===e||44===e||45===e||e>=46&&e<=47||e>=58&&e<=59||e>=60&&e<=62||e>=63&&e<=64||91===e||92===e||93===e||94===e||96===e||123===e||124===e||125===e||126===e||161===e||e>=162&&e<=165||166===e||167===e||169===e||171===e||172===e||174===e||176===e||177===e||182===e||187===e||191===e||215===e||247===e||e>=8208&&e<=8213||e>=8214&&e<=8215||8216===e||8217===e||8218===e||e>=8219&&e<=8220||8221===e||8222===e||8223===e||e>=8224&&e<=8231||e>=8240&&e<=8248||8249===e||8250===e||e>=8251&&e<=8254||e>=8257&&e<=8259||8260===e||8261===e||8262===e||e>=8263&&e<=8273||8274===e||8275===e||e>=8277&&e<=8286||e>=8592&&e<=8596||e>=8597&&e<=8601||e>=8602&&e<=8603||e>=8604&&e<=8607||8608===e||e>=8609&&e<=8610||8611===e||e>=8612&&e<=8613||8614===e||e>=8615&&e<=8621||8622===e||e>=8623&&e<=8653||e>=8654&&e<=8655||e>=8656&&e<=8657||8658===e||8659===e||8660===e||e>=8661&&e<=8691||e>=8692&&e<=8959||e>=8960&&e<=8967||8968===e||8969===e||8970===e||8971===e||e>=8972&&e<=8991||e>=8992&&e<=8993||e>=8994&&e<=9e3||9001===e||9002===e||e>=9003&&e<=9083||9084===e||e>=9085&&e<=9114||e>=9115&&e<=9139||e>=9140&&e<=9179||e>=9180&&e<=9185||e>=9186&&e<=9254||e>=9255&&e<=9279||e>=9280&&e<=9290||e>=9291&&e<=9311||e>=9472&&e<=9654||9655===e||e>=9656&&e<=9664||9665===e||e>=9666&&e<=9719||e>=9720&&e<=9727||e>=9728&&e<=9838||9839===e||e>=9840&&e<=10087||10088===e||10089===e||10090===e||10091===e||10092===e||10093===e||10094===e||10095===e||10096===e||10097===e||10098===e||10099===e||10100===e||10101===e||e>=10132&&e<=10175||e>=10176&&e<=10180||10181===e||10182===e||e>=10183&&e<=10213||10214===e||10215===e||10216===e||10217===e||10218===e||10219===e||10220===e||10221===e||10222===e||10223===e||e>=10224&&e<=10239||e>=10240&&e<=10495||e>=10496&&e<=10626||10627===e||10628===e||10629===e||10630===e||10631===e||10632===e||10633===e||10634===e||10635===e||10636===e||10637===e||10638===e||10639===e||10640===e||10641===e||10642===e||10643===e||10644===e||10645===e||10646===e||10647===e||10648===e||e>=10649&&e<=10711||10712===e||10713===e||10714===e||10715===e||e>=10716&&e<=10747||10748===e||10749===e||e>=10750&&e<=11007||e>=11008&&e<=11055||e>=11056&&e<=11076||e>=11077&&e<=11078||e>=11079&&e<=11084||e>=11085&&e<=11123||e>=11124&&e<=11125||e>=11126&&e<=11157||11158===e||e>=11159&&e<=11263||e>=11776&&e<=11777||11778===e||11779===e||11780===e||11781===e||e>=11782&&e<=11784||11785===e||11786===e||11787===e||11788===e||11789===e||e>=11790&&e<=11798||11799===e||e>=11800&&e<=11801||11802===e||11803===e||11804===e||11805===e||e>=11806&&e<=11807||11808===e||11809===e||11810===e||11811===e||11812===e||11813===e||11814===e||11815===e||11816===e||11817===e||e>=11818&&e<=11822||11823===e||e>=11824&&e<=11833||e>=11834&&e<=11835||e>=11836&&e<=11839||11840===e||11841===e||11842===e||e>=11843&&e<=11855||e>=11856&&e<=11857||11858===e||e>=11859&&e<=11903||e>=12289&&e<=12291||12296===e||12297===e||12298===e||12299===e||12300===e||12301===e||12302===e||12303===e||12304===e||12305===e||e>=12306&&e<=12307||12308===e||12309===e||12310===e||12311===e||12312===e||12313===e||12314===e||12315===e||12316===e||12317===e||e>=12318&&e<=12319||12320===e||12336===e||64830===e||64831===e||e>=65093&&e<=65094}function pruneLocation(e){e.forEach((function(e){if(delete e.location,isSelectElement(e)||isPluralElement(e))for(var t in e.options)delete e.options[t].location,pruneLocation(e.options[t].value);else isNumberElement(e)&&isNumberSkeleton(e.style)||(isDateElement(e)||isTimeElement(e))&&isDateTimeSkeleton(e.style)?delete e.style.location:isTagElement(e)&&pruneLocation(e.children)}))}function parse(e,t){void 0===t&&(t={}),t=__assign({shouldParseSkeletons:!0,requiresOtherClause:!0},t);var r=new M(e,t).parse();if(r.err){var a=SyntaxError(s[r.err.kind]);throw a.location=r.err.location,a.originalMessage=r.err.message,a}return(null==t?void 0:t.captureLocation)||pruneLocation(r.val),r.val}function memoize(e,t){var r=t&&t.cache?t.cache:B,a=t&&t.serializer?t.serializer:serializerDefault;return(t&&t.strategy?t.strategy:strategyDefault)(e,{cache:r,serializer:a})}function monadic(e,t,r,a){var s=function isPrimitive(e){return null==e||"number"==typeof e||"boolean"==typeof e}(a)?a:r(a),n=t.get(s);return void 0===n&&(n=e.call(this,a),t.set(s,n)),n}function variadic(e,t,r){var a=Array.prototype.slice.call(arguments,3),s=r(a),n=t.get(s);return void 0===n&&(n=e.apply(this,a),t.set(s,n)),n}function assemble(e,t,r,a,s){return r.bind(t,e,a,s)}function strategyDefault(e,t){return assemble(e,this,1===e.length?monadic:variadic,t.cache.create(),t.serializer)}var serializerDefault=function(){return JSON.stringify(arguments)};function ObjectWithoutPrototypeCache(){this.cache=Object.create(null)}ObjectWithoutPrototypeCache.prototype.get=function(e){return this.cache[e]},ObjectWithoutPrototypeCache.prototype.set=function(e,t){this.cache[e]=t};var x,B={create:function create(){return new ObjectWithoutPrototypeCache}},R={variadic:function strategyVariadic(e,t){return assemble(e,this,variadic,t.cache.create(),t.serializer)},monadic:function strategyMonadic(e,t){return assemble(e,this,monadic,t.cache.create(),t.serializer)}};!function(e){e.MISSING_VALUE="MISSING_VALUE",e.INVALID_VALUE="INVALID_VALUE",e.MISSING_INTL_API="MISSING_INTL_API"}(x||(x={}));var U,V=function(e){function FormatError(t,r,a){var s=e.call(this,t)||this;return s.code=r,s.originalMessage=a,s}return __extends(FormatError,e),FormatError.prototype.toString=function(){return"[formatjs Error: ".concat(this.code,"] ").concat(this.message)},FormatError}(Error),H=function(e){function InvalidValueError(t,r,a,s){return e.call(this,'Invalid values for "'.concat(t,'": "').concat(r,'". Options are "').concat(Object.keys(a).join('", "'),'"'),x.INVALID_VALUE,s)||this}return __extends(InvalidValueError,e),InvalidValueError}(V),k=function(e){function InvalidValueTypeError(t,r,a){return e.call(this,'Value for "'.concat(t,'" must be of type ').concat(r),x.INVALID_VALUE,a)||this}return __extends(InvalidValueTypeError,e),InvalidValueTypeError}(V),j=function(e){function MissingValueError(t,r){return e.call(this,'The intl string context variable "'.concat(t,'" was not provided to the string "').concat(r,'"'),x.MISSING_VALUE,r)||this}return __extends(MissingValueError,e),MissingValueError}(V);function isFormatXMLElementFn(e){return"function"==typeof e}function formatToParts(e,t,r,a,s,n,i){if(1===e.length&&isLiteralElement(e[0]))return[{type:U.literal,value:e[0].value}];for(var o=[],u=0,c=e;u<c.length;u++){var l=c[u];if(isLiteralElement(l))o.push({type:U.literal,value:l.value});else if(isPoundElement(l))"number"==typeof n&&o.push({type:U.literal,value:r.getNumberFormat(t).format(n)});else{var h=l.value;if(!s||!(h in s))throw new j(h,i);var d=s[h];if(isArgumentElement(l))d&&"string"!=typeof d&&"number"!=typeof d||(d="string"==typeof d||"number"==typeof d?String(d):""),o.push({type:"string"==typeof d?U.literal:U.object,value:d});else if(isDateElement(l)){var p="string"==typeof l.style?a.date[l.style]:isDateTimeSkeleton(l.style)?l.style.parsedOptions:void 0;o.push({type:U.literal,value:r.getDateTimeFormat(t,p).format(d)})}else if(isTimeElement(l)){p="string"==typeof l.style?a.time[l.style]:isDateTimeSkeleton(l.style)?l.style.parsedOptions:a.time.medium;o.push({type:U.literal,value:r.getDateTimeFormat(t,p).format(d)})}else if(isNumberElement(l)){(p="string"==typeof l.style?a.number[l.style]:isNumberSkeleton(l.style)?l.style.parsedOptions:void 0)&&p.scale&&(d*=p.scale||1),o.push({type:U.literal,value:r.getNumberFormat(t,p).format(d)})}else{if(isTagElement(l)){var g=l.children,f=l.value,m=s[f];if(!isFormatXMLElementFn(m))throw new k(f,"function",i);var b=m(formatToParts(g,t,r,a,s,n).map((function(e){return e.value})));Array.isArray(b)||(b=[b]),o.push.apply(o,b.map((function(e){return{type:"string"==typeof e?U.literal:U.object,value:e}})))}if(isSelectElement(l)){if(!(E=l.options[d]||l.options.other))throw new H(l.value,d,Object.keys(l.options),i);o.push.apply(o,formatToParts(E.value,t,r,a,s))}else if(isPluralElement(l)){var E;if(!(E=l.options["=".concat(d)])){if(!Intl.PluralRules)throw new V('Intl.PluralRules is not available in this environment.\nTry polyfilling it using "@formatjs/intl-pluralrules"\n',x.MISSING_INTL_API,i);var y=r.getPluralRules(t,{type:l.pluralType}).select(d-(l.offset||0));E=l.options[y]||l.options.other}if(!E)throw new H(l.value,d,Object.keys(l.options),i);o.push.apply(o,formatToParts(E.value,t,r,a,s,d-(l.offset||0)))}else;}}}return function mergeLiteral(e){return e.length<2?e:e.reduce((function(e,t){var r=e[e.length-1];return r&&r.type===U.literal&&t.type===U.literal?r.value+=t.value:e.push(t),e}),[])}(o)}function mergeConfigs(e,t){return t?Object.keys(e).reduce((function(r,a){return r[a]=function mergeConfig(e,t){return t?__assign(__assign(__assign({},e||{}),t||{}),Object.keys(e).reduce((function(r,a){return r[a]=__assign(__assign({},e[a]),t[a]||{}),r}),{})):e}(e[a],t[a]),r}),__assign({},e)):e}function createFastMemoizeCache(e){return{create:function(){return{get:function(t){return e[t]},set:function(t,r){e[t]=r}}}}}!function(e){e[e.literal=0]="literal",e[e.object=1]="object"}(U||(U={}));var G=function(){function IntlMessageFormat(e,t,r,a){var s=this;if(void 0===t&&(t=IntlMessageFormat.defaultLocale),this.formatterCache={number:{},dateTime:{},pluralRules:{}},this.format=function(e){var t=s.formatToParts(e);if(1===t.length)return t[0].value;var r=t.reduce((function(e,t){return e.length&&t.type===U.literal&&"string"==typeof e[e.length-1]?e[e.length-1]+=t.value:e.push(t.value),e}),[]);return r.length<=1?r[0]||"":r},this.formatToParts=function(e){return formatToParts(s.ast,s.locales,s.formatters,s.formats,e,void 0,s.message)},this.resolvedOptions=function(){return{locale:s.resolvedLocale.toString()}},this.getAst=function(){return s.ast},this.locales=t,this.resolvedLocale=IntlMessageFormat.resolveLocale(t),"string"==typeof e){if(this.message=e,!IntlMessageFormat.__parse)throw new TypeError("IntlMessageFormat.__parse must be set to process `message` of type `string`");this.ast=IntlMessageFormat.__parse(e,{ignoreTag:null==a?void 0:a.ignoreTag,locale:this.resolvedLocale})}else this.ast=e;if(!Array.isArray(this.ast))throw new TypeError("A message must be provided as a String or AST.");this.formats=mergeConfigs(IntlMessageFormat.formats,r),this.formatters=a&&a.formatters||function createDefaultFormatters(e){return void 0===e&&(e={number:{},dateTime:{},pluralRules:{}}),{getNumberFormat:memoize((function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return new((e=Intl.NumberFormat).bind.apply(e,__spreadArray([void 0],t,!1)))}),{cache:createFastMemoizeCache(e.number),strategy:R.variadic}),getDateTimeFormat:memoize((function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return new((e=Intl.DateTimeFormat).bind.apply(e,__spreadArray([void 0],t,!1)))}),{cache:createFastMemoizeCache(e.dateTime),strategy:R.variadic}),getPluralRules:memoize((function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return new((e=Intl.PluralRules).bind.apply(e,__spreadArray([void 0],t,!1)))}),{cache:createFastMemoizeCache(e.pluralRules),strategy:R.variadic})}}(this.formatterCache)}return Object.defineProperty(IntlMessageFormat,"defaultLocale",{get:function(){return IntlMessageFormat.memoizedDefaultLocale||(IntlMessageFormat.memoizedDefaultLocale=(new Intl.NumberFormat).resolvedOptions().locale),IntlMessageFormat.memoizedDefaultLocale},enumerable:!1,configurable:!0}),IntlMessageFormat.memoizedDefaultLocale=null,IntlMessageFormat.resolveLocale=function(e){var t=Intl.NumberFormat.supportedLocalesOf(e);return t.length>0?new Intl.Locale(t[0]):new Intl.Locale("string"==typeof e?e:e[0])},IntlMessageFormat.__parse=parse,IntlMessageFormat.formats={number:{integer:{maximumFractionDigits:0},currency:{style:"currency"},percent:{style:"percent"}},date:{short:{month:"numeric",day:"numeric",year:"2-digit"},medium:{month:"short",day:"numeric",year:"numeric"},long:{month:"long",day:"numeric",year:"numeric"},full:{weekday:"long",month:"long",day:"numeric",year:"numeric"}},time:{short:{hour:"numeric",minute:"numeric"},medium:{hour:"numeric",minute:"numeric",second:"numeric"},long:{hour:"numeric",minute:"numeric",second:"numeric",timeZoneName:"short"},full:{hour:"numeric",minute:"numeric",second:"numeric",timeZoneName:"short"}}},IntlMessageFormat}();const W=G;class Message{constructor(e,t){if(!t)throw new Error("Locale data is missing");if(!e)throw new Error("Message data is missing");this.message="Message text is not defined in translation data",this.params=[],this.locale=t;for(const t of Object.keys(e))this[t]=e[t];this.formatFunc=new W(this.message,this.locale),this.abbrFunc=new W(this.abbr||this.message,this.locale)}get hasParameters(){return Boolean(this.params.length>0)}getMsg(e){if(this.hasParameters&&!this.formatFunc)throw new Error(`A message with parameters ${this.message} requires a format function`);return this.hasParameters?this.formatFunc.format(e):this.message}getAbbr(e){return this.hasParameters?this.abbrFunc.format(e):this.abbrFunc.format()}}class MessageBundle{constructor(e,t,r=((e,t)=>`Missing translation: ${e} [${t}]`)){if(!t)throw new Error("Locale data is missing");if(!e)throw new Error("Message data is missing");this._locale=t,this._messages=new Map,this._missingTranslationMsgFn=r;const a="string"==typeof e?JSON.parse(e):e;this.append(a)}appendFromBundle(e){for(const t of e.messageIds)this._messages.set(t,e.getMessageObject(t))}appendFromJSON(e){const t="string"==typeof e?JSON.parse(e):e;this.append(t)}append(e){for(const[t,r]of Object.entries(e)){const e=new Message(r,this._locale);this._messages.set(t,e)}}get messageIds(){return Array.from(this._messages.keys())}hasMsg(e){return this._messages.has(e)}getMsg(e,t,r={}){return r=Object.assign({passthrough:!1},r),this.hasMsg(e)?this._messages.get(e).getMsg(t):r.passthrough?e:`"${e}" is not in translation data for ${this._locale}`}getText(e,t,r={}){return r.passthrough=!0,this.getMsg(e,t,r)}getAbbr(e,t){return this.hasMsg(e)?this._messages.get(e).getAbbr(t):this._missingTranslationMsgFn(e,this._locale)}getMessageObject(e){return this.hasMsg(e)?this._messages.get(e):null}get locale(){return this._locale}}let $;class L10nSingleton extends class L10n{constructor(){return this.selectedLocale=void 0,this.bundles=new Map,this}addMessages(e,t,r){let a;return this.bundles.has(t)?(a=this.bundles.get(t),a.appendFromJSON(e)):(a=new MessageBundle(e,t,r),this.addMessageBundle(a),this.selectedLocale||this.setLocale(t)),this}addMessageBundle(e){const t=e.locale;return this.bundles.has(t)?this.bundles.get(t).appendFromBundle(e):(this.bundles.set(e.locale,e),this.selectedLocale||this.setLocale(e.locale)),this}get locales(){return Array.from(this.bundles.keys())}get bundle(){return this.bundles.get(this.selectedLocale)}getMsg(...e){return this.bundles.has(this.selectedLocale)?this.bundles.get(this.selectedLocale).getMsg(...e):{}}setLocale(e){return this.bundles.has(e)&&(this.selectedLocale=e),this}}{constructor(){return super(),$=this,this}static getMsgS(...e){return $.getMsg(...e)}}class ContentMenuItem{constructor({id:e,title:t,actionFunc:r,isSeparator:a}){this.id=e,this.title=t,this.actionFunc=r,this.isActive=!1,this.isSeparator=a}enable(){if(!this.isActive&!this.isSeparator){const e=this.isSeparator?{id:this.id,type:"separator"}:{id:this.id,title:this.title};BrowserActions.createContextMenuItem(e),this.isActive=!0}}disable(){this.isActive&!this.isSeparator&&(BrowserActions.removeContextMenuItem(this.id),this.isActive=!1)}}class ContextMenu{constructor(){this.items={}}initialize(){this.items={activate:new ContentMenuItem({id:ContextMenu.menuItemId.activate,title:L10nSingleton.getMsgS(ContextMenu.menuItemText.activate)}),deactivate:new ContentMenuItem({id:ContextMenu.menuItemId.deactivate,title:L10nSingleton.getMsgS(ContextMenu.menuItemText.deactivate)}),separatorOne:new ContentMenuItem({id:ContextMenu.menuItemId.separator,isSeparator:!0}),info:new ContentMenuItem({id:ContextMenu.menuItemId.info,title:L10nSingleton.getMsgS(ContextMenu.menuItemText.info)}),disabled:new ContentMenuItem({id:ContextMenu.menuItemId.disabled,title:L10nSingleton.getMsgS(ContextMenu.menuItemText.disabled)})},this.setState("initial")}disableAll(){Object.keys(this.items).forEach((e=>{this.items[e].disable()}))}setState(e){Object.keys(this.states[e]).forEach((t=>{this.states[e][t]?this.items[t].enable():this.items[t].disable()}))}get states(){return{initial:{activate:!0,deactivate:!1,separatorOne:!1,info:!1,disabled:!1},activeWithPanel:{activate:!1,deactivate:!0,separatorOne:!0,info:!0,disabled:!1},activeWithoutPanel:{activate:!1,deactivate:!0,separatorOne:!1,info:!1,disabled:!1},deactivated:{activate:!0,deactivate:!1,separatorOne:!1,info:!1,disabled:!1},embedDisabled:{activate:!1,deactivate:!1,separatorOne:!1,info:!1,disabled:!0}}}}ContextMenu.menuItemId={activate:"activate-alpheios-content",deactivate:"deactivate-alpheios-content",separator:"separator-one",info:"show-alpheios-panel-info",disabled:"disabled-alpheios-content"},ContextMenu.menuItemText={activate:"CONTEXT_MENU_ACTIVATE",deactivate:"CONTEXT_MENU_DEACTIVATE",info:"CONTEXT_MENU_INFO",disabled:"CONTEXT_MENU_DISABLED"};const z="en-US",q="en-GB",J={[z]:[JSON.parse('{"TEXT_EDITOR_HEADING":{"message":"Enter text","description":"A heading for text editor","component":"TextEditor"},"EMBED_LIB_WARNING_TEXT":{"message":"This page embeds Alpheios directly. The Alpheios browser extension is not needed for it and will be deactivated until you navigate away from the page.","description":"A message that is shown when an Alpheios extension is disabled due to embedded library presence","component":"EmbedLibWarning"}}'),JSON.parse('{"CONTEXT_MENU_ACTIVATE":{"message":"Activate","description":"Context Menu titles","component":"ContextMenu"},"CONTEXT_MENU_DEACTIVATE":{"message":"Deactivate","description":"Context Menu titles","component":"ContextMenu"},"CONTEXT_MENU_INFO":{"message":"Info","description":"Context Menu titles","component":"ContextMenu"},"CONTEXT_MENU_DISABLED":{"message":"(Alpheios Extension Disabled For Page)","description":"Context Menu titles","component":"ContextMenu"},"LABEL_BROWSERACTION_DEACTIVATE":{"message":"Deactivate Alpheios","description":"Deactivate browser action title","component":"UI"},"LABEL_BROWSERACTION_ACTIVATE":{"message":"Activate Alpheios","description":"Activate browser action title","component":"UI"},"LABEL_BROWSERACTION_DISABLED":{"message":"(Alpheios Extension Disabled For Page)","description":"Disabled browser action title","component":"UI"}}')],[q]:[JSON.parse('{"COOKIE_TEST_MESSAGE":{"message":"This is a test message about a cookie.","description":"A test message that is shown in a panel","component":"Panel"}}')]},K=z,locales_predefinedLocales=()=>{const e=[];return Object.keys(J).forEach((t=>{J[t].forEach((r=>e.push([r,t])))})),e},locales_bundleArr=()=>{let e=[];for(const[t,r]of Object.entries(J))e.push(...r.map((e=>new MessageBundle(e,t))));return e};class BackController{constructor(){this.tabs=new TabsSet,this.menu=new ContextMenu,this.defineL10Support()}initialize(){BrowserActions.defineBrowserData(),browser.tabs.onActivated.addListener(this.tabActivationListener.bind(this)),browser.tabs.onDetached.addListener(this.tabDetachedListener.bind(this)),browser.tabs.onRemoved.addListener(this.tabRemovalListener.bind(this)),browser.tabs.onUpdated.addListener(this.tabUpdatedListener.bind(this)),browser.action.onClicked.addListener(this.browserActionListener.bind(this)),browser.contextMenus.onClicked.addListener(this.menuListener.bind(this)),browser.runtime.onMessage.addListener(this.catchContentMessage.bind(this)),browser.runtime.onInstalled.addListener(this.handleOnInstalled.bind(this)),this.menu.initialize()}tabActivationListener(e){const t=this.tabs.getItem({tabId:e.tabId,windowId:e.windowId});this.updateUI(t)}async tabDetachedListener(e,t){const r=await BrowserActions.getCurrentTab(),a=this.tabs.updateTabWindowId({tabId:e,oldWindowId:t.oldWindowId,newWindowId:r.windowId});this.setBrowserState(a)}tabRemovalListener(e,t){this.tabs.removeItem({tabId:e,windowId:t.windowId})}async tabUpdatedListener(e,t,r){if(!r.active)return;if(this.tabs.existItemId({tabId:r.id,windowId:r.windowId})&&"loading"===t.status){const e=this.tabs.getItem({tabId:r.id,windowId:r.windowId});await this.activateContent(e,!0),this.checkEmbeddedContent(r.id),this.updateUI(e),e.isActive()&&this.notifyPageActive(r.id)}}async browserActionListener(e){let t=this.tabs.getItem({tabId:e.id,windowId:e.windowId});if(t&&t.isActive())await this.deactivateContent(t);else{const r=!t;t||(t=this.tabs.addItem({tabId:e.id,windowId:e.windowId})),await this.activateContent(t,r)}this.updateUI(t)}async menuListener(e,t){let r=this.tabs.getItem({tabId:t.id,windowId:t.windowId});const a=!r;r||(r=this.tabs.addItem({tabId:t.id,windowId:t.windowId})),e.menuItemId===ContextMenu.menuItemId.activate?this.activateContent(r,a):e.menuItemId===ContextMenu.menuItemId.deactivate?await this.deactivateContent(r):e.menuItemId===ContextMenu.menuItemId.info&&this.openInfoTab(r),this.updateUI(r)}async handleOnInstalled(e){if(e.previousVersion){const e=await browser.tabs.query({});for(let t=0;t<e.length;t++){const r=e[t];BrowserActions.executeScript({tabId:r.id,hideError:!0,func:()=>{document.body.dispatchEvent(new Event("Alpheios_Reload"))}})}}}catchContentMessage(e,r,a){let s,n=this.tabs.getItem({tabId:r.tab.id,windowId:r.tab.windowId});return!!n&&(e.tab&&(s=t.TabScript.readObject(e.tab),s.updateTabObject(r.tab.id,r.tab.windowId),n.embedLibStatus=s.embedLibStatus),"content-init-finished"===e.state&&(n.isEmbedLibActive()||this.setContentState(n)),"content-state-update"===e.state&&(s.isPending()||n.update(s),this.updateUI(n)),!0)}async setContentState(e){let r;e&&e.isActive()?r=await browser.tabs.sendMessage(e.tabObj.tabId,{state:"content-activate",tab:t.TabScript.serializable(e)}):e&&!e.isActive()&&(r=await browser.tabs.sendMessage(e.tabObj.tabId,{state:"content-deactivate",tab:t.TabScript.serializable(e)}));const a=t.TabScript.readObject(r.tab);return a.isDeactivated()&&!a.isEmbedLibActive()?this.setDefaultTabState(e):e.update(a),this.updateUI(e),!0}async activateContent(e,t=!1){if(e.activate(),t)try{await this.loadContentData(e.tabObj.tabId)}catch(e){console.error("Cannot load content script for a tab with an ID of ",e)}else await this.setContentState(e);this.notifyPageActive(e.tabObj.tabId)}async deactivateContent(e){e.deactivate(),await this.setContentState(e),this.notifyPageInactive(e.tabObj.tabId)}updateBrowserActionForTab(e){e&&e.hasOwnProperty("status")&&(e.isEmbedLibActive()||e.isDisabled()?BrowserActions.setTitle(BackController.browserActionTitles.activate,e.tabObj.tabId):e.isActive()?BrowserActions.setTitle(BackController.browserActionTitles.deactivate,e.tabObj.tabId):e.isDeactivated()&&BrowserActions.setTitle(BackController.browserActionTitles.disabled,e.tabObj.tabId))}checkEmbeddedContent(e){BrowserActions.executeScript({tabId:e,func:()=>{document.body.dispatchEvent(new Event("Alpheios_Embedded_Check"))}})}async openPanel(e){e.activate().setPanelOpen(),this.setContentState(e)}async openInfoTab(e){e.activate().setPanelOpen().changeTab("info"),this.setContentState(e)}setBrowserState(e){if(!e)return;const t=e.isActive()&&!e.isEmbedLibActive();BrowserActions.setBadgeState(e.tabObj.tabId,t);const r=!!e&&(e.isActive()&&!e.isEmbedLibActive());BrowserActions.setIconState(e.tabObj.tabId,r)}setMenuForTab(e){this.menu.disableAll(),e?e.hasOwnProperty("status")&&(e.isEmbedLibActive()||e.isDisabled()?this.menu.setState("embedDisabled"):e.isActive()&&e.isPanelOpen()?this.menu.setState("activeWithPanel"):e.isActive()&&!e.isPanelOpen()?this.menu.setState("activeWithoutPanel"):e.isDeactivated()&&this.menu.setState("deactivated")):this.menu.setState("initial")}updateUI(e){this.setBrowserState(e),this.setMenuForTab(e),this.updateBrowserActionForTab(e)}setDefaultTabState(e){return e.setPanelDefault(),e.setTabDefault(),this}async loadContentData(t){return{js:await BrowserActions.loadScripts(e.v1,t),css:await BrowserActions.loadCSSFiles(e.iv,t)}}notifyPageActive(e){BrowserActions.executeScript({tabId:e,func:()=>{document.body.dispatchEvent(new Event("Alpheios_Active"))}})}notifyPageInactive(e){BrowserActions.executeScript({tabId:e,func:()=>{document.body.dispatchEvent(new Event("Alpheios_Inactive"))}})}defineL10Support(){const e={defaultLocale:K,messageBundles:locales_bundleArr(locales_predefinedLocales())},t=new L10nSingleton;return e.messageBundles.forEach((e=>t.addMessageBundle(e))),t.setLocale(e.defaultLocale),t}static get browserActionTitles(){return{activate:L10nSingleton.getMsgS("LABEL_BROWSERACTION_ACTIVATE"),deactivate:L10nSingleton.getMsgS("LABEL_BROWSERACTION_DEACTIVATE"),disabled:L10nSingleton.getMsgS("LABEL_BROWSERACTION_DISABLED")}}}const X=(new class Browser{constructor(){this.browserNamespace=void 0}inspect(){return this.browserNamespace=!("undefined"==typeof browser),this}getFeatures(){return{browserNamespace:this.browserNamespace}}supportsBrowserNamespace(){return this.browserNamespace||this.inspect(),this.browserNamespace}}).inspect().getFeatures();console.log(`Support of a "browser" namespace: ${X.browserNamespace}`),X.browserNamespace||(self.browser=chrome);(new BackController).initialize()})()})();